{"version":3,"file":"static/js/692.7646576f.chunk.js","mappings":"oSAWA,MAAMA,EAAgBA,CAACC,EAAqBC,EAAeC,IAAY,iBAAAC,OAClDH,EAAW,KAAAG,OAAIF,EAAK,KAAAE,OAAID,GA2pB7C,EAlpBqCE,KAAO,IAADC,EAAAC,EACvC,MAAMC,GAAWC,EAAAA,EAAAA,MACXC,GAAWC,EAAAA,EAAAA,MAGXC,GAAeC,EAAAA,EAAAA,SAAQ,SAAAC,EAAA,OACV,QAAfA,EAACN,EAASO,aAAK,IAAAD,OAAA,EAAfA,EAAiDF,eAAgB,IACjE,CAACJ,EAASO,QAERC,GAA6B,QAAfV,EAACE,EAASO,aAAK,IAAAT,OAAA,EAAfA,EAA8CU,cAAe,GAC3EC,GAAgC,QAAfV,EAACC,EAASO,aAAK,IAAAR,OAAA,EAAfA,EAAkDU,kBAAkB,EAGrFC,GAAiBL,EAAAA,EAAAA,SAAQ,IAC3BD,EAAaO,IAAIC,GAAQA,EAAKC,MAAM,eAAe,IAAM,KAAKC,KAAK,MACnE,CAACV,KAILW,EAAAA,EAAAA,WAAU,KACDN,GAA0C,IAAxBL,EAAaY,QAChCd,EAAS,MAEd,CAACO,EAAgBL,EAAcF,KAGlCa,EAAAA,EAAAA,WAAU,KACFP,GAAeE,GACfO,aAAaC,QAAQ,uBAAuB,GAADtB,OAAKY,EAAW,eAAAZ,OAAcc,IAEtE,KACHO,aAAaE,WAAW,0BAE7B,CAACX,EAAaE,IAGjB,MAAOU,EAAUC,IAAeC,EAAAA,EAAAA,UAAS,IAAIC,OACtC7B,EAAO8B,IAAYF,EAAAA,EAAAA,UAAS,KAG5BG,EAAcC,IAAmBJ,EAAAA,EAAAA,WAAS,IAC1CK,EAAOC,IAAYN,EAAAA,EAAAA,UAAgE,OACnFO,EAAmBC,IAAwBR,EAAAA,EAAAA,WAAS,IAGpDS,EAAiBC,IAAsBV,EAAAA,EAAAA,UAC1ClB,EAAaO,IAAIC,IAAI,CAAOnB,YAAamB,EAAMqB,aAAc,GAAIC,MAAO,QAIrEC,EAAaC,IAAkBd,EAAAA,EAAAA,UAAS,KACxCe,EAASC,IAAchB,EAAAA,EAAAA,UAAS,KAChCiB,EAAaC,IAAkBlB,EAAAA,EAAAA,UAAS,KACxCmB,EAAiBC,IAAsBpB,EAAAA,EAAAA,WAAS,IAGhDqB,EAAcC,IAAmBtB,EAAAA,EAAAA,UAAuB,KACxDuB,EAAiBC,IAAsBxB,EAAAA,EAAAA,UAA0B,KAGjEyB,EAAgBC,IAAqB1B,EAAAA,EAAAA,WAAS,IAC9C2B,EAAmBC,IAAwB5B,EAAAA,EAAAA,WAAS,IACpD6B,EAAOC,IAAY9B,EAAAA,EAAAA,UAAsB,KACzC+B,EAAWC,IAAgBhC,EAAAA,EAAAA,UAAS,KACpCiC,EAAUC,KAAelC,EAAAA,EAAAA,UAAsB,KAC/CmC,GAAgBC,KAAqBpC,EAAAA,EAAAA,UAAS,IAG/CqC,GAAYA,CAACC,EAAiBC,KAChCjC,EAAS,CAAEgC,UAASC,SACpBC,WAAW,IAAMlC,EAAS,MAAO,OAIrCb,EAAAA,EAAAA,WAAU,KACN,MAAMgD,EAAQC,YAAY,KACtB,MAAMC,EAAM,IAAI1C,KAChBF,EAAY4C,IACb,KAEGC,EAAQ9C,EAAS+C,cAAgB,EAGvC,OAFA3C,EAAS0C,GAAS,GAAKA,EAAQ,GAAK,MAAQ,SAErC,IAAME,cAAcL,IAC5B,CAAC3C,IAGJ,MAAMiD,GAAoBA,CAACC,EAAeC,EAA0BC,KAChExC,EAAmByC,IACf,MAAMC,EAAU,IAAID,GAEpB,OADAC,EAAQJ,IAAMK,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQD,EAAQJ,IAAM,IAAE,CAACC,GAAQC,IACxCE,KAMTE,GAD2B7C,EAAgB8C,MAAMC,GAAwB,KAAnBA,EAAE7C,eACXE,GAAeE,GAAWE,EA2KvEwC,GAAapC,EAAaqC,OAAO,CAACC,EAAKC,IAAMD,EAAMC,EAAE/B,MAAO,GAC5DgC,GAAgBtC,EAAgBmC,OAAO,CAACC,EAAKC,IAAMD,EAAMC,EAAE3B,SAAU,GAE3E,OACI6B,EAAAA,EAAAA,MAACC,EAAAA,EAAOC,IAAG,CACPC,UAAU,kCACVC,QAAS,CAAEC,QAAS,EAAGC,EAAG,IAC1BC,QAAS,CAAEF,QAAS,EAAGC,EAAG,GAC1BE,KAAM,CAAEH,QAAS,EAAGC,GAAI,IAAKG,SAAA,CAG5BpE,IACG2D,EAAAA,EAAAA,MAAA,OAAKG,UAAU,qBAAoBM,SAAA,EAC/BC,EAAAA,EAAAA,KAAA,OAAKP,UAAU,gBACfH,EAAAA,EAAAA,MAAA,KAAAS,SAAA,CAAG,kBAAgB9D,EAAgBf,OAAO,qBAKjDW,IACGmE,EAAAA,EAAAA,KAACT,EAAAA,EAAOC,IAAG,CACPC,UAAU,qBACVC,QAAS,CAAEC,QAAS,EAAGM,GAAI,IAC3BJ,QAAS,CAAEF,QAAS,EAAGM,EAAG,GAC1BH,KAAM,CAAEH,QAAS,EAAGM,GAAI,IAAKF,UAE7BT,EAAAA,EAAAA,MAAA,OAAKG,UAAS,oBAAA3F,OAAsB+B,EAAMkC,MAAOgC,SAAA,EAC7CC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,aAAYM,SAAiB,YAAflE,EAAMkC,KAAqB,SAAM,MAC9DlC,EAAMiC,cAMnBkC,EAAAA,EAAAA,KAACE,EAAAA,EAAa,CACVC,OAAQpE,EACRqE,MAAM,2BACNtC,QAAO,6BAAAhE,OAA+BmC,EAAgBf,OAAM,gBAAApB,OAAemC,EAAgBpB,IAAImE,GAAKA,EAAErF,aAAaqB,KAAK,OACxHqF,UAlHkBC,UAC1BtE,GAAqB,GACrBJ,GAAgB,GAEhB,MAAMqD,EAAapC,EAAaqC,OAAO,CAACC,EAAKC,IAAMD,EAAMC,EAAE/B,MAAO,GAC5DgC,EAAgBtC,EAAgBmC,OAAO,CAACC,EAAKC,IAAMD,EAAMC,EAAE3B,SAAU,GAE3E,IAEI,IAAK,MAAM8C,KAAetE,EAAiB,CACvC,MAAMuE,EAAuB,CACzBC,IAAIC,EAAAA,EAAAA,KACJvE,aAAcoE,EAAYpE,aAC1BwE,QAASJ,EAAY5G,YACrB0C,cACAE,UACAE,cACA7C,QACAC,KAAMyB,EAASsF,cAAc7F,MAAM,KAAK,GACxC8B,eACAE,kBACA8D,aAAcN,EAAYnE,MAAQ,CAAC,CAAEqE,IAAIC,EAAAA,EAAAA,KAAUtE,MAAO0E,OAAOP,EAAYnE,OAAQ2E,UAAW,IAAItF,OAAY,GAChHwD,aACAI,gBACA2B,YAAa,IAAIvF,OAIrBwF,EAAAA,EAAAA,IAAcT,SAGRU,EAAAA,EAAAA,IACF,CACIC,cAAeZ,EAAYpE,aAC3BwE,QAASJ,EAAY5G,YACrByH,aAAc/E,EACdE,UACA8E,aAAc5E,EACd7C,QACA0H,gBAAiBhG,EAASsF,cAAc7F,MAAM,KAAK,GACnDwG,qBAAqB,GAEzB1E,EAAahC,IAAIuE,IAAC,CAAO/B,MAAO+B,EAAE/B,MAAOE,UAAW6B,EAAE7B,UAAWwD,UAAW3B,EAAE2B,aAC9EhE,EAAgBlC,IAAIuE,IAAC,CAAO3B,SAAU2B,EAAE3B,SAAUE,eAAgByB,EAAEzB,eAAgBoD,UAAW3B,EAAE2B,aACjGR,EAAYnE,MAAQ,CAAC,CAAEA,MAAO0E,OAAOP,EAAYnE,OAAQ2E,UAAW,IAAItF,OAAY,GACpF,GACA,GACA,GAER,CAEAoC,GAAU,iBAAD/D,OAAkBmC,EAAgBf,OAAM,aAAa,WAG9D,MAAMsG,GAAc,IAAI/F,MAAOmF,cAAc7F,MAAM,KAAK,GAClDqD,GAAQ,IAAI3C,MAAO4C,cAAgB,EACnCoD,EAAerD,GAAS,GAAKA,EAAQ,GAAK,MAAQ,QACxDnC,EAAgByF,QAAQ1C,IACpB7D,aAAaE,WAAW3B,EAAcsF,EAAErF,YAAa8H,EAAcD,MAGvExD,WAAW,IAAM5D,EAAS,KAAM,IACpC,CAAE,MAAOuH,GACLC,QAAQD,MAAM,oBAAqBA,GACnC9D,GAAU,uCAAwC,SAClDG,WAAW,IAAM5D,EAAS,KAAM,IACpC,CAAC,QACGwB,GAAgB,EACpB,GA+CQiG,SAAUA,IAAM7F,GAAqB,MAIzCsD,EAAAA,EAAAA,MAAA,UAAQG,UAAU,oBAAmBM,SAAA,EACjCT,EAAAA,EAAAA,MAAA,UAAQG,UAAU,cAAcqC,QAjDzBC,KACf3H,EAAS,MAgDmD2F,SAAA,EAChDC,EAAAA,EAAAA,KAAA,OAAKgC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAGpC,UACtEC,EAAAA,EAAAA,KAAA,QAAMoC,EAAE,8BACN,WAGV9C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,mBAAkBM,SAAA,EAC7BT,EAAAA,EAAAA,MAAA,MAAAS,SAAA,CAAKrF,EAAY,mBAAYE,MAC7B0E,EAAAA,EAAAA,MAAA,QAAMG,UAAU,mBAAkBM,SAAA,CAAC,iBAAe9D,EAAgBf,OAAO,mBAE7EoE,EAAAA,EAAAA,MAAA,OAAKG,UAAS,kBAAA3F,OAAoBF,EAAMyI,eAAgBtC,SAAA,EACpDC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,aAAYM,SAAY,QAAVnG,EAAkB,SAAM,WACrDA,EAAM,gBAIf0F,EAAAA,EAAAA,MAAA,QAAMG,UAAU,kCAAiCM,SAAA,EAE7CT,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sBAAqBM,SAAA,EAChCT,EAAAA,EAAAA,MAAA,WAASG,UAAU,eAAcM,SAAA,EAC7BT,EAAAA,EAAAA,MAAA,MAAIG,UAAU,kBAAiBM,SAAA,CAAC,sBAE3BpD,IAAmBqD,EAAAA,EAAAA,KAAA,QAAMP,UAAU,eAAcM,SAAC,4BAGvDC,EAAAA,EAAAA,KAAA,OAAKP,UAAU,qBAAoBM,SAC9B9D,EAAgBpB,IAAI,CAAC0F,EAAa/B,KAC/Bc,EAAAA,EAAAA,MAAA,OAAmCG,UAAU,eAAcM,SAAA,EACvDT,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sBAAqBM,SAAA,EAChCC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,iBAAgBM,SAAEvB,EAAQ,KAC1CwB,EAAAA,EAAAA,KAAA,QAAMP,UAAU,oBAAmBM,SAC9BQ,EAAY5G,YAAYoB,MAAM,OAAO,IAAMwF,EAAY5G,eAE5DqG,EAAAA,EAAAA,KAAA,QAAMP,UAAU,iBAAgBM,SAC3BQ,EAAY5G,YAAYoB,MAAM,OAAO,SAI9CuE,EAAAA,EAAAA,MAAA,OAAKG,UAAU,sBAAqBM,SAAA,EAChCT,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYM,SAAA,EACvBC,EAAAA,EAAAA,KAAA,SAAOP,UAAU,aAAYM,SAAC,qBAC9BC,EAAAA,EAAAA,KAAA,SACIjC,KAAK,OACL0B,UAAU,aACVf,MAAO6B,EAAYpE,aACnBmG,SAAUlD,GAAKb,GAAkBC,EAAO,eAAgBY,EAAEmD,OAAO7D,OACjE8D,YAAY,wBACZC,SAAU9F,QAIlB2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYM,SAAA,EACvBC,EAAAA,EAAAA,KAAA,SAAOP,UAAU,aAAYM,SAAC,iBAC9BC,EAAAA,EAAAA,KAAA,SACIjC,KAAK,SACL0B,UAAU,aACV+C,YAAY,cACZ9D,MAAO6B,EAAYnE,MACnBkG,SAAUlD,GAAKb,GAAkBC,EAAO,QAASY,EAAEmD,OAAO7D,MAAQoC,OAAO1B,EAAEmD,OAAO7D,OAAS,IAC3F+D,SAAU9F,YAhChB4D,EAAY5G,oBA0ClC2F,EAAAA,EAAAA,MAAA,WAASG,UAAU,eAAcM,SAAA,EAC7BC,EAAAA,EAAAA,KAAA,MAAIP,UAAU,kBAAiBM,SAAC,0BAChCT,EAAAA,EAAAA,MAAA,OAAKG,UAAU,YAAWM,SAAA,EACtBT,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYM,SAAA,EACvBC,EAAAA,EAAAA,KAAA,SAAOP,UAAU,aAAYM,SAAC,kBAC9BC,EAAAA,EAAAA,KAAA,SACIjC,KAAK,OACL0B,UAAU,aACV+C,YAAY,qBACZ9D,MAAOrC,EACPiG,SAAUlD,GAAK9C,EAAe8C,EAAEmD,OAAO7D,OACvC+D,SAAU9F,QAGlB2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYM,SAAA,EACvBC,EAAAA,EAAAA,KAAA,SAAOP,UAAU,aAAYM,SAAC,aAC9BC,EAAAA,EAAAA,KAAA,SACIjC,KAAK,OACL0B,UAAU,aACV+C,YAAY,gBACZ9D,MAAOnC,EACP+F,SAAUlD,GAAK5C,EAAW4C,EAAEmD,OAAO7D,OACnC+D,SAAU9F,QAGlB2C,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYM,SAAA,EACvBC,EAAAA,EAAAA,KAAA,SAAOP,UAAU,aAAYM,SAAC,kBAC9BC,EAAAA,EAAAA,KAAA,SACIjC,KAAK,OACL0B,UAAU,aACV+C,YAAY,cACZ9D,MAAOjC,EACP6F,SAAUlD,GAAK1C,EAAe0C,EAAEmD,OAAO7D,OACvC+D,SAAU9F,QAGlBqD,EAAAA,EAAAA,KAAC0C,EAAAA,EAAS,CAACpH,SAAUA,EAAU1B,MAAOA,QAGxC+C,GAAmBmC,KACjBkB,EAAAA,EAAAA,KAAA,UACIP,UAAU,mBACVqC,QAnUFa,KACtB,IAAK7D,GAED,YADAjB,GAAU,qCAAsC,SAKpD,MAAM2D,GAAc,IAAI/F,MAAOmF,cAAc7F,MAAM,KAAK,GAClDqD,GAAQ,IAAI3C,MAAO4C,cAAgB,EACnCoD,EAAerD,GAAS,GAAKA,EAAQ,GAAK,MAAQ,QAExDnC,EAAgByF,QAAQnB,IACpB,MAAMqC,EAAalJ,EAAc6G,EAAY5G,YAAa8H,EAAcD,GAClEqB,EAAwB,CAC1BlJ,YAAa4G,EAAY5G,YACzBwC,aAAcoE,EAAYpE,aAC1BE,cACAE,UACAE,cACA7C,MAAO6H,EACP5H,KAAM2H,EACNsB,QAAQ,EACRjG,eACAE,kBACA8D,aAAcN,EAAYnE,MAAQ,CAAC,CAAEqE,IAAIC,EAAAA,EAAAA,KAAUtE,MAAO0E,OAAOP,EAAYnE,OAAQ2E,UAAW,IAAItF,OAAY,IAEpHN,aAAaC,QAAQwH,EAAYG,KAAKC,UAAUH,MAGpDjG,GAAmB,GACnBiB,GAAU,mCAAoC,YAqSKkC,SAC9B,kDAQbT,EAAAA,EAAAA,MAAA,OAAKG,UAAU,yBAAwBM,SAAA,EAEnCT,EAAAA,EAAAA,MAAA,WAASG,UAAU,6DAA4DM,SAAA,EAC3ET,EAAAA,EAAAA,MAAA,MAAIG,UAAU,kBAAiBM,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,eAAcM,SAAC,uBAAU,gCAExClD,EAAa3B,OAAS,IACnB8E,EAAAA,EAAAA,KAAA,QAAMP,UAAU,gCAA+BM,SAAElD,EAAa3B,aAGtEoE,EAAAA,EAAAA,MAAA,OAAKG,UAAU,0BAAyBM,SAAA,EACpCT,EAAAA,EAAAA,MAAA,UACIG,UAAU,4BACVqC,QAASA,IAAM5E,GAAkB,GAAM6C,SAAA,EAEvCC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,WAAUM,SAAC,MAAQ,kBAGtClD,EAAa3B,OAAS,IACnB8E,EAAAA,EAAAA,KAAA,OAAKP,UAAU,uBAAsBM,SAChClD,EAAaoG,QAAQC,UAAUrI,IAAI,CAACsI,EAAO3E,KACxCc,EAAAA,EAAAA,MAAA,OAAoBG,UAAS,kCAAA3F,OAA8C,IAAV0E,EAAc,SAAW,IAAKuB,SAAA,EAC3FT,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYM,SAAA,EACvBC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,cAAaM,SAAEoD,EAAM9F,SACrC2C,EAAAA,EAAAA,KAAA,QAAMP,UAAU,aAAYM,SAAC,WAEjCC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,aAAYM,SAAEoD,EAAM5F,aACpCyC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,aAAYM,SACvB,IAAItE,KAAK0H,EAAMpC,WAAWqC,mBAAmB,GAAI,CAAEC,KAAM,UAAWC,OAAQ,eAEjFtD,EAAAA,EAAAA,KAAA,UACIP,UAAU,mBACVqC,QAASA,KAAMyB,OAzS3B9C,EAySkD0C,EAAM1C,GAxSpF3D,EAAgBD,EAAa2G,OAAOL,GAASA,EAAM1C,KAAOA,SAC1D5C,GAAU,gBAAiB,WAFC4C,OA0SYL,MAAM,oBAAmBL,SAC5B,aAbKoD,EAAM1C,OAoB3B5D,EAAa3B,OAAS,IACnBoE,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gBAAeM,SAAA,EAC1BC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,kBACNT,EAAAA,EAAAA,MAAA,UAAAS,SAAA,CAASd,GAAWwE,QAAQ,GAAG,mBAO/CnE,EAAAA,EAAAA,MAAA,WAASG,UAAU,gEAA+DM,SAAA,EAC9ET,EAAAA,EAAAA,MAAA,MAAIG,UAAU,kBAAiBM,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,eAAcM,SAAC,iBAAS,mCAEvChD,EAAgB7B,OAAS,IACtB8E,EAAAA,EAAAA,KAAA,QAAMP,UAAU,mCAAkCM,SAAEhD,EAAgB7B,aAG5EoE,EAAAA,EAAAA,MAAA,OAAKG,UAAU,0BAAyBM,SAAA,EACpCT,EAAAA,EAAAA,MAAA,UACIG,UAAU,+BACVqC,QAASA,IAAM1E,GAAqB,GAAM2C,SAAA,EAE1CC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,WAAUM,SAAC,MAAQ,qBAGtChD,EAAgB7B,OAAS,IACtB8E,EAAAA,EAAAA,KAAA,OAAKP,UAAU,uBAAsBM,SAChChD,EAAgBkG,QAAQC,UAAUrI,IAAI,CAACsI,EAAO3E,KAC3Cc,EAAAA,EAAAA,MAAA,OAAoBG,UAAS,qCAAA3F,OAAiD,IAAV0E,EAAc,SAAW,IAAKuB,SAAA,EAC9FT,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYM,SAAA,EACvBC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,cAAaM,SAAEoD,EAAM1F,YACrCuC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,aAAYM,SAAC,YAEjCC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,eAAcM,SAAEoD,EAAMxF,kBACtCqC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,aAAYM,SACvB,IAAItE,KAAK0H,EAAMpC,WAAWqC,mBAAmB,GAAI,CAAEC,KAAM,UAAWC,OAAQ,eAEjFtD,EAAAA,EAAAA,KAAA,UACIP,UAAU,mBACVqC,QAASA,KAAM4B,OArVxBjD,EAqVkD0C,EAAM1C,GApVvFzD,EAAmBD,EAAgByG,OAAOL,GAASA,EAAM1C,KAAOA,SAChE5C,GAAU,gBAAiB,WAFI4C,OAsVSL,MAAM,oBAAmBL,SAC5B,aAbKoD,EAAM1C,OAoB3B1D,EAAgB7B,OAAS,IACtBoE,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gBAAeM,SAAA,EAC1BC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,qBACNT,EAAAA,EAAAA,MAAA,UAAAS,SAAA,CAAS4D,KAAKC,MAAMvE,GAAgB,IAAI,KAAGA,GAAgB,GAAG,iBAO9EC,EAAAA,EAAAA,MAAA,UACIG,UAAU,iBACVqC,QApWM+B,KACjBlH,EAKuB,IAAxBE,EAAa3B,QAA2C,IAA3B6B,EAAgB7B,OAKjDc,GAAqB,GAJjB6B,GAAU,kDAAmD,SAL7DA,GAAU,oCAAqC,UAmWnC4E,UAAW9F,GAAmBhB,EAAaoE,SAAA,CAC9C,kBACmB9D,EAAgBf,OAAO,aACvC8E,EAAAA,EAAAA,KAAA,OAAKgC,QAAQ,YAAYC,KAAK,OAAOC,OAAO,eAAeC,YAAY,IAAI2B,MAAM,KAAKC,OAAO,KAAIhE,UAC7FC,EAAAA,EAAAA,KAAA,QAAMoC,EAAE,sCAOxBpC,EAAAA,EAAAA,KAACgE,EAAAA,EAAe,CAAAjE,SACX9C,IACG+C,EAAAA,EAAAA,KAACT,EAAAA,EAAOC,IAAG,CACPC,UAAU,gBACVC,QAAS,CAAEC,QAAS,GACpBE,QAAS,CAAEF,QAAS,GACpBG,KAAM,CAAEH,QAAS,GACjBmC,QAASA,IAAM5E,GAAkB,GAAO6C,UAExCT,EAAAA,EAAAA,MAACC,EAAAA,EAAOC,IAAG,CACPC,UAAU,gBACVC,QAAS,CAAEC,QAAS,EAAGsE,MAAO,IAC9BpE,QAAS,CAAEF,QAAS,EAAGsE,MAAO,GAC9BnE,KAAM,CAAEH,QAAS,EAAGsE,MAAO,IAC3BnC,QAAS1C,GAAKA,EAAE8E,kBAAkBnE,SAAA,EAElCC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,kBACJT,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYM,SAAA,EACvBT,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYM,SAAA,EACvBC,EAAAA,EAAAA,KAAA,SAAOP,UAAU,aAAYM,SAAC,iBAC9BC,EAAAA,EAAAA,KAAA,SACIjC,KAAK,SACL0B,UAAU,aACVf,MAAOrB,EACPiF,SAAUlD,GAAK9B,EAAS8B,EAAEmD,OAAO7D,MAAQoC,OAAO1B,EAAEmD,OAAO7D,OAAS,IAClE8D,YAAY,qBACZ2B,WAAS,QAGjB7E,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYM,SAAA,EACvBC,EAAAA,EAAAA,KAAA,SAAOP,UAAU,aAAYM,SAAC,gBAC9BT,EAAAA,EAAAA,MAAA,UACIG,UAAU,cACVf,MAAOnB,EACP+E,SAAUlD,GAAK5B,EAAa4B,EAAEmD,OAAO7D,OAAOqB,SAAA,EAE5CC,EAAAA,EAAAA,KAAA,UAAQtB,MAAM,GAAEqB,SAAC,gBAChBqE,EAAAA,GAAYvJ,IAAIwJ,IACbrE,EAAAA,EAAAA,KAAA,UAAgBtB,MAAO2F,EAAEtE,SAAEsE,GAAdA,cAK7B/E,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gBAAeM,SAAA,EAC1BC,EAAAA,EAAAA,KAAA,UAAQP,UAAU,eAAeqC,QAASA,IAAM5E,GAAkB,GAAO6C,SAAC,YAC1EC,EAAAA,EAAAA,KAAA,UAAQP,UAAU,gBAAgBqC,QAzcpCwC,KACtB,GAAIjH,GAASE,EAAW,CACpB,MAAMgH,EAAuB,CACzB9D,IAAIC,EAAAA,EAAAA,KACJrD,MAAOyD,OAAOzD,GACdE,YACAwD,UAAW,IAAItF,MAEnBqB,EAAgB,IAAID,EAAc0H,IAClCjH,EAAS,IACTE,EAAa,IACbN,GAAkB,GAClBW,GAAU,oBAAqB,UACnC,GA4bsF4E,UAAWpF,IAAUE,EAAUwC,SAAC,yBAUlHC,EAAAA,EAAAA,KAACgE,EAAAA,EAAe,CAAAjE,SACX5C,IACG6C,EAAAA,EAAAA,KAACT,EAAAA,EAAOC,IAAG,CACPC,UAAU,gBACVC,QAAS,CAAEC,QAAS,GACpBE,QAAS,CAAEF,QAAS,GACpBG,KAAM,CAAEH,QAAS,GACjBmC,QAASA,IAAM1E,GAAqB,GAAO2C,UAE3CT,EAAAA,EAAAA,MAACC,EAAAA,EAAOC,IAAG,CACPC,UAAU,gBACVC,QAAS,CAAEC,QAAS,EAAGsE,MAAO,IAC9BpE,QAAS,CAAEF,QAAS,EAAGsE,MAAO,GAC9BnE,KAAM,CAAEH,QAAS,EAAGsE,MAAO,IAC3BnC,QAAS1C,GAAKA,EAAE8E,kBAAkBnE,SAAA,EAElCC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,qBACJT,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYM,SAAA,EACvBT,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYM,SAAA,EACvBC,EAAAA,EAAAA,KAAA,SAAOP,UAAU,aAAYM,SAAC,wBAC9BC,EAAAA,EAAAA,KAAA,SACIjC,KAAK,SACL0B,UAAU,aACVf,MAAOjB,EACP6E,SAAUlD,GAAK1B,GAAY0B,EAAEmD,OAAO7D,MAAQoC,OAAO1B,EAAEmD,OAAO7D,OAAS,IACrE8D,YAAY,iBACZ2B,WAAS,QAGjB7E,EAAAA,EAAAA,MAAA,OAAKG,UAAU,aAAYM,SAAA,EACvBC,EAAAA,EAAAA,KAAA,SAAOP,UAAU,aAAYM,SAAC,YAC9BT,EAAAA,EAAAA,MAAA,UACIG,UAAU,cACVf,MAAOf,GACP2E,SAAUlD,GAAKxB,GAAkBwB,EAAEmD,OAAO7D,OAAOqB,SAAA,EAEjDC,EAAAA,EAAAA,KAAA,UAAQtB,MAAM,GAAEqB,SAAC,kBAChByE,EAAAA,GAAiB3J,IAAI4J,IAClBzE,EAAAA,EAAAA,KAAA,UAAgBtB,MAAO+F,EAAE1E,SAAE0E,GAAdA,cAK7BnF,EAAAA,EAAAA,MAAA,OAAKG,UAAU,gBAAeM,SAAA,EAC1BC,EAAAA,EAAAA,KAAA,UAAQP,UAAU,eAAeqC,QAASA,IAAM1E,GAAqB,GAAO2C,SAAC,YAC7EC,EAAAA,EAAAA,KAAA,UAAQP,UAAU,gBAAgBqC,QA/ejC4C,KACzB,GAAIjH,GAAYE,GAAgB,CAC5B,MAAM4G,EAA0B,CAC5B9D,IAAIC,EAAAA,EAAAA,KACJjD,SAAUqD,OAAOrD,GACjBE,kBACAoD,UAAW,IAAItF,MAEnBuB,EAAmB,IAAID,EAAiBwH,IACxC7G,GAAY,IACZE,GAAkB,IAClBR,GAAqB,GACrBS,GAAU,uBAAwB,UACtC,GAkeyF4E,UAAWhF,IAAaE,GAAeoC,SAAC,2B,iECnpBzI,MAgBA,EAhB4C4E,IAA0B,IAAzB,SAAErJ,EAAQ,MAAE1B,GAAO+K,EAC9D,OACErF,EAAAA,EAAAA,MAAA,OAAKG,UAAU,kBAAiBM,SAAA,EAC9BT,EAAAA,EAAAA,MAAA,OAAKG,UAAU,oBAAmBM,SAAA,EAChCC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,aAAYM,SAAC,kBAC7BC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,kBAAiBM,UAAE6E,EAAAA,EAAAA,IAAOtJ,EAAU,YACpD0E,EAAAA,EAAAA,KAAA,QAAMP,UAAU,aAAYM,UAAE6E,EAAAA,EAAAA,IAAOtJ,EAAU,qBAEjDgE,EAAAA,EAAAA,MAAA,OAAKG,UAAU,kBAAiBM,SAAA,EAC9BC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,aAAYM,SAAC,kBAC7BC,EAAAA,EAAAA,KAAA,QAAMP,UAAU,eAAcM,UAAE6E,EAAAA,EAAAA,IAAOtJ,EAAU,oB,2ECJzD,MAiEA,EAjEoDqJ,IAS7C,IAT8C,OACnDxE,EAAM,MACNC,EAAK,QACLtC,EAAO,YACP+G,EAAc,UAAS,WACvBC,EAAa,SAAQ,UACrBzE,EAAS,SACTwB,EAAQ,KACR9D,EAAO,WACR4G,EAYC,OACE3E,EAAAA,EAAAA,KAACgE,EAAAA,EAAe,CAAAjE,SACbI,IACCH,EAAAA,EAAAA,KAACT,EAAAA,EAAOC,IAAG,CACTC,UAAU,yBACVC,QAAS,CAAEC,QAAS,GACpBE,QAAS,CAAEF,QAAS,GACpBG,KAAM,CAAEH,QAAS,GACjBmC,QAASD,EAAS9B,UAElBT,EAAAA,EAAAA,MAACC,EAAAA,EAAOC,IAAG,CACTC,UAAU,iBACVC,QAAS,CAAEC,QAAS,EAAGsE,MAAO,GAAKhE,EAAG,IACtCJ,QAAS,CAAEF,QAAS,EAAGsE,MAAO,EAAGhE,EAAG,GACpCH,KAAM,CAAEH,QAAS,EAAGsE,MAAO,GAAKhE,EAAG,IACnC6B,QAAU1C,GAAMA,EAAE8E,kBAAkBnE,SAAA,EAEpCC,EAAAA,EAAAA,KAAA,OAAKP,UAAU,wBAAuBM,UACpCC,EAAAA,EAAAA,KAAA,MAAAD,SAAKK,OAEPJ,EAAAA,EAAAA,KAAA,OAAKP,UAAU,sBAAqBM,UAClCC,EAAAA,EAAAA,KAAA,KAAAD,SAAIjC,OAENwB,EAAAA,EAAAA,MAAA,OAAKG,UAAU,wBAAuBM,SAAA,EACpCC,EAAAA,EAAAA,KAAA,UACEP,UAAU,4BACVqC,QAASD,EAAS9B,SAEjB+E,KAEH9E,EAAAA,EAAAA,KAAA,UACEP,UAAS,OAAA3F,OA1CAiL,MACrB,OAAQhH,GACN,IAAK,SACH,MAAO,aACT,IAAK,UACH,MAAO,cACT,QACE,MAAO,gBAmCmBgH,IAClBjD,QAASzB,EAAUN,SAElB8E,c,qDCwDV,MACMG,EAAsB,GAGtBZ,EAAwB,CACnC,iBACA,mBACA,oBACA,qBAeWI,EAA6B,CACxC,oBACA,wBACA,aACA,oB,kCCxJF,MACA,GAAiBS,WADoB,qBAAXC,QAA0BA,OAAOD,YAAcC,OAAOD,WAAWE,KAAKD,SCAhG,IAAIE,EACJ,MAAMC,EAAQ,IAAIC,WAAW,ICA7B,MAAMC,EAAY,GAClB,IAAK,IAAIC,EAAI,EAAGA,EAAI,MAAOA,EACvBD,EAAUE,MAAMD,EAAI,KAAOE,SAAS,IAAIzC,MAAM,IAE3C,SAAS0C,EAAgBC,GAAiB,IAAZC,EAAMC,UAAA5K,OAAA,QAAA6K,IAAAD,UAAA,GAAAA,UAAA,GAAG,EAC1C,OAAQP,EAAUK,EAAIC,EAAS,IAC3BN,EAAUK,EAAIC,EAAS,IACvBN,EAAUK,EAAIC,EAAS,IACvBN,EAAUK,EAAIC,EAAS,IACvB,IACAN,EAAUK,EAAIC,EAAS,IACvBN,EAAUK,EAAIC,EAAS,IACvB,IACAN,EAAUK,EAAIC,EAAS,IACvBN,EAAUK,EAAIC,EAAS,IACvB,IACAN,EAAUK,EAAIC,EAAS,IACvBN,EAAUK,EAAIC,EAAS,IACvB,IACAN,EAAUK,EAAIC,EAAS,KACvBN,EAAUK,EAAIC,EAAS,KACvBN,EAAUK,EAAIC,EAAS,KACvBN,EAAUK,EAAIC,EAAS,KACvBN,EAAUK,EAAIC,EAAS,KACvBN,EAAUK,EAAIC,EAAS,MAAMxD,aACrC,CCvBA,SAAS2D,EAAIC,EAASC,EAAKL,GAAQ,IAAAlB,EAAAwB,EAAAC,EAAAC,EAE/B,MAAMC,EAAwC,QAApC3B,EAAiB,QAAjBwB,GADVF,EAAUA,GAAW,CAAC,GACDM,cAAM,IAAAJ,EAAAA,EAAe,QAAfC,GAAIC,EAAAJ,GAAQO,WAAG,IAAAJ,OAAA,EAAXA,EAAAK,KAAAJ,UAAe,IAAA1B,EAAAA,EFHnC,WACX,IAAKS,EAAiB,CAClB,GAAsB,qBAAXF,SAA2BA,OAAOE,gBACzC,MAAM,IAAIsB,MAAM,4GAEpBtB,EAAkBF,OAAOE,gBAAgBD,KAAKD,OAClD,CACA,OAAOE,EAAgBC,EAC3B,CELsDmB,GAClD,GAAIF,EAAKpL,OAAS,GACd,MAAM,IAAIwL,MAAM,qCAIpB,GAFAJ,EAAK,GAAgB,GAAVA,EAAK,GAAa,GAC7BA,EAAK,GAAgB,GAAVA,EAAK,GAAa,IACzBJ,EAAK,CAEL,IADAL,EAASA,GAAU,GACN,GAAKA,EAAS,GAAKK,EAAIhL,OAChC,MAAM,IAAIyL,WAAW,mBAAD7M,OAAoB+L,EAAM,KAAA/L,OAAI+L,EAAS,GAAE,6BAEjE,IAAK,IAAIL,EAAI,EAAGA,EAAI,KAAMA,EACtBU,EAAIL,EAASL,GAAKc,EAAKd,GAE3B,OAAOU,CACX,CACA,OAAOP,EAAgBW,EAC3B,CAOA,QANA,SAAYL,EAASC,EAAKL,GACtB,OAAIe,EAAO3B,YAAeiB,GAAQD,EAG3BD,EAAIC,EAASC,EAAKL,GAFde,EAAO3B,YAGtB,C,4MChBA,MAAM4B,EAAc,yBACdC,EAAe,gBAEfC,EAAyB,2BA0BlBC,EAAuBA,KAClC,MAAMC,EAAS9L,aAAa+L,QAAQH,GACpC,IAAKE,EAAQ,MAAO,GACpB,IACE,OAAOlE,KAAKoE,MAAMF,EACpB,CAAE,MAAAG,GACA,MAAO,EACT,GAIWC,EAAsBA,CACjCC,EACA3F,KAEA,MAAM4F,EAAQP,IACRzC,EAA6B,CACjC9D,GAAG,UAAD3G,OAAY2B,KAAK0C,MAAK,KAAArE,OAAI6J,KAAK4C,SAASb,SAAS,IAAI8B,OAAO,EAAG,IACjEzG,WAAW,IAAItF,MAAOmF,cACtB6G,WAAY,EACZC,WAAY,EACZJ,OACA3F,SAEF4F,EAAM9B,KAAKlB,GACXpJ,aAAaC,QAAQ2L,EAAwBhE,KAAKC,UAAUuE,KAIjDI,EAA0BlH,IACrC,MACMmH,EADQZ,IACSxD,OAAOqE,GAAKA,EAAEpH,KAAOA,GAC5CtF,aAAaC,QAAQ2L,EAAwBhE,KAAKC,UAAU4E,KAIjDE,EAAyBxH,UAKpC,IAAKyH,EAAAA,GACH,MAAO,CAAEC,UAAW,EAAGC,OAAQ,EAAGC,UAAWlB,IAAuB9L,QAGtE,MAAMqM,EAAQP,IACd,IAAIgB,EAAY,EACZC,EAAS,EAEb,IAAK,MAAME,KAAcZ,EACvB,GAAIY,EAAWV,YAAcU,EAAWT,WAEtCO,SAIF,UACQ/G,EAAAA,EAAAA,IACJiH,EAAWb,KAAK9G,UAChB2H,EAAWb,KAAKzK,aAChBsL,EAAWb,KAAKvK,gBAChBoL,EAAWb,KAAKzG,aAChBsH,EAAWb,KAAKc,kBAChBD,EAAWb,KAAKe,kBAChBF,EAAWb,KAAKgB,mBAElBX,EAAuBQ,EAAW1H,IAClCuH,GACF,CAAE,MAAO5I,GAEP,MAAMmJ,EAAevB,IAAuBnM,IAAIgN,GAC9CA,EAAEpH,KAAO0H,EAAW1H,IAAE5B,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACbgJ,GAAC,IAAEJ,WAAYI,EAAEJ,WAAa,EAAG9F,MAAO6G,OAAOpJ,KACpDyI,GAEN1M,aAAaC,QAAQ2L,EAAwBhE,KAAKC,UAAUuF,IAC5DN,GACF,CAGF,MAAO,CACLD,YACAC,SACAC,UAAWlB,IAAuB9L,SAyEzBuN,EAAkBA,KAC7B,MAAMC,EAAiB,uBACjBC,EAAcxN,aAAa+L,QAAQwB,GACnCvK,EAAM,IAAI1C,KAEhB,GAAIkN,EAAa,CACf,MAAMC,EAAW,IAAInN,KAAKkN,GAE1B,IAD2BxK,EAAI0K,UAAYD,EAASC,WAAS,KACrC,GACtB,MAEJ,CAGA,MAAMC,EAzEyBC,MAC/B,MAAMC,EAAUC,IACV9K,EAAM,IAAI1C,KACVyN,EAAa,IAAIzN,KAAK0C,EAAI0K,UAAYM,QAG5C,IAAIC,EAAUJ,EAAQxF,OAAO6F,GACV,IAAI5N,KAAK4N,EAAKxP,OACZqP,GAIjBE,EAAQlO,OArIc,MAsIxBkO,EAAUA,EAAQnG,MAAM,EAtIA,MAyI1B,MAAMqG,EAAUN,EAAQ9N,OAASkO,EAAQlO,OAOzC,OALIoO,EAAU,IACZnO,aAAaC,QAAQyL,EAAa9D,KAAKC,UAAUoG,IACjDxH,QAAQ2H,IAAI,cAADzP,OAAewP,EAAO,0BAG5B,CAAEA,UAASpB,UAAWkB,EAAQlO,SAkDtB6N,GACf5N,aAAaC,QAAQsN,EAAgBvK,EAAIyC,eAErCkI,EAAOQ,QAAU,GACnB1H,QAAQ2H,IAAI,4BAADzP,OAA6BgP,EAAOQ,QAAO,cAAAxP,OAAagP,EAAOZ,UAAS,gBAKvF,IAAIsB,GAAc,EACdC,EAAkC,KAClCC,EAAuD,GAG3D,MAAMC,EAAkBC,IAAqB,CAC3CnJ,GAAImJ,EAAOnJ,GACX3F,KAAM8O,EAAO9O,KACb+O,OAAQD,EAAOC,OACfC,gBAAiBF,EAAOG,iBACxBC,aAAcJ,EAAOK,cACrBxI,aAAcmI,EAAOM,cACrBC,eAAgBP,EAAOQ,gBACvBC,WAAYT,EAAOU,YACnBC,cAAeX,EAAOY,eACtBC,gBAAiBb,EAAOc,oBAIpBC,EAAoBhK,IAAgB,CACxCF,GAAIE,EAAQF,GACZ3F,KAAM6F,EAAQ7F,KACd+O,OAAQlJ,EAAQkJ,OAChBE,iBAAkBpJ,EAAQmJ,gBAC1BG,cAAetJ,EAAQqJ,aACvBE,cAAevJ,EAAQc,aACvB2I,gBAAiBzJ,EAAQwJ,eACzBG,YAAa3J,EAAQ0J,WACrBG,eAAgB7J,EAAQ4J,cACxBG,kBAAmB/J,EAAQ8J,kBAIhBG,EAAqBtK,UAChC,IACE,MAAMuK,QAAgBC,EAAAA,EAAAA,MAEtB,GAAID,EAAQ3P,OAAS,EAKnB,OAJAuO,EAAgBoB,EAAQhQ,IAAI8O,GAE5BxO,aAAaC,QAAQ0L,EAAc/D,KAAKC,UAAUyG,IAClDtO,aAAaC,QAvPO,sBAuPoB,IAAIK,MAAOmF,eAC5C6I,EACF,CAEL7H,QAAQ2H,IAAI,gDACZ,MAAMwB,EAAkB/F,EAAAA,GAASnK,IAAI8P,GAIrC,aAHMK,EAAAA,EAAAA,IAAuBD,GAC7BtB,EAAgBzE,EAAAA,GAChB7J,aAAaC,QAAQ0L,EAAc/D,KAAKC,UAAUgC,EAAAA,KAC3CA,EAAAA,EACT,CACF,CAAE,MAAOrD,GAGP,OAFAC,QAAQD,MAAM,0DAA2DA,GACzE6H,GAAc,EACPyB,GACT,GAIWC,EAA6BC,IACxCzB,EAAkBjE,KAAK0F,GAGvB,MAMMC,GAAcC,EAAAA,EAAAA,IACjBR,IACCpB,EAAgBoB,EAAQhQ,IAAI8O,GAC5BxO,aAAaC,QAAQ0L,EAAc/D,KAAKC,UAAUyG,IAGlDC,EAAkBhI,QAAQ4J,GAAYA,EAAS7B,KAZxB8B,KACT9B,GAAiBwB,KAClBpQ,IAAI8P,IAgBrB,MAAO,KACLjB,EAAoBA,EAAkBlG,OAAOgI,GAAKA,IAAML,GACvB,IAA7BzB,EAAkBxO,QACpBkQ,MAMAH,EAAuBA,KAC3B,MAAMhE,EAAS9L,aAAa+L,QAAQJ,GACpC,IAAKG,EAEH,OADA9L,aAAaC,QAAQ0L,EAAc/D,KAAKC,UAAUgC,EAAAA,KAC3CA,EAAAA,GAGT,IACE,OAAOjC,KAAKoE,MAAMF,EACpB,CAAE,MAAAwE,GACA,OAAOzG,EAAAA,EACT,GAIW/D,EAAiBqG,IAC5B,MAAMoE,EAAWzC,IACjByC,EAASC,QAAQrE,GACjBnM,aAAaC,QAAQyL,EAAa9D,KAAKC,UAAU0I,IAGjDE,EAA4BtE,EAAK3G,QAAS2G,EAAKtG,YAAYJ,gBAIhDqI,EAAkBA,KAC7B,MAAMhC,EAAS9L,aAAa+L,QAAQL,GACpC,IAAKI,EAAQ,MAAO,GAEpB,IAEE,OADelE,KAAKoE,MAAMF,GACZpM,IAAKwO,IAASxK,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACvBwK,GAAI,IACPrI,YAAa,IAAIvF,KAAK4N,EAAKrI,aAC3BnE,aAAcwM,EAAKxM,aAAahC,IAAKgR,IAAMhN,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACtCgN,GAAC,IACJ9K,UAAW,IAAItF,KAAKoQ,EAAE9K,cAExBhE,gBAAiBsM,EAAKtM,gBAAgBlC,IAAKuH,IAAMvD,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAC5CuD,GAAC,IACJrB,UAAW,IAAItF,KAAK2G,EAAErB,gBAG5B,CAAE,MAAA+K,GACA,MAAO,EACT,GAmBWC,EAAgBA,KAC3B,MAAMC,GAAQ,IAAIvQ,MAAOmF,cAAc7F,MAAM,KAAK,GAE5CkR,EADUhD,IACUzF,OAAO6F,GAAQA,EAAKxP,OAASmS,GAMvD,MAAO,CAAE/M,WAJUgN,EAAU/M,OAAO,CAACC,EAAKkK,IAASlK,EAAMkK,EAAKpK,WAAY,GAIrDI,cAHC4M,EAAU/M,OAAO,CAACC,EAAKkK,IAASlK,EAAMkK,EAAKhK,cAAe,GAG5C6M,gBAFZD,EAAU/Q,SAMvB0Q,EAA8BA,CAACjS,EAAqBoH,KAC/D,MAAMoL,EAAWC,IACXC,EAAeF,EAASG,UAAUtN,GAAKA,EAAElE,OAASnB,IAClC,IAAlB0S,IACFF,EAASE,GAAclC,eAAiBoC,EAAW,IAAI9Q,KAAKsF,KAE9D5F,aAAaC,QAAQ0L,EAAc/D,KAAKC,UAAUmJ,KAIvCC,EAAkBA,IAEzB3C,GAKGwB,IAIIuB,EAAgBlM,MAAOmM,EAAmBC,KACrD,MAAMP,EAAWC,IACX5N,EAAQ2N,EAASG,UAAUtN,GAAKA,EAAEyB,KAAOgM,GAC/C,IAAe,IAAXjO,IACF2N,EAAS3N,IAAMK,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQsN,EAAS3N,IAAWkO,GAC3CjD,EAAgB0C,EAChBhR,aAAaC,QAAQ0L,EAAc/D,KAAKC,UAAUmJ,IAG9C3C,GACF,UACQmD,EAAAA,EAAAA,IAAchC,EAAiBwB,EAAS3N,IAChD,CAAE,MAAOmD,GACPC,QAAQD,MAAM,6CAA8CA,EAC9D,GAMOiL,EAAatM,UACxB,MAAM6L,EAAWC,IAMjB,GALAD,EAAS1G,KAAK9E,GACd8I,EAAgB0C,EAChBhR,aAAaC,QAAQ0L,EAAc/D,KAAKC,UAAUmJ,IAG9C3C,EACF,UACQmD,EAAAA,EAAAA,IAAchC,EAAiBhK,GACvC,CAAE,MAAOgB,GACPC,QAAQD,MAAM,0CAA2CA,EAC3D,GAKSkL,EAAgBvM,UAC3B,MACMsH,EADWwE,IACS5I,OAAOxE,GAAKA,EAAEyB,KAAOgM,GAK/C,GAJAhD,EAAgB7B,EAChBzM,aAAaC,QAAQ0L,EAAc/D,KAAKC,UAAU4E,IAG9C4B,EACF,UACQsD,EAAAA,EAAAA,IAAcL,EACtB,CAAE,MAAO9K,GACPC,QAAQD,MAAM,0CAA2CA,EAC3D,GAoBS4K,EAAc1S,IACzB,MACMkT,GADM,IAAItR,MACGoN,UAAYhP,EAAKgP,UAC9BmE,EAAWrJ,KAAKC,MAAMmJ,EAAS,KAC/BE,EAAYtJ,KAAKC,MAAMoJ,EAAW,IAClCE,EAAWvJ,KAAKC,MAAMqJ,EAAY,IAExC,OAAID,EAAW,EAAU,WACrBA,EAAW,GAAU,GAANlT,OAAUkT,EAAQ,YACjCC,EAAY,GAAU,GAANnT,OAAUmT,EAAS,SAAAnT,OAAQmT,EAAY,EAAI,IAAM,GAAE,QACjE,GAANnT,OAAUoT,EAAQ,QAAApT,OAAOoT,EAAW,EAAI,IAAM,GAAE,SAIrCC,EAAcA,CAAC7F,EAAmB8F,KAC7C,MAgBMC,EAAmB,GAEzB/F,EAAK5F,QAAQ2H,IACX,MAAMiE,EAAU,CACdjE,EAAKxP,KACLwP,EAAKzP,MACLyP,EAAKlN,aACLkN,EAAK1I,QACL0I,EAAKhN,YACLgN,EAAK9M,QACL8M,EAAK5M,aAEDuE,EAAc,IAAIvF,KAAK4N,EAAKrI,aAAauM,iBAG3ClE,EAAKxM,cAAgBwM,EAAKxM,aAAa3B,OAAS,GAClDmO,EAAKxM,aAAa6E,QAAQmK,IACxBwB,EAAK5H,KAAK,IACL6H,EACH,QACAzB,EAAEtO,UACFsO,EAAExO,MAAMoG,QAAQ,GAChB,GACA,GACAzC,MAMFqI,EAAKtM,iBAAmBsM,EAAKtM,gBAAgB7B,OAAS,GACxDmO,EAAKtM,gBAAgB2E,QAAQU,IAC3BiL,EAAK5H,KAAK,IACL6H,EACH,WACA,GACA,GACAlL,EAAEzE,eACFyE,EAAE3E,SAASiI,WACX1E,MAMAqI,EAAKxM,cAA6C,IAA7BwM,EAAKxM,aAAa3B,QACzCmO,EAAKtM,iBAAmD,IAAhCsM,EAAKtM,gBAAgB7B,QAC/CmS,EAAK5H,KAAK,IACL6H,EACH,UACA,GACAjE,EAAKpK,WAAWwE,QAAQ,GACxB,GACA4F,EAAKhK,cAAcqG,WACnB1E,MAKN,MAAMwM,EAAa,CA3EH,CACd,OACA,QACA,WACA,UACA,eACA,UACA,eACA,aACA,aACA,aACA,kBACA,iBACA,gBA+DQxS,KAAK,QACVqS,EAAKxS,IAAI4S,GAAOA,EAAI5S,IAAI6S,GAAI,IAAA5T,OAAQ4T,EAAI,MAAK1S,KAAK,OACrDA,KAAK,MAED2S,EAAO,IAAIC,KAAK,CAACJ,GAAa,CAAEzP,KAAM,4BACtC8P,EAAOC,SAASC,cAAc,KAC9BC,EAAMC,IAAIC,gBAAgBP,GAChCE,EAAKM,aAAa,OAAQH,GAC1BH,EAAKM,aAAa,WAAW,GAADrU,OAAKsT,EAAQ,SACzCS,EAAKO,MAAMC,WAAa,SACxBP,SAASQ,KAAKC,YAAYV,GAC1BA,EAAKW,QACLV,SAASQ,KAAKG,YAAYZ,GAE1BI,IAAIS,gBAAgBV,IAahBW,EAAwB,cAOjBC,EAAwBjV,IAEnC,MAAMkV,EAAQlV,EAAYkV,MAAM,gCAChC,OAAIA,EACKA,EAAM,GAAGC,OAGXnV,GAMHoV,EAAkBA,CAACC,EAA2BpV,EAAeC,IAC3D,GAANC,OAAU6U,GAAqB7U,OAAGkV,EAAiB,KAAAlV,OAAIF,EAAK,KAAAE,OAAID,GAMrDoV,EAAgBA,CAC3BtV,EACAC,EACAC,EACAuC,KAEA,MAAM8S,EAAaN,EAAqBjV,GAClCwV,EAAMJ,EAAgBG,EAAYtV,EAAOC,GAEzCyN,EAAO,CACXlL,QACAgT,WAAW,IAAI3T,MAAOmF,cACtByO,UAAW1V,GAGbwB,aAAaC,QAAQ+T,EAAKpM,KAAKC,UAAUsE,IACzC1F,QAAQ2H,IAAI,iCAADzP,OAAwBsC,EAAK,aAAAtC,OAAYoV,KAMzCI,EAAeA,CAC1B3V,EACAC,EACAC,KAEA,MAAMqV,EAAaN,EAAqBjV,GAClCwV,EAAMJ,EAAgBG,EAAYtV,EAAOC,GAEzCoN,EAAS9L,aAAa+L,QAAQiI,GACpC,IAAKlI,EAAQ,OAAO,KAEpB,IACE,MAAMK,EAAOvE,KAAKoE,MAAMF,GAExB,OADArF,QAAQ2H,IAAI,kCAADzP,OAAyBwN,EAAKlL,MAAK,aAAAtC,OAAYoV,EAAU,aAAApV,OAAYwN,EAAK+H,UAAS,MACvF/H,CACT,CAAE,MAAAiI,GACA,OAAO,IACT,E","sources":["pages/MultiCaptureScreen.tsx","components/ShiftInfo.tsx","components/ConfirmDialog.tsx","types.ts","../node_modules/uuid/dist/native.js","../node_modules/uuid/dist/rng.js","../node_modules/uuid/dist/stringify.js","../node_modules/uuid/dist/v4.js","lib/storage.ts"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport ShiftInfo from '../components/ShiftInfo';\r\nimport ConfirmDialog from '../components/ConfirmDialog';\r\nimport { WasteEntry, DowntimeEntry, ShiftData, ShiftSession, OPERATORS, WASTE_TYPES, DOWNTIME_REASONS } from '../types';\r\nimport { submitShiftData } from '../lib/supabase';\r\nimport { saveShiftData } from '../lib/storage';\r\n\r\n// Storage key for shift session\r\nconst getSessionKey = (machineName: string, shift: string, date: string) =>\r\n    `shift_session_${machineName}_${shift}_${date}`;\r\n\r\n// Interface for per-machine data\r\ninterface MachineData {\r\n    machineName: string;\r\n    operatorName: string;\r\n    speed: number | '';\r\n}\r\n\r\nconst MultiCaptureScreen: React.FC = () => {\r\n    const location = useLocation();\r\n    const navigate = useNavigate();\r\n\r\n    // Get machine names from navigation state - memoized to prevent re-renders\r\n    const machineNames = useMemo(() =>\r\n        (location.state as { machineNames?: string[] })?.machineNames || [],\r\n        [location.state]\r\n    );\r\n    const parentGroup = (location.state as { parentGroup?: string })?.parentGroup || '';\r\n    const isMultiMachine = (location.state as { isMultiMachine?: boolean })?.isMultiMachine || false;\r\n\r\n    // Extract machine numbers for display (e.g., \"1, 2\" from \"Canline - Machine 1, Canline - Machine 2\")\r\n    const machineNumbers = useMemo(() =>\r\n        machineNames.map(name => name.split(' - Machine ')[1] || '?').join(', '),\r\n        [machineNames]\r\n    );\r\n\r\n    // Redirect if no machines selected\r\n    useEffect(() => {\r\n        if (!isMultiMachine || machineNames.length === 0) {\r\n            navigate('/');\r\n        }\r\n    }, [isMultiMachine, machineNames, navigate]);\r\n\r\n    // Track current machine(s) for chat widget location context\r\n    useEffect(() => {\r\n        if (parentGroup && machineNumbers) {\r\n            localStorage.setItem('chat_current_machine', `${parentGroup} - Machine ${machineNumbers}`);\r\n        }\r\n        return () => {\r\n            localStorage.removeItem('chat_current_machine');\r\n        };\r\n    }, [parentGroup, machineNumbers]);\r\n\r\n\r\n    const [dateTime, setDateTime] = useState(new Date());\r\n    const [shift, setShift] = useState('');\r\n\r\n    // Loading and feedback states\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [toast, setToast] = useState<{ message: string; type: 'success' | 'error' } | null>(null);\r\n    const [showConfirmDialog, setShowConfirmDialog] = useState(false);\r\n\r\n    // Per-machine data: operator and speed for each machine\r\n    const [machineDataList, setMachineDataList] = useState<MachineData[]>(\r\n        machineNames.map(name => ({ machineName: name, operatorName: '', speed: '' }))\r\n    );\r\n\r\n    // Shared order details\r\n    const [orderNumber, setOrderNumber] = useState('');\r\n    const [product, setProduct] = useState('');\r\n    const [batchNumber, setBatchNumber] = useState('');\r\n    const [isSessionLocked, setIsSessionLocked] = useState(false);\r\n\r\n    // Shared waste and downtime entries (apply to all machines)\r\n    const [wasteEntries, setWasteEntries] = useState<WasteEntry[]>([]);\r\n    const [downtimeEntries, setDowntimeEntries] = useState<DowntimeEntry[]>([]);\r\n\r\n    // Modal states\r\n    const [showWasteModal, setShowWasteModal] = useState(false);\r\n    const [showDowntimeModal, setShowDowntimeModal] = useState(false);\r\n    const [waste, setWaste] = useState<number | ''>('');\r\n    const [wasteType, setWasteType] = useState('');\r\n    const [downtime, setDowntime] = useState<number | ''>('');\r\n    const [downtimeReason, setDowntimeReason] = useState('');\r\n\r\n    // Toast notification\r\n    const showToast = (message: string, type: 'success' | 'error') => {\r\n        setToast({ message, type });\r\n        setTimeout(() => setToast(null), 4000);\r\n    };\r\n\r\n    // Update shift and time\r\n    useEffect(() => {\r\n        const timer = setInterval(() => {\r\n            const now = new Date();\r\n            setDateTime(now);\r\n        }, 1000);\r\n\r\n        const hours = dateTime.getUTCHours() + 2;\r\n        setShift(hours >= 6 && hours < 18 ? 'Day' : 'Night');\r\n\r\n        return () => clearInterval(timer);\r\n    }, [dateTime]);\r\n\r\n    // Update a specific machine's data\r\n    const updateMachineData = (index: number, field: keyof MachineData, value: string | number) => {\r\n        setMachineDataList(prev => {\r\n            const updated = [...prev];\r\n            updated[index] = { ...updated[index], [field]: value };\r\n            return updated;\r\n        });\r\n    };\r\n\r\n    // Check if all machines have operators assigned\r\n    const allMachinesHaveOperators = machineDataList.every(m => m.operatorName !== '');\r\n    const canLockSession = allMachinesHaveOperators && orderNumber && product && batchNumber;\r\n\r\n    // Lock session\r\n    const handleLockSession = () => {\r\n        if (!canLockSession) {\r\n            showToast('Please fill in all required fields', 'error');\r\n            return;\r\n        }\r\n\r\n        // Save session for each machine\r\n        const currentDate = new Date().toISOString().split('T')[0];\r\n        const hours = new Date().getUTCHours() + 2;\r\n        const currentShift = hours >= 6 && hours < 18 ? 'Day' : 'Night';\r\n\r\n        machineDataList.forEach(machineData => {\r\n            const sessionKey = getSessionKey(machineData.machineName, currentShift, currentDate);\r\n            const session: ShiftSession = {\r\n                machineName: machineData.machineName,\r\n                operatorName: machineData.operatorName,\r\n                orderNumber,\r\n                product,\r\n                batchNumber,\r\n                shift: currentShift,\r\n                date: currentDate,\r\n                locked: true,\r\n                wasteEntries,\r\n                downtimeEntries,\r\n                speedEntries: machineData.speed ? [{ id: uuidv4(), speed: Number(machineData.speed), timestamp: new Date() }] : [],\r\n            };\r\n            localStorage.setItem(sessionKey, JSON.stringify(session));\r\n        });\r\n\r\n        setIsSessionLocked(true);\r\n        showToast('Sessions locked for all machines', 'success');\r\n    };\r\n\r\n    // Handle Waste Entry\r\n    const handleWasteSubmit = () => {\r\n        if (waste && wasteType) {\r\n            const newEntry: WasteEntry = {\r\n                id: uuidv4(),\r\n                waste: Number(waste),\r\n                wasteType,\r\n                timestamp: new Date()\r\n            };\r\n            setWasteEntries([...wasteEntries, newEntry]);\r\n            setWaste('');\r\n            setWasteType('');\r\n            setShowWasteModal(false);\r\n            showToast('Waste entry added', 'success');\r\n        }\r\n    };\r\n\r\n    // Handle Downtime Entry\r\n    const handleDowntimeSubmit = () => {\r\n        if (downtime && downtimeReason) {\r\n            const newEntry: DowntimeEntry = {\r\n                id: uuidv4(),\r\n                downtime: Number(downtime),\r\n                downtimeReason,\r\n                timestamp: new Date()\r\n            };\r\n            setDowntimeEntries([...downtimeEntries, newEntry]);\r\n            setDowntime('');\r\n            setDowntimeReason('');\r\n            setShowDowntimeModal(false);\r\n            showToast('Downtime entry added', 'success');\r\n        }\r\n    };\r\n\r\n    const handleDeleteWasteEntry = (id: string) => {\r\n        setWasteEntries(wasteEntries.filter(entry => entry.id !== id));\r\n        showToast('Entry removed', 'success');\r\n    };\r\n\r\n    const handleDeleteDowntimeEntry = (id: string) => {\r\n        setDowntimeEntries(downtimeEntries.filter(entry => entry.id !== id));\r\n        showToast('Entry removed', 'success');\r\n    };\r\n\r\n    // Submit all machines\r\n    const handleSubmitClick = () => {\r\n        if (!isSessionLocked) {\r\n            showToast('Please lock session details first', 'error');\r\n            return;\r\n        }\r\n\r\n        if (wasteEntries.length === 0 && downtimeEntries.length === 0) {\r\n            showToast('Please add at least one waste or downtime entry', 'error');\r\n            return;\r\n        }\r\n\r\n        setShowConfirmDialog(true);\r\n    };\r\n\r\n    const handleConfirmedSubmit = async () => {\r\n        setShowConfirmDialog(false);\r\n        setIsSubmitting(true);\r\n\r\n        const totalWaste = wasteEntries.reduce((sum, e) => sum + e.waste, 0);\r\n        const totalDowntime = downtimeEntries.reduce((sum, e) => sum + e.downtime, 0);\r\n\r\n        try {\r\n            // Submit for each machine\r\n            for (const machineData of machineDataList) {\r\n                const shiftData: ShiftData = {\r\n                    id: uuidv4(),\r\n                    operatorName: machineData.operatorName,\r\n                    machine: machineData.machineName,\r\n                    orderNumber,\r\n                    product,\r\n                    batchNumber,\r\n                    shift,\r\n                    date: dateTime.toISOString().split('T')[0],\r\n                    wasteEntries,\r\n                    downtimeEntries,\r\n                    speedEntries: machineData.speed ? [{ id: uuidv4(), speed: Number(machineData.speed), timestamp: new Date() }] : [],\r\n                    totalWaste,\r\n                    totalDowntime,\r\n                    submittedAt: new Date()\r\n                };\r\n\r\n                // Save to local storage\r\n                saveShiftData(shiftData);\r\n\r\n                // Submit to Supabase\r\n                await submitShiftData(\r\n                    {\r\n                        operator_name: machineData.operatorName,\r\n                        machine: machineData.machineName,\r\n                        order_number: orderNumber,\r\n                        product,\r\n                        batch_number: batchNumber,\r\n                        shift,\r\n                        submission_date: dateTime.toISOString().split('T')[0],\r\n                        is_early_submission: false,\r\n                    },\r\n                    wasteEntries.map(e => ({ waste: e.waste, wasteType: e.wasteType, timestamp: e.timestamp })),\r\n                    downtimeEntries.map(e => ({ downtime: e.downtime, downtimeReason: e.downtimeReason, timestamp: e.timestamp })),\r\n                    machineData.speed ? [{ speed: Number(machineData.speed), timestamp: new Date() }] : [],\r\n                    [],\r\n                    [],\r\n                    []\r\n                );\r\n            }\r\n\r\n            showToast(`Submitted for ${machineDataList.length} machines`, 'success');\r\n\r\n            // Clear sessions\r\n            const currentDate = new Date().toISOString().split('T')[0];\r\n            const hours = new Date().getUTCHours() + 2;\r\n            const currentShift = hours >= 6 && hours < 18 ? 'Day' : 'Night';\r\n            machineDataList.forEach(m => {\r\n                localStorage.removeItem(getSessionKey(m.machineName, currentShift, currentDate));\r\n            });\r\n\r\n            setTimeout(() => navigate('/'), 2000);\r\n        } catch (error) {\r\n            console.error('Submission error:', error);\r\n            showToast('Saved locally. Database sync failed.', 'error');\r\n            setTimeout(() => navigate('/'), 2000);\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    const handleBack = () => {\r\n        navigate('/');\r\n    };\r\n\r\n    // Calculate totals\r\n    const totalWaste = wasteEntries.reduce((sum, e) => sum + e.waste, 0);\r\n    const totalDowntime = downtimeEntries.reduce((sum, e) => sum + e.downtime, 0);\r\n\r\n    return (\r\n        <motion.div\r\n            className=\"capture-screen-v2 multi-capture\"\r\n            initial={{ opacity: 0, x: 20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            exit={{ opacity: 0, x: -20 }}\r\n        >\r\n            {/* Loading Overlay */}\r\n            {isSubmitting && (\r\n                <div className=\"spinner-overlay-v2\">\r\n                    <div className=\"spinner-v2\"></div>\r\n                    <p>Submitting for {machineDataList.length} machines...</p>\r\n                </div>\r\n            )}\r\n\r\n            {/* Toast Notification */}\r\n            {toast && (\r\n                <motion.div\r\n                    className=\"toast-container-v2\"\r\n                    initial={{ opacity: 0, y: -20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    exit={{ opacity: 0, y: -20 }}\r\n                >\r\n                    <div className={`toast-message-v2 ${toast.type}`}>\r\n                        <span className=\"toast-icon\">{toast.type === 'success' ? '‚úì' : '!'}</span>\r\n                        {toast.message}\r\n                    </div>\r\n                </motion.div>\r\n            )}\r\n\r\n            {/* Confirm Dialog */}\r\n            <ConfirmDialog\r\n                isOpen={showConfirmDialog}\r\n                title=\"Submit for All Machines?\"\r\n                message={`This will submit data for ${machineDataList.length} machines:\\n${machineDataList.map(m => m.machineName).join(', ')}`}\r\n                onConfirm={handleConfirmedSubmit}\r\n                onCancel={() => setShowConfirmDialog(false)}\r\n            />\r\n\r\n            {/* Header */}\r\n            <header className=\"capture-header-v2\">\r\n                <button className=\"back-btn-v2\" onClick={handleBack}>\r\n                    <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                        <path d=\"M19 12H5M12 19l-7-7 7-7\" />\r\n                    </svg>\r\n                    Back\r\n                </button>\r\n                <div className=\"capture-title-v2\">\r\n                    <h1>{parentGroup} ‚Äî Machine {machineNumbers}</h1>\r\n                    <span className=\"capture-subtitle\">Recording for {machineDataList.length} machines</span>\r\n                </div>\r\n                <div className={`shift-badge-v2 ${shift.toLowerCase()}`}>\r\n                    <span className=\"shift-icon\">{shift === 'Day' ? '‚óê' : '‚óë'}</span>\r\n                    {shift} Shift\r\n                </div>\r\n            </header>\r\n\r\n            <main className=\"capture-main multi-capture-main\">\r\n                {/* Left Column - Machine-Specific Data */}\r\n                <div className=\"capture-form-column\">\r\n                    <section className=\"form-section\">\r\n                        <h2 className=\"section-heading\">\r\n                            Machine Assignments\r\n                            {isSessionLocked && <span className=\"locked-badge\">üîí Locked</span>}\r\n                        </h2>\r\n\r\n                        <div className=\"multi-machine-grid\">\r\n                            {machineDataList.map((machineData, index) => (\r\n                                <div key={machineData.machineName} className=\"machine-card\">\r\n                                    <div className=\"machine-card-header\">\r\n                                        <span className=\"machine-number\">{index + 1}</span>\r\n                                        <span className=\"machine-card-name\">\r\n                                            {machineData.machineName.split(' - ')[1] || machineData.machineName}\r\n                                        </span>\r\n                                        <span className=\"machine-parent\">\r\n                                            {machineData.machineName.split(' - ')[0]}\r\n                                        </span>\r\n                                    </div>\r\n\r\n                                    <div className=\"machine-card-fields\">\r\n                                        <div className=\"form-field\">\r\n                                            <label className=\"form-label\">Operator Number</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                className=\"form-input\"\r\n                                                value={machineData.operatorName}\r\n                                                onChange={e => updateMachineData(index, 'operatorName', e.target.value)}\r\n                                                placeholder=\"Enter operator number\"\r\n                                                disabled={isSessionLocked}\r\n                                            />\r\n                                        </div>\r\n\r\n                                        <div className=\"form-field\">\r\n                                            <label className=\"form-label\">Speed (PPM)</label>\r\n                                            <input\r\n                                                type=\"number\"\r\n                                                className=\"form-input\"\r\n                                                placeholder=\"Enter speed\"\r\n                                                value={machineData.speed}\r\n                                                onChange={e => updateMachineData(index, 'speed', e.target.value ? Number(e.target.value) : '')}\r\n                                                disabled={isSessionLocked}\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </section>\r\n\r\n                    {/* Shared Order Details */}\r\n                    <section className=\"form-section\">\r\n                        <h2 className=\"section-heading\">Shared Order Details</h2>\r\n                        <div className=\"form-grid\">\r\n                            <div className=\"form-field\">\r\n                                <label className=\"form-label\">Order Number</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    className=\"form-input\"\r\n                                    placeholder=\"Enter order number\"\r\n                                    value={orderNumber}\r\n                                    onChange={e => setOrderNumber(e.target.value)}\r\n                                    disabled={isSessionLocked}\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-field\">\r\n                                <label className=\"form-label\">Product</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    className=\"form-input\"\r\n                                    placeholder=\"Enter product\"\r\n                                    value={product}\r\n                                    onChange={e => setProduct(e.target.value)}\r\n                                    disabled={isSessionLocked}\r\n                                />\r\n                            </div>\r\n                            <div className=\"form-field\">\r\n                                <label className=\"form-label\">Batch Number</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    className=\"form-input\"\r\n                                    placeholder=\"Enter batch\"\r\n                                    value={batchNumber}\r\n                                    onChange={e => setBatchNumber(e.target.value)}\r\n                                    disabled={isSessionLocked}\r\n                                />\r\n                            </div>\r\n                            <ShiftInfo dateTime={dateTime} shift={shift} />\r\n                        </div>\r\n\r\n                        {!isSessionLocked && canLockSession && (\r\n                            <button\r\n                                className=\"lock-session-btn\"\r\n                                onClick={handleLockSession}\r\n                            >\r\n                                üîí Lock All Machine Sessions\r\n                            </button>\r\n                        )}\r\n                    </section>\r\n                </div>\r\n\r\n                {/* Right Column - Recording */}\r\n                <div className=\"capture-entries-column\">\r\n                    {/* Waste Section */}\r\n                    <section className=\"form-section capture-section compact-capture waste-section\">\r\n                        <h2 className=\"section-heading\">\r\n                            <span className=\"section-icon\">üóëÔ∏è</span>\r\n                            Record Waste (applies to all)\r\n                            {wasteEntries.length > 0 && (\r\n                                <span className=\"entry-count-badge waste-badge\">{wasteEntries.length}</span>\r\n                            )}\r\n                        </h2>\r\n                        <div className=\"capture-section-content\">\r\n                            <button\r\n                                className=\"capture-add-btn waste-btn\"\r\n                                onClick={() => setShowWasteModal(true)}\r\n                            >\r\n                                <span className=\"btn-icon\">+</span>\r\n                                Record Waste\r\n                            </button>\r\n                            {wasteEntries.length > 0 && (\r\n                                <div className=\"capture-entries-list\">\r\n                                    {wasteEntries.slice().reverse().map((entry, index) => (\r\n                                        <div key={entry.id} className={`capture-entry-item waste-entry ${index === 0 ? 'latest' : ''}`}>\r\n                                            <div className=\"entry-main\">\r\n                                                <span className=\"entry-value\">{entry.waste}</span>\r\n                                                <span className=\"entry-unit\">kg</span>\r\n                                            </div>\r\n                                            <span className=\"entry-type\">{entry.wasteType}</span>\r\n                                            <span className=\"entry-time\">\r\n                                                {new Date(entry.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                                            </span>\r\n                                            <button\r\n                                                className=\"entry-delete-btn\"\r\n                                                onClick={() => handleDeleteWasteEntry(entry.id)}\r\n                                                title=\"Delete this entry\"\r\n                                            >\r\n                                                ‚úï\r\n                                            </button>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            )}\r\n                            {wasteEntries.length > 0 && (\r\n                                <div className=\"section-total\">\r\n                                    <span>Total Waste:</span>\r\n                                    <strong>{totalWaste.toFixed(1)} kg</strong>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </section>\r\n\r\n                    {/* Downtime Section */}\r\n                    <section className=\"form-section capture-section compact-capture downtime-section\">\r\n                        <h2 className=\"section-heading\">\r\n                            <span className=\"section-icon\">‚è±Ô∏è</span>\r\n                            Record Downtime (applies to all)\r\n                            {downtimeEntries.length > 0 && (\r\n                                <span className=\"entry-count-badge downtime-badge\">{downtimeEntries.length}</span>\r\n                            )}\r\n                        </h2>\r\n                        <div className=\"capture-section-content\">\r\n                            <button\r\n                                className=\"capture-add-btn downtime-btn\"\r\n                                onClick={() => setShowDowntimeModal(true)}\r\n                            >\r\n                                <span className=\"btn-icon\">+</span>\r\n                                Record Downtime\r\n                            </button>\r\n                            {downtimeEntries.length > 0 && (\r\n                                <div className=\"capture-entries-list\">\r\n                                    {downtimeEntries.slice().reverse().map((entry, index) => (\r\n                                        <div key={entry.id} className={`capture-entry-item downtime-entry ${index === 0 ? 'latest' : ''}`}>\r\n                                            <div className=\"entry-main\">\r\n                                                <span className=\"entry-value\">{entry.downtime}</span>\r\n                                                <span className=\"entry-unit\">min</span>\r\n                                            </div>\r\n                                            <span className=\"entry-reason\">{entry.downtimeReason}</span>\r\n                                            <span className=\"entry-time\">\r\n                                                {new Date(entry.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                                            </span>\r\n                                            <button\r\n                                                className=\"entry-delete-btn\"\r\n                                                onClick={() => handleDeleteDowntimeEntry(entry.id)}\r\n                                                title=\"Delete this entry\"\r\n                                            >\r\n                                                ‚úï\r\n                                            </button>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            )}\r\n                            {downtimeEntries.length > 0 && (\r\n                                <div className=\"section-total\">\r\n                                    <span>Total Downtime:</span>\r\n                                    <strong>{Math.floor(totalDowntime / 60)}h {totalDowntime % 60}m</strong>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </section>\r\n\r\n                    {/* Submit Button */}\r\n                    <button\r\n                        className=\"submit-all-btn\"\r\n                        onClick={handleSubmitClick}\r\n                        disabled={!isSessionLocked || isSubmitting}\r\n                    >\r\n                        Submit for All {machineDataList.length} Machines\r\n                        <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" width=\"20\" height=\"20\">\r\n                            <path d=\"M5 12h14M12 5l7 7-7 7\" />\r\n                        </svg>\r\n                    </button>\r\n                </div>\r\n            </main>\r\n\r\n            {/* Waste Modal */}\r\n            <AnimatePresence>\r\n                {showWasteModal && (\r\n                    <motion.div\r\n                        className=\"modal-overlay\"\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        onClick={() => setShowWasteModal(false)}\r\n                    >\r\n                        <motion.div\r\n                            className=\"modal-content\"\r\n                            initial={{ opacity: 0, scale: 0.9 }}\r\n                            animate={{ opacity: 1, scale: 1 }}\r\n                            exit={{ opacity: 0, scale: 0.9 }}\r\n                            onClick={e => e.stopPropagation()}\r\n                        >\r\n                            <h3>Record Waste</h3>\r\n                            <div className=\"modal-form\">\r\n                                <div className=\"form-field\">\r\n                                    <label className=\"form-label\">Amount (kg)</label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        className=\"form-input\"\r\n                                        value={waste}\r\n                                        onChange={e => setWaste(e.target.value ? Number(e.target.value) : '')}\r\n                                        placeholder=\"Enter waste amount\"\r\n                                        autoFocus\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-field\">\r\n                                    <label className=\"form-label\">Waste Type</label>\r\n                                    <select\r\n                                        className=\"form-select\"\r\n                                        value={wasteType}\r\n                                        onChange={e => setWasteType(e.target.value)}\r\n                                    >\r\n                                        <option value=\"\">Select Type</option>\r\n                                        {WASTE_TYPES.map(t => (\r\n                                            <option key={t} value={t}>{t}</option>\r\n                                        ))}\r\n                                    </select>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"modal-actions\">\r\n                                <button className=\"modal-cancel\" onClick={() => setShowWasteModal(false)}>Cancel</button>\r\n                                <button className=\"modal-confirm\" onClick={handleWasteSubmit} disabled={!waste || !wasteType}>\r\n                                    Add Entry\r\n                                </button>\r\n                            </div>\r\n                        </motion.div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            {/* Downtime Modal */}\r\n            <AnimatePresence>\r\n                {showDowntimeModal && (\r\n                    <motion.div\r\n                        className=\"modal-overlay\"\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        onClick={() => setShowDowntimeModal(false)}\r\n                    >\r\n                        <motion.div\r\n                            className=\"modal-content\"\r\n                            initial={{ opacity: 0, scale: 0.9 }}\r\n                            animate={{ opacity: 1, scale: 1 }}\r\n                            exit={{ opacity: 0, scale: 0.9 }}\r\n                            onClick={e => e.stopPropagation()}\r\n                        >\r\n                            <h3>Record Downtime</h3>\r\n                            <div className=\"modal-form\">\r\n                                <div className=\"form-field\">\r\n                                    <label className=\"form-label\">Duration (minutes)</label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        className=\"form-input\"\r\n                                        value={downtime}\r\n                                        onChange={e => setDowntime(e.target.value ? Number(e.target.value) : '')}\r\n                                        placeholder=\"Enter duration\"\r\n                                        autoFocus\r\n                                    />\r\n                                </div>\r\n                                <div className=\"form-field\">\r\n                                    <label className=\"form-label\">Reason</label>\r\n                                    <select\r\n                                        className=\"form-select\"\r\n                                        value={downtimeReason}\r\n                                        onChange={e => setDowntimeReason(e.target.value)}\r\n                                    >\r\n                                        <option value=\"\">Select Reason</option>\r\n                                        {DOWNTIME_REASONS.map(r => (\r\n                                            <option key={r} value={r}>{r}</option>\r\n                                        ))}\r\n                                    </select>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"modal-actions\">\r\n                                <button className=\"modal-cancel\" onClick={() => setShowDowntimeModal(false)}>Cancel</button>\r\n                                <button className=\"modal-confirm\" onClick={handleDowntimeSubmit} disabled={!downtime || !downtimeReason}>\r\n                                    Add Entry\r\n                                </button>\r\n                            </div>\r\n                        </motion.div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n        </motion.div>\r\n    );\r\n};\r\n\r\nexport default MultiCaptureScreen;\r\n","import React from 'react';\r\nimport { format } from 'date-fns';\r\n\r\ninterface ShiftInfoProps {\r\n  dateTime: Date;\r\n  shift: string;\r\n}\r\n\r\nconst ShiftInfo: React.FC<ShiftInfoProps> = ({ dateTime, shift }) => {\r\n  return (\r\n    <div className=\"shift-info-card\">\r\n      <div className=\"shift-info-header\">\r\n        <span className=\"info-label\">Current Date</span>\r\n        <span className=\"info-value date\">{format(dateTime, 'EEEE,')}</span>\r\n        <span className=\"info-value\">{format(dateTime, 'MMM d, yyyy')}</span>\r\n      </div>\r\n      <div className=\"shift-info-time\">\r\n        <span className=\"info-label\">Current Time</span>\r\n        <span className=\"time-display\">{format(dateTime, 'HH:mm:ss')}</span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShiftInfo;\r\n","import React from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface ConfirmDialogProps {\r\n  isOpen: boolean;\r\n  title: string;\r\n  message: string;\r\n  confirmText?: string;\r\n  cancelText?: string;\r\n  onConfirm: () => void;\r\n  onCancel: () => void;\r\n  type?: 'default' | 'danger' | 'success';\r\n}\r\n\r\nconst ConfirmDialog: React.FC<ConfirmDialogProps> = ({\r\n  isOpen,\r\n  title,\r\n  message,\r\n  confirmText = 'Confirm',\r\n  cancelText = 'Cancel',\r\n  onConfirm,\r\n  onCancel,\r\n  type = 'default',\r\n}) => {\r\n  const getButtonClass = () => {\r\n    switch (type) {\r\n      case 'danger':\r\n        return 'btn-danger';\r\n      case 'success':\r\n        return 'btn-success';\r\n      default:\r\n        return 'btn-primary';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {isOpen && (\r\n        <motion.div\r\n          className=\"confirm-dialog-overlay\"\r\n          initial={{ opacity: 0 }}\r\n          animate={{ opacity: 1 }}\r\n          exit={{ opacity: 0 }}\r\n          onClick={onCancel}\r\n        >\r\n          <motion.div\r\n            className=\"confirm-dialog\"\r\n            initial={{ opacity: 0, scale: 0.9, y: 20 }}\r\n            animate={{ opacity: 1, scale: 1, y: 0 }}\r\n            exit={{ opacity: 0, scale: 0.9, y: 20 }}\r\n            onClick={(e) => e.stopPropagation()}\r\n          >\r\n            <div className=\"confirm-dialog-header\">\r\n              <h3>{title}</h3>\r\n            </div>\r\n            <div className=\"confirm-dialog-body\">\r\n              <p>{message}</p>\r\n            </div>\r\n            <div className=\"confirm-dialog-footer\">\r\n              <button \r\n                className=\"btn btn-outline-secondary\" \r\n                onClick={onCancel}\r\n              >\r\n                {cancelText}\r\n              </button>\r\n              <button \r\n                className={`btn ${getButtonClass()}`} \r\n                onClick={onConfirm}\r\n              >\r\n                {confirmText}\r\n              </button>\r\n            </div>\r\n          </motion.div>\r\n        </motion.div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n};\r\n\r\nexport default ConfirmDialog;\r\n","export interface WasteEntry {\r\n  id: string;\r\n  waste: number;\r\n  wasteType: string;\r\n  timestamp: Date;\r\n}\r\n\r\nexport interface DowntimeEntry {\r\n  id: string;\r\n  downtime: number;\r\n  downtimeReason: string;\r\n  notes?: string;\r\n  timestamp: Date;\r\n}\r\n\r\n// Production timer state for tracking run time and pauses\r\nexport interface ProductionState {\r\n  isRunning: boolean;\r\n  startTime: Date | null;       // When production started\r\n  pausedAt: Date | null;        // When current pause began\r\n  totalRunTimeMs: number;       // Accumulated run time in milliseconds\r\n  lastResumedAt: Date | null;   // When last resumed from pause\r\n}\r\n\r\nexport interface SpeedEntry {\r\n  id: string;\r\n  speed: number;\r\n  timestamp: Date;\r\n}\r\n\r\nexport interface SachetMassEntry {\r\n  id: string;\r\n  mass: number; // in grams\r\n  timestamp: Date;\r\n  ignored?: boolean; // Can be set to ignore but not deleted\r\n}\r\n\r\n// Loose cases entry - for cases not part of a full pallet\r\nexport interface LooseCasesEntry {\r\n  id: string;\r\n  batchNumber: string; // 5-digit batch number\r\n  cases: number; // number of loose cases\r\n  timestamp: Date;\r\n  ignored?: boolean;\r\n}\r\n\r\n// Pallet Scan entry - QR code is 13 digits: BBBBBPPPPCCCC\r\n// B = batch number (5 digits), P = pallet number (4 digits), C = cases count (4 digits)\r\nexport interface PalletScanEntry {\r\n  id: string;\r\n  qrCode: string; // Full 13-digit QR code\r\n  batchNumber: string; // Extracted: first 5 digits\r\n  palletNumber: string; // Extracted: digits 6-9 (4 digits)\r\n  casesCount: number; // Extracted: last 4 digits\r\n  timestamp: Date;\r\n  ignored?: boolean;\r\n}\r\n\r\n// Legacy CasesPerHourEntry - kept for backwards compatibility\r\nexport interface CasesPerHourEntry {\r\n  id: string;\r\n  cases: number;\r\n  hour: number;\r\n  timestamp: Date;\r\n  ignored?: boolean;\r\n}\r\n\r\nexport interface ShiftData {\r\n  id: string;\r\n  operatorName: string;\r\n  machine: string;\r\n  subMachine?: string; // For machines that are groups (e.g., \"Universal 2 - Machine 1\")\r\n  orderNumber: string;\r\n  product: string;\r\n  batchNumber: string;\r\n  shift: string;\r\n  date: string;\r\n  wasteEntries: WasteEntry[];\r\n  downtimeEntries: DowntimeEntry[];\r\n  speedEntries?: SpeedEntry[];\r\n  sachetMassEntries?: SachetMassEntry[];\r\n  casesPerHourEntries?: CasesPerHourEntry[]; // Legacy - kept for backwards compatibility\r\n  looseCasesEntries?: LooseCasesEntry[]; // New: loose cases with batch number\r\n  palletScanEntries?: PalletScanEntry[];\r\n  submittedAt: Date;\r\n  totalWaste: number;\r\n  totalDowntime: number;\r\n}\r\n\r\nexport interface ShiftSession {\r\n  machineName: string;\r\n  operatorName: string;\r\n  orderNumber: string;\r\n  product: string;\r\n  batchNumber: string;\r\n  shift: string;\r\n  date: string;\r\n  locked: boolean; // Once set, these values are locked for the shift\r\n  // Entry data persisted with session\r\n  wasteEntries?: WasteEntry[];\r\n  downtimeEntries?: DowntimeEntry[];\r\n  speedEntries?: SpeedEntry[];\r\n  sachetMassEntries?: SachetMassEntry[];\r\n  casesPerHourEntries?: CasesPerHourEntry[]; // Legacy\r\n  looseCasesEntries?: LooseCasesEntry[]; // New\r\n  palletScanEntries?: PalletScanEntry[];\r\n}\r\n\r\nexport interface Machine {\r\n  id: string;\r\n  name: string;\r\n  status: 'running' | 'idle' | 'maintenance';\r\n  currentOperator?: string;\r\n  currentOrder?: string;\r\n  currentShift?: string;\r\n  lastSubmission?: string;\r\n  todayWaste?: number;\r\n  todayDowntime?: number;\r\n  subMachineCount?: number; // Number of sub-machines (e.g., 4 for \"Universal 2\")\r\n}\r\n\r\n// ==============================================\r\n// DEFAULT DATA\r\n// ==============================================\r\n\r\nexport const OPERATORS: string[] = [];\r\nexport const MACHINES: Machine[] = [];\r\n\r\n// Waste Types - common manufacturing waste categories\r\nexport const WASTE_TYPES: string[] = [\r\n  'Start-up Waste',\r\n  'Changeover Waste',\r\n  'Defective Product',\r\n  'Material Spillage',\r\n];\r\n\r\n// Downtime Reasons - categorized by planned vs unplanned\r\nexport const PLANNED_DOWNTIME_REASONS: string[] = [\r\n  'Scheduled Maintenance',\r\n  'Changeover',\r\n];\r\n\r\nexport const UNPLANNED_DOWNTIME_REASONS: string[] = [\r\n  'Machine Breakdown',\r\n  'Material Shortage',\r\n];\r\n\r\n// Combined downtime reasons for selection\r\nexport const DOWNTIME_REASONS: string[] = [\r\n  'Machine Breakdown',\r\n  'Scheduled Maintenance',\r\n  'Changeover',\r\n  'Material Shortage',\r\n];\r\n\r\nexport const ORDER_NUMBERS: string[] = [];\r\nexport const PRODUCTS: string[] = [];\r\nexport const BATCH_NUMBERS: string[] = [];\r\n\r\n","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default { randomUUID };\n","let getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n    if (!getRandomValues) {\n        if (typeof crypto === 'undefined' || !crypto.getRandomValues) {\n            throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n        }\n        getRandomValues = crypto.getRandomValues.bind(crypto);\n    }\n    return getRandomValues(rnds8);\n}\n","import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction _v4(options, buf, offset) {\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? rng();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    return _v4(options, buf, offset);\n}\nexport default v4;\n","import { ShiftData, Machine, MACHINES } from '../types';\r\nimport {\r\n  fetchMachines,\r\n  upsertMachine,\r\n  removeMachine,\r\n  syncMachinesToSupabase,\r\n  subscribeMachineChanges,\r\n  MachineRecord,\r\n  submitShiftData,\r\n  isSupabaseConfigured\r\n} from './supabase';\r\n\r\nconst STORAGE_KEY = 'waste_downtime_history';\r\nconst MACHINES_KEY = 'machines_data';\r\nconst MACHINES_SYNC_KEY = 'machines_last_sync';\r\nconst FAILED_SUBMISSIONS_KEY = 'failed_submissions_queue';\r\nconst HISTORY_MAX_DAYS = 90; // Keep history for 90 days\r\nconst HISTORY_MAX_ENTRIES = 1000; // Maximum entries to keep\r\n\r\n// ==========================================\r\n// FAILED SUBMISSIONS RETRY QUEUE\r\n// ==========================================\r\n\r\ninterface FailedSubmission {\r\n  id: string;\r\n  timestamp: string;\r\n  retryCount: number;\r\n  maxRetries: number;\r\n  data: {\r\n    shiftData: any;\r\n    wasteEntries: any[];\r\n    downtimeEntries: any[];\r\n    speedEntries?: any[];\r\n    sachetMassEntries?: any[];\r\n    looseCasesEntries?: any[];\r\n    palletScanEntries?: any[];\r\n  };\r\n  error: string;\r\n}\r\n\r\n// Get failed submissions queue\r\nexport const getFailedSubmissions = (): FailedSubmission[] => {\r\n  const stored = localStorage.getItem(FAILED_SUBMISSIONS_KEY);\r\n  if (!stored) return [];\r\n  try {\r\n    return JSON.parse(stored);\r\n  } catch {\r\n    return [];\r\n  }\r\n};\r\n\r\n// Add a failed submission to the retry queue\r\nexport const addFailedSubmission = (\r\n  data: FailedSubmission['data'],\r\n  error: string\r\n): void => {\r\n  const queue = getFailedSubmissions();\r\n  const newEntry: FailedSubmission = {\r\n    id: `failed_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n    timestamp: new Date().toISOString(),\r\n    retryCount: 0,\r\n    maxRetries: 3,\r\n    data,\r\n    error,\r\n  };\r\n  queue.push(newEntry);\r\n  localStorage.setItem(FAILED_SUBMISSIONS_KEY, JSON.stringify(queue));\r\n};\r\n\r\n// Remove a submission from the failed queue\r\nexport const removeFailedSubmission = (id: string): void => {\r\n  const queue = getFailedSubmissions();\r\n  const filtered = queue.filter(s => s.id !== id);\r\n  localStorage.setItem(FAILED_SUBMISSIONS_KEY, JSON.stringify(filtered));\r\n};\r\n\r\n// Retry all failed submissions\r\nexport const retryFailedSubmissions = async (): Promise<{\r\n  succeeded: number;\r\n  failed: number;\r\n  remaining: number;\r\n}> => {\r\n  if (!isSupabaseConfigured) {\r\n    return { succeeded: 0, failed: 0, remaining: getFailedSubmissions().length };\r\n  }\r\n\r\n  const queue = getFailedSubmissions();\r\n  let succeeded = 0;\r\n  let failed = 0;\r\n\r\n  for (const submission of queue) {\r\n    if (submission.retryCount >= submission.maxRetries) {\r\n      // Max retries reached, keep in queue but don't retry\r\n      failed++;\r\n      continue;\r\n    }\r\n\r\n    try {\r\n      await submitShiftData(\r\n        submission.data.shiftData,\r\n        submission.data.wasteEntries,\r\n        submission.data.downtimeEntries,\r\n        submission.data.speedEntries,\r\n        submission.data.sachetMassEntries,\r\n        submission.data.looseCasesEntries,\r\n        submission.data.palletScanEntries\r\n      );\r\n      removeFailedSubmission(submission.id);\r\n      succeeded++;\r\n    } catch (e) {\r\n      // Update retry count\r\n      const updatedQueue = getFailedSubmissions().map(s =>\r\n        s.id === submission.id\r\n          ? { ...s, retryCount: s.retryCount + 1, error: String(e) }\r\n          : s\r\n      );\r\n      localStorage.setItem(FAILED_SUBMISSIONS_KEY, JSON.stringify(updatedQueue));\r\n      failed++;\r\n    }\r\n  }\r\n\r\n  return {\r\n    succeeded,\r\n    failed,\r\n    remaining: getFailedSubmissions().length,\r\n  };\r\n};\r\n\r\n// Clear all failed submissions (manual clear)\r\nexport const clearFailedSubmissions = (): void => {\r\n  localStorage.removeItem(FAILED_SUBMISSIONS_KEY);\r\n};\r\n\r\n// ==========================================\r\n// LOCALSTORAGE CLEANUP\r\n// ==========================================\r\n\r\n// Clean up old history entries\r\nexport const cleanupOldHistory = (): { removed: number; remaining: number } => {\r\n  const history = getShiftHistory();\r\n  const now = new Date();\r\n  const cutoffDate = new Date(now.getTime() - HISTORY_MAX_DAYS * 24 * 60 * 60 * 1000);\r\n\r\n  // Filter out entries older than cutoff date\r\n  let cleaned = history.filter(item => {\r\n    const itemDate = new Date(item.date);\r\n    return itemDate >= cutoffDate;\r\n  });\r\n\r\n  // Also limit to max entries (keep most recent)\r\n  if (cleaned.length > HISTORY_MAX_ENTRIES) {\r\n    cleaned = cleaned.slice(0, HISTORY_MAX_ENTRIES);\r\n  }\r\n\r\n  const removed = history.length - cleaned.length;\r\n\r\n  if (removed > 0) {\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(cleaned));\r\n    console.log(`Cleaned up ${removed} old history entries`);\r\n  }\r\n\r\n  return { removed, remaining: cleaned.length };\r\n};\r\n\r\n// Get localStorage usage stats\r\nexport const getStorageStats = (): {\r\n  historyCount: number;\r\n  failedCount: number;\r\n  totalSizeKB: number;\r\n  oldestEntry: string | null;\r\n} => {\r\n  const history = getShiftHistory();\r\n  const failed = getFailedSubmissions();\r\n\r\n  // Estimate total localStorage size\r\n  let totalSize = 0;\r\n  for (let i = 0; i < localStorage.length; i++) {\r\n    const key = localStorage.key(i);\r\n    if (key) {\r\n      const value = localStorage.getItem(key) || '';\r\n      totalSize += key.length + value.length;\r\n    }\r\n  }\r\n\r\n  const oldestEntry = history.length > 0\r\n    ? history[history.length - 1].date\r\n    : null;\r\n\r\n  return {\r\n    historyCount: history.length,\r\n    failedCount: failed.length,\r\n    totalSizeKB: Math.round(totalSize / 1024),\r\n    oldestEntry,\r\n  };\r\n};\r\n\r\n// Run cleanup on app startup (debounced to run once per day)\r\nexport const maybeRunCleanup = (): void => {\r\n  const lastCleanupKey = 'last_storage_cleanup';\r\n  const lastCleanup = localStorage.getItem(lastCleanupKey);\r\n  const now = new Date();\r\n\r\n  if (lastCleanup) {\r\n    const lastDate = new Date(lastCleanup);\r\n    const hoursSinceCleanup = (now.getTime() - lastDate.getTime()) / (1000 * 60 * 60);\r\n    if (hoursSinceCleanup < 24) {\r\n      return; // Already cleaned up today\r\n    }\r\n  }\r\n\r\n  // Run cleanup\r\n  const result = cleanupOldHistory();\r\n  localStorage.setItem(lastCleanupKey, now.toISOString());\r\n\r\n  if (result.removed > 0) {\r\n    console.log(`Storage cleanup: removed ${result.removed} entries, ${result.remaining} remaining`);\r\n  }\r\n};\r\n\r\n// Flag to track if we're using Supabase\r\nlet useSupabase = true;\r\nlet machinesCache: Machine[] | null = null;\r\nlet machinesListeners: ((machines: Machine[]) => void)[] = [];\r\n\r\n// Convert Supabase record to local Machine type\r\nconst toLocalMachine = (record: MachineRecord): Machine => ({\r\n  id: record.id,\r\n  name: record.name,\r\n  status: record.status,\r\n  currentOperator: record.current_operator,\r\n  currentOrder: record.current_order,\r\n  currentShift: record.current_shift,\r\n  lastSubmission: record.last_submission,\r\n  todayWaste: record.today_waste,\r\n  todayDowntime: record.today_downtime,\r\n  subMachineCount: record.sub_machine_count,\r\n});\r\n\r\n// Convert local Machine to Supabase record\r\nconst toSupabaseRecord = (machine: Machine): MachineRecord => ({\r\n  id: machine.id,\r\n  name: machine.name,\r\n  status: machine.status,\r\n  current_operator: machine.currentOperator,\r\n  current_order: machine.currentOrder,\r\n  current_shift: machine.currentShift,\r\n  last_submission: machine.lastSubmission,\r\n  today_waste: machine.todayWaste,\r\n  today_downtime: machine.todayDowntime,\r\n  sub_machine_count: machine.subMachineCount,\r\n});\r\n\r\n// Initialize machines from Supabase\r\nexport const initializeMachines = async (): Promise<Machine[]> => {\r\n  try {\r\n    const records = await fetchMachines();\r\n\r\n    if (records.length > 0) {\r\n      machinesCache = records.map(toLocalMachine);\r\n      // Also save to localStorage as backup\r\n      localStorage.setItem(MACHINES_KEY, JSON.stringify(machinesCache));\r\n      localStorage.setItem(MACHINES_SYNC_KEY, new Date().toISOString());\r\n      return machinesCache;\r\n    } else {\r\n      // No machines in Supabase, sync default machines\r\n      console.log('No machines in Supabase, syncing defaults...');\r\n      const defaultMachines = MACHINES.map(toSupabaseRecord);\r\n      await syncMachinesToSupabase(defaultMachines);\r\n      machinesCache = MACHINES;\r\n      localStorage.setItem(MACHINES_KEY, JSON.stringify(MACHINES));\r\n      return MACHINES;\r\n    }\r\n  } catch (error) {\r\n    console.error('Failed to initialize from Supabase, using localStorage:', error);\r\n    useSupabase = false;\r\n    return getMachinesDataLocal();\r\n  }\r\n};\r\n\r\n// Subscribe to real-time machine updates - OPTIMIZED\r\nexport const subscribeToMachineUpdates = (callback: (machines: Machine[]) => void) => {\r\n  machinesListeners.push(callback);\r\n\r\n  // Provide current machines getter for optimized real-time updates\r\n  const getCurrentMachines = (): MachineRecord[] => {\r\n    const current = machinesCache || getMachinesDataLocal();\r\n    return current.map(toSupabaseRecord);\r\n  };\r\n\r\n  // Set up Supabase real-time subscription with optimized handler\r\n  const unsubscribe = subscribeMachineChanges(\r\n    (records) => {\r\n      machinesCache = records.map(toLocalMachine);\r\n      localStorage.setItem(MACHINES_KEY, JSON.stringify(machinesCache));\r\n\r\n      // Notify all listeners\r\n      machinesListeners.forEach(listener => listener(machinesCache!));\r\n    },\r\n    getCurrentMachines\r\n  );\r\n\r\n  // Return cleanup function\r\n  return () => {\r\n    machinesListeners = machinesListeners.filter(l => l !== callback);\r\n    if (machinesListeners.length === 0) {\r\n      unsubscribe();\r\n    }\r\n  };\r\n};\r\n\r\n// Get machines from localStorage (fallback)\r\nconst getMachinesDataLocal = (): Machine[] => {\r\n  const stored = localStorage.getItem(MACHINES_KEY);\r\n  if (!stored) {\r\n    localStorage.setItem(MACHINES_KEY, JSON.stringify(MACHINES));\r\n    return MACHINES;\r\n  }\r\n\r\n  try {\r\n    return JSON.parse(stored);\r\n  } catch {\r\n    return MACHINES;\r\n  }\r\n};\r\n\r\n// Save shift data to local storage\r\nexport const saveShiftData = (data: ShiftData): void => {\r\n  const existing = getShiftHistory();\r\n  existing.unshift(data);\r\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(existing));\r\n\r\n  // Update machine data\r\n  updateMachineLastSubmission(data.machine, data.submittedAt.toISOString());\r\n};\r\n\r\n// Get all shift history\r\nexport const getShiftHistory = (): ShiftData[] => {\r\n  const stored = localStorage.getItem(STORAGE_KEY);\r\n  if (!stored) return [];\r\n\r\n  try {\r\n    const parsed = JSON.parse(stored);\r\n    return parsed.map((item: any) => ({\r\n      ...item,\r\n      submittedAt: new Date(item.submittedAt),\r\n      wasteEntries: item.wasteEntries.map((w: any) => ({\r\n        ...w,\r\n        timestamp: new Date(w.timestamp),\r\n      })),\r\n      downtimeEntries: item.downtimeEntries.map((d: any) => ({\r\n        ...d,\r\n        timestamp: new Date(d.timestamp),\r\n      })),\r\n    }));\r\n  } catch {\r\n    return [];\r\n  }\r\n};\r\n\r\n// Get shift history for a specific date range\r\nexport const getShiftHistoryByDateRange = (startDate: Date, endDate: Date): ShiftData[] => {\r\n  const history = getShiftHistory();\r\n  return history.filter(item => {\r\n    const itemDate = new Date(item.date);\r\n    return itemDate >= startDate && itemDate <= endDate;\r\n  });\r\n};\r\n\r\n// Get shift history for a specific machine\r\nexport const getShiftHistoryByMachine = (machineName: string): ShiftData[] => {\r\n  const history = getShiftHistory();\r\n  return history.filter(item => item.machine === machineName);\r\n};\r\n\r\n// Get today's statistics\r\nexport const getTodayStats = () => {\r\n  const today = new Date().toISOString().split('T')[0];\r\n  const history = getShiftHistory();\r\n  const todayData = history.filter(item => item.date === today);\r\n\r\n  const totalWaste = todayData.reduce((sum, item) => sum + item.totalWaste, 0);\r\n  const totalDowntime = todayData.reduce((sum, item) => sum + item.totalDowntime, 0);\r\n  const submissionCount = todayData.length;\r\n\r\n  return { totalWaste, totalDowntime, submissionCount };\r\n};\r\n\r\n// Update machine last submission\r\nexport const updateMachineLastSubmission = (machineName: string, timestamp: string): void => {\r\n  const machines = getMachinesData();\r\n  const machineIndex = machines.findIndex(m => m.name === machineName);\r\n  if (machineIndex !== -1) {\r\n    machines[machineIndex].lastSubmission = getTimeAgo(new Date(timestamp));\r\n  }\r\n  localStorage.setItem(MACHINES_KEY, JSON.stringify(machines));\r\n};\r\n\r\n// Get machines data with local modifications\r\nexport const getMachinesData = (): Machine[] => {\r\n  // Return cache if available\r\n  if (machinesCache) {\r\n    return machinesCache;\r\n  }\r\n\r\n  // Otherwise return from localStorage\r\n  return getMachinesDataLocal();\r\n};\r\n\r\n// Update a single machine\r\nexport const updateMachine = async (machineId: string, updates: Partial<Machine>): Promise<void> => {\r\n  const machines = getMachinesData();\r\n  const index = machines.findIndex(m => m.id === machineId);\r\n  if (index !== -1) {\r\n    machines[index] = { ...machines[index], ...updates };\r\n    machinesCache = machines;\r\n    localStorage.setItem(MACHINES_KEY, JSON.stringify(machines));\r\n\r\n    // Sync to Supabase\r\n    if (useSupabase) {\r\n      try {\r\n        await upsertMachine(toSupabaseRecord(machines[index]));\r\n      } catch (error) {\r\n        console.error('Failed to sync machine update to Supabase:', error);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n// Add a new machine\r\nexport const addMachine = async (machine: Machine): Promise<void> => {\r\n  const machines = getMachinesData();\r\n  machines.push(machine);\r\n  machinesCache = machines;\r\n  localStorage.setItem(MACHINES_KEY, JSON.stringify(machines));\r\n\r\n  // Sync to Supabase\r\n  if (useSupabase) {\r\n    try {\r\n      await upsertMachine(toSupabaseRecord(machine));\r\n    } catch (error) {\r\n      console.error('Failed to sync new machine to Supabase:', error);\r\n    }\r\n  }\r\n};\r\n\r\n// Delete a machine\r\nexport const deleteMachine = async (machineId: string): Promise<void> => {\r\n  const machines = getMachinesData();\r\n  const filtered = machines.filter(m => m.id !== machineId);\r\n  machinesCache = filtered;\r\n  localStorage.setItem(MACHINES_KEY, JSON.stringify(filtered));\r\n\r\n  // Sync to Supabase\r\n  if (useSupabase) {\r\n    try {\r\n      await removeMachine(machineId);\r\n    } catch (error) {\r\n      console.error('Failed to delete machine from Supabase:', error);\r\n    }\r\n  }\r\n};\r\n\r\n// Reset machines to default\r\nexport const resetMachines = async (): Promise<void> => {\r\n  machinesCache = MACHINES;\r\n  localStorage.setItem(MACHINES_KEY, JSON.stringify(MACHINES));\r\n\r\n  // Sync to Supabase\r\n  if (useSupabase) {\r\n    try {\r\n      await syncMachinesToSupabase(MACHINES.map(toSupabaseRecord));\r\n    } catch (error) {\r\n      console.error('Failed to reset machines in Supabase:', error);\r\n    }\r\n  }\r\n};\r\n\r\n// Helper function to format time ago\r\nexport const getTimeAgo = (date: Date): string => {\r\n  const now = new Date();\r\n  const diffMs = now.getTime() - date.getTime();\r\n  const diffMins = Math.floor(diffMs / 60000);\r\n  const diffHours = Math.floor(diffMins / 60);\r\n  const diffDays = Math.floor(diffHours / 24);\r\n\r\n  if (diffMins < 1) return 'Just now';\r\n  if (diffMins < 60) return `${diffMins} min ago`;\r\n  if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;\r\n  return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;\r\n};\r\n\r\n// Export data to CSV\r\nexport const exportToCSV = (data: ShiftData[], filename: string): void => {\r\n  const headers = [\r\n    'Date',\r\n    'Shift',\r\n    'Operator',\r\n    'Machine',\r\n    'Order Number',\r\n    'Product',\r\n    'Batch Number',\r\n    'Entry Type',\r\n    'Waste Type',\r\n    'Waste (kg)',\r\n    'Downtime Reason',\r\n    'Downtime (min)',\r\n    'Submitted At',\r\n  ];\r\n\r\n  const rows: string[][] = [];\r\n\r\n  data.forEach(item => {\r\n    const baseRow = [\r\n      item.date,\r\n      item.shift,\r\n      item.operatorName,\r\n      item.machine,\r\n      item.orderNumber,\r\n      item.product,\r\n      item.batchNumber,\r\n    ];\r\n    const submittedAt = new Date(item.submittedAt).toLocaleString();\r\n\r\n    // Add a row for each waste entry\r\n    if (item.wasteEntries && item.wasteEntries.length > 0) {\r\n      item.wasteEntries.forEach(w => {\r\n        rows.push([\r\n          ...baseRow,\r\n          'Waste',\r\n          w.wasteType,\r\n          w.waste.toFixed(2),\r\n          '',\r\n          '',\r\n          submittedAt,\r\n        ]);\r\n      });\r\n    }\r\n\r\n    // Add a row for each downtime entry\r\n    if (item.downtimeEntries && item.downtimeEntries.length > 0) {\r\n      item.downtimeEntries.forEach(d => {\r\n        rows.push([\r\n          ...baseRow,\r\n          'Downtime',\r\n          '',\r\n          '',\r\n          d.downtimeReason,\r\n          d.downtime.toString(),\r\n          submittedAt,\r\n        ]);\r\n      });\r\n    }\r\n\r\n    // If no entries at all, still add one summary row\r\n    if ((!item.wasteEntries || item.wasteEntries.length === 0) &&\r\n      (!item.downtimeEntries || item.downtimeEntries.length === 0)) {\r\n      rows.push([\r\n        ...baseRow,\r\n        'Summary',\r\n        '',\r\n        item.totalWaste.toFixed(2),\r\n        '',\r\n        item.totalDowntime.toString(),\r\n        submittedAt,\r\n      ]);\r\n    }\r\n  });\r\n\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...rows.map(row => row.map(cell => `\"${cell}\"`).join(',')),\r\n  ].join('\\n');\r\n\r\n  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n  const link = document.createElement('a');\r\n  const url = URL.createObjectURL(blob);\r\n  link.setAttribute('href', url);\r\n  link.setAttribute('download', `${filename}.csv`);\r\n  link.style.visibility = 'hidden';\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n  // Clean up the object URL to prevent memory leak\r\n  URL.revokeObjectURL(url);\r\n};\r\n\r\n// Clear all history (for testing)\r\nexport const clearHistory = (): void => {\r\n  localStorage.removeItem(STORAGE_KEY);\r\n  localStorage.removeItem(MACHINES_KEY);\r\n};\r\n\r\n// ==========================================\r\n// SHARED LINE SPEED - Syncs across sub-machines\r\n// ==========================================\r\n\r\nconst LINE_SPEED_KEY_PREFIX = 'line_speed_';\r\n\r\n/**\r\n * Extract parent machine name from a sub-machine name\r\n * e.g., \"Cubes - Machine 1\" ‚Üí \"Cubes\"\r\n * e.g., \"Universal 2 - Machine 3\" ‚Üí \"Universal 2\"\r\n */\r\nexport const getParentMachineName = (machineName: string): string => {\r\n  // Check if it matches the pattern \"Parent - Machine N\"\r\n  const match = machineName.match(/^(.+?)\\s*-\\s*Machine\\s*\\d+$/i);\r\n  if (match) {\r\n    return match[1].trim();\r\n  }\r\n  // Return the original name if no sub-machine pattern found\r\n  return machineName;\r\n};\r\n\r\n/**\r\n * Get the storage key for shared line speed\r\n */\r\nconst getLineSpeedKey = (parentMachineName: string, shift: string, date: string): string => {\r\n  return `${LINE_SPEED_KEY_PREFIX}${parentMachineName}_${shift}_${date}`;\r\n};\r\n\r\n/**\r\n * Save shared line speed (called when any sub-machine sets speed)\r\n */\r\nexport const saveLineSpeed = (\r\n  machineName: string,\r\n  shift: string,\r\n  date: string,\r\n  speed: number\r\n): void => {\r\n  const parentName = getParentMachineName(machineName);\r\n  const key = getLineSpeedKey(parentName, shift, date);\r\n\r\n  const data = {\r\n    speed,\r\n    updatedAt: new Date().toISOString(),\r\n    updatedBy: machineName,\r\n  };\r\n\r\n  localStorage.setItem(key, JSON.stringify(data));\r\n  console.log(`üíæ Saved line speed ${speed} PPM for ${parentName}`);\r\n};\r\n\r\n/**\r\n * Get shared line speed (returns the speed set by any sibling machine)\r\n */\r\nexport const getLineSpeed = (\r\n  machineName: string,\r\n  shift: string,\r\n  date: string\r\n): { speed: number; updatedBy: string; updatedAt: string } | null => {\r\n  const parentName = getParentMachineName(machineName);\r\n  const key = getLineSpeedKey(parentName, shift, date);\r\n\r\n  const stored = localStorage.getItem(key);\r\n  if (!stored) return null;\r\n\r\n  try {\r\n    const data = JSON.parse(stored);\r\n    console.log(`üìñ Loaded line speed ${data.speed} PPM for ${parentName} (set by ${data.updatedBy})`);\r\n    return data;\r\n  } catch {\r\n    return null;\r\n  }\r\n};\r\n\r\n/**\r\n * Clear shared line speed (called when session ends)\r\n */\r\nexport const clearLineSpeed = (\r\n  machineName: string,\r\n  shift: string,\r\n  date: string\r\n): void => {\r\n  const parentName = getParentMachineName(machineName);\r\n  const key = getLineSpeedKey(parentName, shift, date);\r\n  localStorage.removeItem(key);\r\n};\r\n\r\n/**\r\n * Clean up old line speed entries (called periodically)\r\n */\r\nexport const cleanupOldLineSpeeds = (retentionDays: number = 7): number => {\r\n  const cutoff = Date.now() - (retentionDays * 24 * 60 * 60 * 1000);\r\n  let removed = 0;\r\n\r\n  for (let i = localStorage.length - 1; i >= 0; i--) {\r\n    const key = localStorage.key(i);\r\n    if (key?.startsWith(LINE_SPEED_KEY_PREFIX)) {\r\n      try {\r\n        const data = localStorage.getItem(key);\r\n        if (data) {\r\n          const parsed = JSON.parse(data);\r\n          const updatedAt = new Date(parsed.updatedAt).getTime();\r\n          if (updatedAt < cutoff) {\r\n            localStorage.removeItem(key);\r\n            removed++;\r\n          }\r\n        }\r\n      } catch {\r\n        // Invalid data - remove it\r\n        localStorage.removeItem(key);\r\n        removed++;\r\n      }\r\n    }\r\n  }\r\n\r\n  return removed;\r\n};\r\n"],"names":["getSessionKey","machineName","shift","date","concat","MultiCaptureScreen","_location$state2","_location$state3","location","useLocation","navigate","useNavigate","machineNames","useMemo","_location$state","state","parentGroup","isMultiMachine","machineNumbers","map","name","split","join","useEffect","length","localStorage","setItem","removeItem","dateTime","setDateTime","useState","Date","setShift","isSubmitting","setIsSubmitting","toast","setToast","showConfirmDialog","setShowConfirmDialog","machineDataList","setMachineDataList","operatorName","speed","orderNumber","setOrderNumber","product","setProduct","batchNumber","setBatchNumber","isSessionLocked","setIsSessionLocked","wasteEntries","setWasteEntries","downtimeEntries","setDowntimeEntries","showWasteModal","setShowWasteModal","showDowntimeModal","setShowDowntimeModal","waste","setWaste","wasteType","setWasteType","downtime","setDowntime","downtimeReason","setDowntimeReason","showToast","message","type","setTimeout","timer","setInterval","now","hours","getUTCHours","clearInterval","updateMachineData","index","field","value","prev","updated","_objectSpread","canLockSession","every","m","totalWaste","reduce","sum","e","totalDowntime","_jsxs","motion","div","className","initial","opacity","x","animate","exit","children","_jsx","y","ConfirmDialog","isOpen","title","onConfirm","async","machineData","shiftData","id","uuidv4","machine","toISOString","speedEntries","Number","timestamp","submittedAt","saveShiftData","submitShiftData","operator_name","order_number","batch_number","submission_date","is_early_submission","currentDate","currentShift","forEach","error","console","onCancel","onClick","handleBack","viewBox","fill","stroke","strokeWidth","d","toLowerCase","onChange","target","placeholder","disabled","ShiftInfo","handleLockSession","sessionKey","session","locked","JSON","stringify","slice","reverse","entry","toLocaleTimeString","hour","minute","handleDeleteWasteEntry","filter","toFixed","handleDeleteDowntimeEntry","Math","floor","handleSubmitClick","width","height","AnimatePresence","scale","stopPropagation","autoFocus","WASTE_TYPES","t","handleWasteSubmit","newEntry","DOWNTIME_REASONS","r","handleDowntimeSubmit","_ref","format","confirmText","cancelText","getButtonClass","MACHINES","randomUUID","crypto","bind","getRandomValues","rnds8","Uint8Array","byteToHex","i","push","toString","unsafeStringify","arr","offset","arguments","undefined","_v4","options","buf","_options$random","_options$rng","_options","rnds","random","rng","call","Error","RangeError","native","STORAGE_KEY","MACHINES_KEY","FAILED_SUBMISSIONS_KEY","getFailedSubmissions","stored","getItem","parse","_unused","addFailedSubmission","data","queue","substr","retryCount","maxRetries","removeFailedSubmission","filtered","s","retryFailedSubmissions","isSupabaseConfigured","succeeded","failed","remaining","submission","sachetMassEntries","looseCasesEntries","palletScanEntries","updatedQueue","String","maybeRunCleanup","lastCleanupKey","lastCleanup","lastDate","getTime","result","cleanupOldHistory","history","getShiftHistory","cutoffDate","HISTORY_MAX_DAYS","cleaned","item","removed","log","useSupabase","machinesCache","machinesListeners","toLocalMachine","record","status","currentOperator","current_operator","currentOrder","current_order","current_shift","lastSubmission","last_submission","todayWaste","today_waste","todayDowntime","today_downtime","subMachineCount","sub_machine_count","toSupabaseRecord","initializeMachines","records","fetchMachines","defaultMachines","syncMachinesToSupabase","getMachinesDataLocal","subscribeToMachineUpdates","callback","unsubscribe","subscribeMachineChanges","listener","getCurrentMachines","l","_unused2","existing","unshift","updateMachineLastSubmission","w","_unused3","getTodayStats","today","todayData","submissionCount","machines","getMachinesData","machineIndex","findIndex","getTimeAgo","updateMachine","machineId","updates","upsertMachine","addMachine","deleteMachine","removeMachine","diffMs","diffMins","diffHours","diffDays","exportToCSV","filename","rows","baseRow","toLocaleString","csvContent","row","cell","blob","Blob","link","document","createElement","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild","revokeObjectURL","LINE_SPEED_KEY_PREFIX","getParentMachineName","match","trim","getLineSpeedKey","parentMachineName","saveLineSpeed","parentName","key","updatedAt","updatedBy","getLineSpeed","_unused4"],"ignoreList":[],"sourceRoot":""}