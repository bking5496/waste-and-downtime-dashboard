{"version":3,"file":"static/js/640.41681085.chunk.js","mappings":"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","sources":["components/MainForm.tsx","components/DashboardCharts.tsx","components/QRScanner.tsx","components/ui/Button.tsx","components/ui/Modal.tsx","components/ui/FormField.tsx","components/ui/DataGrid.tsx","components/ui/AddOrderModal.tsx","pages/CaptureScreen.tsx","components/ShiftInfo.tsx","components/ConfirmDialog.tsx"],"sourcesContent":["import React from 'react';\r\n\r\ninterface MainFormProps {\r\n  operatorName: string;\r\n  setOperatorName: (value: string) => void;\r\n  machine: string;\r\n  setMachine: (value: string) => void;\r\n  orderNumber: string;\r\n  setOrderNumber: (value: string) => void;\r\n  product: string;\r\n  setProduct: (value: string) => void;\r\n  batchNumber: string;\r\n  setBatchNumber: (value: string) => void;\r\n  hideMachine?: boolean;\r\n  disabled?: boolean;\r\n}\r\n\r\nconst MainForm: React.FC<MainFormProps> = ({\r\n  operatorName,\r\n  setOperatorName,\r\n  machine,\r\n  setMachine,\r\n  orderNumber,\r\n  setOrderNumber,\r\n  product,\r\n  setProduct,\r\n  batchNumber,\r\n  setBatchNumber,\r\n  hideMachine = false,\r\n  disabled = false,\r\n}) => {\r\n  return (\r\n    <div className=\"main-form-fields\">\r\n      {/* Operator Number - Text Input */}\r\n      <div className=\"form-field\">\r\n        <label htmlFor=\"operatorNumber\" className=\"form-label\">Operator Number</label>\r\n        <input\r\n          type=\"text\"\r\n          className=\"form-input\"\r\n          id=\"operatorNumber\"\r\n          value={operatorName}\r\n          onChange={e => setOperatorName(e.target.value)}\r\n          placeholder=\"Enter operator number (e.g., 042)\"\r\n          disabled={disabled}\r\n        />\r\n      </div>\r\n\r\n      {!hideMachine && (\r\n        <div className=\"form-field\">\r\n          <label htmlFor=\"machine\" className=\"form-label\">Machine</label>\r\n          <input\r\n            type=\"text\"\r\n            className=\"form-input\"\r\n            id=\"machine\"\r\n            value={machine}\r\n            readOnly\r\n            disabled={disabled}\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* Order Number - Text Input (read from admin or manual entry) */}\r\n      <div className=\"form-field\">\r\n        <label htmlFor=\"orderNumber\" className=\"form-label\">Order Number</label>\r\n        <input\r\n          type=\"text\"\r\n          className=\"form-input\"\r\n          id=\"orderNumber\"\r\n          value={orderNumber}\r\n          onChange={e => setOrderNumber(e.target.value)}\r\n          placeholder=\"Enter order number\"\r\n          disabled={disabled}\r\n        />\r\n      </div>\r\n\r\n      {/* Product - Text Input */}\r\n      <div className=\"form-field\">\r\n        <label htmlFor=\"product\" className=\"form-label\">Product</label>\r\n        <input\r\n          type=\"text\"\r\n          className=\"form-input\"\r\n          id=\"product\"\r\n          value={product}\r\n          onChange={e => setProduct(e.target.value)}\r\n          placeholder=\"Enter product name\"\r\n          disabled={disabled}\r\n        />\r\n      </div>\r\n\r\n      {/* Batch Number - Text Input */}\r\n      <div className=\"form-field\">\r\n        <label htmlFor=\"batchNumber\" className=\"form-label\">Batch Number</label>\r\n        <input\r\n          type=\"text\"\r\n          className=\"form-input\"\r\n          id=\"batchNumber\"\r\n          value={batchNumber}\r\n          onChange={e => setBatchNumber(e.target.value)}\r\n          placeholder=\"Enter batch number\"\r\n          disabled={disabled}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MainForm;\r\n","import React from 'react';\r\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, PieChart, Pie, Cell } from 'recharts';\r\nimport { WasteEntry, DowntimeEntry } from '../types';\r\n\r\ninterface DashboardChartsProps {\r\n  wasteEntries: WasteEntry[];\r\n  downtimeEntries: DowntimeEntry[];\r\n}\r\n\r\nconst COLORS = ['#f87171', '#fbbf24', '#34d399', '#60a5fa', '#a78bfa', '#f472b6'];\r\n\r\n// Empty state component\r\nconst EmptyChart: React.FC<{ message: string; icon: string }> = ({ message, icon }) => (\r\n  <div className=\"chart-empty-state\">\r\n    <span className=\"empty-icon\">{icon}</span>\r\n    <span className=\"empty-text\">{message}</span>\r\n  </div>\r\n);\r\n\r\nconst DashboardCharts: React.FC<DashboardChartsProps> = ({ wasteEntries, downtimeEntries }) => {\r\n  // Aggregate waste by type\r\n  const wasteData = wasteEntries.reduce((acc: any[], entry) => {\r\n    const existing = acc.find(item => item.name === entry.wasteType);\r\n    if (existing) {\r\n      existing.value += entry.waste;\r\n    } else {\r\n      acc.push({ name: entry.wasteType, value: entry.waste });\r\n    }\r\n    return acc;\r\n  }, []);\r\n\r\n  // Aggregate downtime by reason\r\n  const downtimeData = downtimeEntries.reduce((acc: any[], entry) => {\r\n    const existing = acc.find(item => item.name === entry.downtimeReason);\r\n    if (existing) {\r\n      existing.value += entry.downtime;\r\n    } else {\r\n      acc.push({ name: entry.downtimeReason, value: entry.downtime });\r\n    }\r\n    return acc;\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"charts-grid\">\r\n      <div className=\"chart-container\">\r\n        <h4 className=\"chart-title\">Waste by Type</h4>\r\n        {wasteData.length === 0 ? (\r\n          <EmptyChart message=\"No waste entries yet\" icon=\"\" />\r\n        ) : (\r\n          <div className=\"chart-wrapper\">\r\n            <ResponsiveContainer width=\"100%\" height={180}>\r\n              <BarChart data={wasteData} margin={{ top: 10, right: 10, left: -10, bottom: 0 }}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(0,245,255,0.1)\" />\r\n                <XAxis\r\n                  dataKey=\"name\"\r\n                  tick={{ fill: '#00f5ff', fontSize: 11 }}\r\n                  axisLine={{ stroke: 'rgba(0,245,255,0.2)' }}\r\n                  tickLine={false}\r\n                />\r\n                <YAxis\r\n                  tick={{ fill: '#00f5ff', fontSize: 11 }}\r\n                  axisLine={{ stroke: 'rgba(0,245,255,0.2)' }}\r\n                  tickLine={false}\r\n                />\r\n                <Tooltip\r\n                  contentStyle={{\r\n                    background: 'rgba(10,25,40,0.95)',\r\n                    border: '1px solid rgba(0,245,255,0.2)',\r\n                    borderRadius: '8px',\r\n                    color: '#f8fafc'\r\n                  }}\r\n                />\r\n                <Bar dataKey=\"value\" fill=\"#f87171\" name=\"Waste (kg)\" radius={[4, 4, 0, 0]} />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n        )}\r\n      </div>\r\n      <div className=\"chart-container\">\r\n        <h4 className=\"chart-title\">Downtime by Reason</h4>\r\n        {downtimeData.length === 0 ? (\r\n          <EmptyChart message=\"No downtime entries yet\" icon=\"\" />\r\n        ) : (\r\n          <div className=\"chart-wrapper\">\r\n            <ResponsiveContainer width=\"100%\" height={180}>\r\n              <PieChart>\r\n                <Pie\r\n                  data={downtimeData}\r\n                  cx=\"50%\"\r\n                  cy=\"50%\"\r\n                  labelLine={false}\r\n                  label={({ name, percent }: { name: string; percent: number }) => \r\n                    percent > 0.1 ? `${(percent * 100).toFixed(0)}%` : ''\r\n                  }\r\n                  outerRadius={65}\r\n                  innerRadius={35}\r\n                  fill=\"#8884d8\"\r\n                  dataKey=\"value\"\r\n                  stroke=\"rgba(15,23,42,0.5)\"\r\n                  strokeWidth={2}\r\n                >\r\n                  {downtimeData.map((entry: any, index: number) => (\r\n                    <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\r\n                  ))}\r\n                </Pie>\r\n                <Tooltip\r\n                  contentStyle={{\r\n                    background: 'rgba(10,25,40,0.95)',\r\n                    border: '1px solid rgba(0,245,255,0.2)',\r\n                    borderRadius: '8px',\r\n                    color: '#f8fafc'\r\n                  }}\r\n                  formatter={(value: number) => [`${value} min`, 'Duration']}\r\n                />\r\n              </PieChart>\r\n            </ResponsiveContainer>\r\n            <div className=\"chart-legend\">\r\n              {downtimeData.map((entry: any, index: number) => (\r\n                <div key={entry.name} className=\"legend-item\">\r\n                  <span className=\"legend-dot\" style={{ background: COLORS[index % COLORS.length] }} />\r\n                  <span className=\"legend-label\">{entry.name}</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DashboardCharts;\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { Html5Qrcode, Html5QrcodeScannerState } from 'html5-qrcode';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface QRScannerProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onScan: (qrData: string) => void;\r\n  recentScans?: string[]; // To prevent duplicate scans\r\n}\r\n\r\nconst QRScanner: React.FC<QRScannerProps> = ({ isOpen, onClose, onScan, recentScans = [] }) => {\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [, setIsScanning] = useState(false); // Tracks scanning state for future UI enhancements\r\n  const [lastScanned, setLastScanned] = useState<string | null>(null);\r\n  const [showSuccess, setShowSuccess] = useState(false);\r\n  const scannerRef = useRef<Html5Qrcode | null>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const isOpenRef = useRef(isOpen);\r\n\r\n  // Keep ref in sync with prop\r\n  useEffect(() => {\r\n    isOpenRef.current = isOpen;\r\n  }, [isOpen]);\r\n\r\n  // Initialize scanner when modal opens\r\n  useEffect(() => {\r\n    if (isOpen && containerRef.current) {\r\n      // Delay to ensure DOM is ready\r\n      const timeoutId = setTimeout(() => {\r\n        startScannerInternal();\r\n      }, 100);\r\n      return () => clearTimeout(timeoutId);\r\n    }\r\n    return () => {\r\n      stopScannerInternal();\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [isOpen]);\r\n\r\n  const stopScannerInternal = async () => {\r\n    if (scannerRef.current) {\r\n      try {\r\n        const state = scannerRef.current.getState();\r\n        if (state === Html5QrcodeScannerState.SCANNING) {\r\n          await scannerRef.current.stop();\r\n        }\r\n        scannerRef.current.clear();\r\n      } catch (err) {\r\n        console.error('Error stopping scanner:', err);\r\n      }\r\n      scannerRef.current = null;\r\n    }\r\n    setIsScanning(false);\r\n  };\r\n\r\n  const startScannerInternal = async () => {\r\n    if (scannerRef.current) {\r\n      await stopScannerInternal();\r\n    }\r\n\r\n    try {\r\n      setError(null);\r\n      setIsScanning(true);\r\n      \r\n      const scanner = new Html5Qrcode('qr-reader');\r\n      scannerRef.current = scanner;\r\n\r\n      await scanner.start(\r\n        { facingMode: 'environment' }, // Use back camera\r\n        {\r\n          fps: 10,\r\n          qrbox: { width: 250, height: 250 },\r\n          aspectRatio: 1.0,\r\n        },\r\n        (decodedText) => {\r\n          handleSuccessfulScan(decodedText);\r\n        },\r\n        () => {\r\n          // QR code not found - this is normal, just keep scanning\r\n        }\r\n      );\r\n    } catch (err: any) {\r\n      console.error('QR Scanner error:', err);\r\n      setIsScanning(false);\r\n      \r\n      if (err.toString().includes('NotAllowedError')) {\r\n        setError('Camera permission denied. Please allow camera access to scan QR codes.');\r\n      } else if (err.toString().includes('NotFoundError')) {\r\n        setError('No camera found. Please ensure your device has a camera.');\r\n      } else {\r\n        setError(`Failed to start scanner: ${err.message || err}`);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSuccessfulScan = async (qrData: string) => {\r\n    // Prevent duplicate scans (same QR within 3 seconds)\r\n    if (lastScanned === qrData) {\r\n      return;\r\n    }\r\n\r\n    // Check if this pallet was already scanned this session\r\n    if (recentScans.includes(qrData)) {\r\n      setError(`Pallet \"${qrData}\" was already scanned this session!`);\r\n      setTimeout(() => setError(null), 3000);\r\n      return;\r\n    }\r\n\r\n    setLastScanned(qrData);\r\n    setShowSuccess(true);\r\n    \r\n    // Vibrate on successful scan (if supported)\r\n    if (navigator.vibrate) {\r\n      navigator.vibrate(200);\r\n    }\r\n\r\n    // Stop scanning briefly to show success\r\n    await stopScannerInternal();\r\n    \r\n    // Call the parent callback\r\n    onScan(qrData);\r\n\r\n    // Show success for 1.5 seconds then continue scanning\r\n    setTimeout(() => {\r\n      setShowSuccess(false);\r\n      setLastScanned(null);\r\n      if (isOpen) {\r\n        startScannerInternal();\r\n      }\r\n    }, 1500);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    stopScannerInternal();\r\n    onClose();\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      <motion.div \r\n        className=\"qr-scanner-overlay\"\r\n        initial={{ opacity: 0 }}\r\n        animate={{ opacity: 1 }}\r\n        exit={{ opacity: 0 }}\r\n        onClick={handleClose}\r\n      >\r\n        <motion.div \r\n          className=\"qr-scanner-modal\"\r\n          initial={{ scale: 0.9, opacity: 0 }}\r\n          animate={{ scale: 1, opacity: 1 }}\r\n          exit={{ scale: 0.9, opacity: 0 }}\r\n          onClick={e => e.stopPropagation()}\r\n        >\r\n          <div className=\"qr-scanner-header\">\r\n            <h3>\r\n              <span className=\"scanner-icon\"></span>\r\n              Scan Pallet QR Code\r\n            </h3>\r\n            <button className=\"qr-close-btn\" onClick={handleClose}></button>\r\n          </div>\r\n\r\n          <div className=\"qr-scanner-body\" ref={containerRef}>\r\n            {/* Success overlay */}\r\n            <AnimatePresence>\r\n              {showSuccess && (\r\n                <motion.div \r\n                  className=\"scan-success-overlay\"\r\n                  initial={{ opacity: 0, scale: 0.8 }}\r\n                  animate={{ opacity: 1, scale: 1 }}\r\n                  exit={{ opacity: 0, scale: 0.8 }}\r\n                >\r\n                  <div className=\"success-checkmark\"></div>\r\n                  <p>Pallet Scanned!</p>\r\n                  <span className=\"scanned-code\">{lastScanned}</span>\r\n                </motion.div>\r\n              )}\r\n            </AnimatePresence>\r\n\r\n            {/* Error message */}\r\n            {error && (\r\n              <div className=\"qr-error-message\">\r\n                <span className=\"error-icon\"></span>\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            {/* QR Reader container */}\r\n            <div id=\"qr-reader\" className=\"qr-reader-container\"></div>\r\n\r\n            {/* Instructions */}\r\n            <div className=\"qr-instructions\">\r\n              <p>Position the QR code within the frame</p>\r\n              {recentScans.length > 0 && (\r\n                <span className=\"scan-count\">{recentScans.length} pallets scanned this shift</span>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"qr-scanner-footer\">\r\n            <button className=\"qr-cancel-btn\" onClick={handleClose}>\r\n              Done Scanning\r\n            </button>\r\n          </div>\r\n        </motion.div>\r\n      </motion.div>\r\n    </AnimatePresence>\r\n  );\r\n};\r\n\r\nexport default QRScanner;\r\n","import React from 'react';\nimport './Button.css';\n\nexport type ButtonVariant =\n  | 'primary'    // Cyan - main actions\n  | 'success'    // Green - positive/running\n  | 'warning'    // Amber - caution/pause\n  | 'danger'     // Red - destructive/stop\n  | 'ghost'      // Transparent with border\n  | 'secondary'; // Muted gray\n\nexport type ButtonSize = 'sm' | 'md' | 'lg';\n\ninterface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  variant?: ButtonVariant;\n  size?: ButtonSize;\n  icon?: React.ReactNode;\n  iconPosition?: 'left' | 'right';\n  loading?: boolean;\n  fullWidth?: boolean;\n  children: React.ReactNode;\n}\n\nexport const Button: React.FC<ButtonProps> = ({\n  variant = 'primary',\n  size = 'md',\n  icon,\n  iconPosition = 'left',\n  loading = false,\n  fullWidth = false,\n  disabled,\n  children,\n  className = '',\n  ...props\n}) => {\n  const isDisabled = disabled || loading;\n\n  return (\n    <button\n      className={`mc-btn mc-btn--${variant} mc-btn--${size} ${fullWidth ? 'mc-btn--full' : ''} ${className}`}\n      disabled={isDisabled}\n      {...props}\n    >\n      {loading && (\n        <span className=\"mc-btn__loader\">\n          <span className=\"mc-btn__loader-dot\"></span>\n          <span className=\"mc-btn__loader-dot\"></span>\n          <span className=\"mc-btn__loader-dot\"></span>\n        </span>\n      )}\n      {!loading && icon && iconPosition === 'left' && (\n        <span className=\"mc-btn__icon\">{icon}</span>\n      )}\n      <span className=\"mc-btn__text\">{children}</span>\n      {!loading && icon && iconPosition === 'right' && (\n        <span className=\"mc-btn__icon\">{icon}</span>\n      )}\n    </button>\n  );\n};\n","import React, { useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Button } from './Button';\nimport './Modal.css';\n\ninterface ModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  title?: string;\n  subtitle?: string;\n  size?: 'sm' | 'md' | 'lg' | 'full';\n  children: React.ReactNode;\n  footer?: React.ReactNode;\n  closeOnOverlay?: boolean;\n  showCloseButton?: boolean;\n}\n\nexport const Modal: React.FC<ModalProps> = ({\n  isOpen,\n  onClose,\n  title,\n  subtitle,\n  size = 'md',\n  children,\n  footer,\n  closeOnOverlay = true,\n  showCloseButton = true,\n}) => {\n  // Lock body scroll when modal is open\n  useEffect(() => {\n    if (isOpen) {\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.body.style.overflow = '';\n    }\n    return () => {\n      document.body.style.overflow = '';\n    };\n  }, [isOpen]);\n\n  // Close on Escape key\n  useEffect(() => {\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape' && isOpen) {\n        onClose();\n      }\n    };\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [isOpen, onClose]);\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <motion.div\n          className=\"mc-modal-overlay\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          transition={{ duration: 0.2 }}\n          onClick={closeOnOverlay ? onClose : undefined}\n        >\n          {/* Scanline effect overlay */}\n          <div className=\"mc-modal-scanlines\" />\n\n          <motion.div\n            className={`mc-modal mc-modal--${size}`}\n            initial={{ opacity: 0, scale: 0.95, y: 20 }}\n            animate={{ opacity: 1, scale: 1, y: 0 }}\n            exit={{ opacity: 0, scale: 0.95, y: 20 }}\n            transition={{ duration: 0.2, ease: [0.4, 0, 0.2, 1] }}\n            onClick={(e) => e.stopPropagation()}\n          >\n            {/* Corner accents */}\n            <div className=\"mc-modal__corner mc-modal__corner--tl\" />\n            <div className=\"mc-modal__corner mc-modal__corner--tr\" />\n            <div className=\"mc-modal__corner mc-modal__corner--bl\" />\n            <div className=\"mc-modal__corner mc-modal__corner--br\" />\n\n            {/* Header */}\n            {(title || showCloseButton) && (\n              <div className=\"mc-modal__header\">\n                <div className=\"mc-modal__header-content\">\n                  {title && (\n                    <div className=\"mc-modal__title-group\">\n                      <h2 className=\"mc-modal__title\">{title}</h2>\n                      {subtitle && <p className=\"mc-modal__subtitle\">{subtitle}</p>}\n                    </div>\n                  )}\n                </div>\n                {showCloseButton && (\n                  <button className=\"mc-modal__close\" onClick={onClose} aria-label=\"Close\">\n                    <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                      <path d=\"M18 6L6 18M6 6l12 12\" />\n                    </svg>\n                  </button>\n                )}\n              </div>\n            )}\n\n            {/* Body */}\n            <div className=\"mc-modal__body\">\n              {children}\n            </div>\n\n            {/* Footer */}\n            {footer && (\n              <div className=\"mc-modal__footer\">\n                {footer}\n              </div>\n            )}\n          </motion.div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n};\n\n// Convenience component for confirm dialogs\ninterface ConfirmModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onConfirm: () => void;\n  title: string;\n  message: string;\n  confirmText?: string;\n  cancelText?: string;\n  variant?: 'danger' | 'warning' | 'primary';\n  loading?: boolean;\n}\n\nexport const ConfirmModal: React.FC<ConfirmModalProps> = ({\n  isOpen,\n  onClose,\n  onConfirm,\n  title,\n  message,\n  confirmText = 'Confirm',\n  cancelText = 'Cancel',\n  variant = 'primary',\n  loading = false,\n}) => {\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={onClose}\n      title={title}\n      size=\"sm\"\n      footer={\n        <div className=\"mc-modal__actions\">\n          <Button variant=\"ghost\" onClick={onClose} disabled={loading}>\n            {cancelText}\n          </Button>\n          <Button variant={variant} onClick={onConfirm} loading={loading}>\n            {confirmText}\n          </Button>\n        </div>\n      }\n    >\n      <p className=\"mc-modal__message\">{message}</p>\n    </Modal>\n  );\n};\n","import React from 'react';\nimport './FormField.css';\n\ninterface FormFieldProps {\n  label: string;\n  id: string;\n  type?: 'text' | 'number' | 'email' | 'password' | 'tel' | 'search';\n  value: string | number;\n  onChange: (value: string) => void;\n  placeholder?: string;\n  disabled?: boolean;\n  readOnly?: boolean;\n  required?: boolean;\n  error?: string;\n  hint?: string;\n  icon?: React.ReactNode;\n  className?: string;\n}\n\nexport const FormField: React.FC<FormFieldProps> = ({\n  label,\n  id,\n  type = 'text',\n  value,\n  onChange,\n  placeholder,\n  disabled = false,\n  readOnly = false,\n  required = false,\n  error,\n  hint,\n  icon,\n  className = '',\n}) => {\n  return (\n    <div className={`mc-field ${error ? 'mc-field--error' : ''} ${disabled ? 'mc-field--disabled' : ''} ${className}`}>\n      <label htmlFor={id} className=\"mc-field__label\">\n        {label}\n        {required && <span className=\"mc-field__required\">*</span>}\n      </label>\n      <div className=\"mc-field__input-wrapper\">\n        {icon && <span className=\"mc-field__icon\">{icon}</span>}\n        <input\n          type={type}\n          id={id}\n          className={`mc-field__input ${icon ? 'mc-field__input--with-icon' : ''}`}\n          value={value}\n          onChange={(e) => onChange(e.target.value)}\n          placeholder={placeholder}\n          disabled={disabled}\n          readOnly={readOnly}\n          required={required}\n        />\n        <div className=\"mc-field__glow\" />\n      </div>\n      {error && <span className=\"mc-field__error\">{error}</span>}\n      {hint && !error && <span className=\"mc-field__hint\">{hint}</span>}\n    </div>\n  );\n};\n\ninterface SelectFieldProps {\n  label: string;\n  id: string;\n  value: string;\n  onChange: (value: string) => void;\n  options: Array<{ value: string; label: string }>;\n  placeholder?: string;\n  disabled?: boolean;\n  required?: boolean;\n  error?: string;\n  hint?: string;\n  className?: string;\n}\n\nexport const SelectField: React.FC<SelectFieldProps> = ({\n  label,\n  id,\n  value,\n  onChange,\n  options,\n  placeholder,\n  disabled = false,\n  required = false,\n  error,\n  hint,\n  className = '',\n}) => {\n  return (\n    <div className={`mc-field ${error ? 'mc-field--error' : ''} ${disabled ? 'mc-field--disabled' : ''} ${className}`}>\n      <label htmlFor={id} className=\"mc-field__label\">\n        {label}\n        {required && <span className=\"mc-field__required\">*</span>}\n      </label>\n      <div className=\"mc-field__input-wrapper\">\n        <select\n          id={id}\n          className=\"mc-field__select\"\n          value={value}\n          onChange={(e) => onChange(e.target.value)}\n          disabled={disabled}\n          required={required}\n        >\n          {placeholder && (\n            <option value=\"\" disabled>\n              {placeholder}\n            </option>\n          )}\n          {options.map((opt) => (\n            <option key={opt.value} value={opt.value}>\n              {opt.label}\n            </option>\n          ))}\n        </select>\n        <div className=\"mc-field__select-arrow\">\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <path d=\"M6 9l6 6 6-6\" />\n          </svg>\n        </div>\n        <div className=\"mc-field__glow\" />\n      </div>\n      {error && <span className=\"mc-field__error\">{error}</span>}\n      {hint && !error && <span className=\"mc-field__hint\">{hint}</span>}\n    </div>\n  );\n};\n\ninterface TextAreaFieldProps {\n  label: string;\n  id: string;\n  value: string;\n  onChange: (value: string) => void;\n  placeholder?: string;\n  disabled?: boolean;\n  readOnly?: boolean;\n  required?: boolean;\n  error?: string;\n  hint?: string;\n  rows?: number;\n  className?: string;\n}\n\nexport const TextAreaField: React.FC<TextAreaFieldProps> = ({\n  label,\n  id,\n  value,\n  onChange,\n  placeholder,\n  disabled = false,\n  readOnly = false,\n  required = false,\n  error,\n  hint,\n  rows = 4,\n  className = '',\n}) => {\n  return (\n    <div className={`mc-field ${error ? 'mc-field--error' : ''} ${disabled ? 'mc-field--disabled' : ''} ${className}`}>\n      <label htmlFor={id} className=\"mc-field__label\">\n        {label}\n        {required && <span className=\"mc-field__required\">*</span>}\n      </label>\n      <div className=\"mc-field__input-wrapper\">\n        <textarea\n          id={id}\n          className=\"mc-field__textarea\"\n          value={value}\n          onChange={(e) => onChange(e.target.value)}\n          placeholder={placeholder}\n          disabled={disabled}\n          readOnly={readOnly}\n          required={required}\n          rows={rows}\n        />\n        <div className=\"mc-field__glow\" />\n      </div>\n      {error && <span className=\"mc-field__error\">{error}</span>}\n      {hint && !error && <span className=\"mc-field__hint\">{hint}</span>}\n    </div>\n  );\n};\n","import React from 'react';\nimport { motion } from 'framer-motion';\nimport './DataGrid.css';\n\ninterface Column<T> {\n  key: keyof T | string;\n  header: string;\n  width?: string;\n  align?: 'left' | 'center' | 'right';\n  render?: (row: T, index: number) => React.ReactNode;\n  sortable?: boolean;\n}\n\ninterface DataGridProps<T> {\n  columns: Column<T>[];\n  data: T[];\n  keyField: keyof T;\n  onRowClick?: (row: T) => void;\n  sortColumn?: string;\n  sortDirection?: 'asc' | 'desc';\n  onSort?: (column: string) => void;\n  emptyMessage?: string;\n  loading?: boolean;\n  className?: string;\n}\n\nexport function DataGrid<T extends Record<string, unknown>>({\n  columns,\n  data,\n  keyField,\n  onRowClick,\n  sortColumn,\n  sortDirection,\n  onSort,\n  emptyMessage = 'No data available',\n  loading = false,\n  className = '',\n}: DataGridProps<T>) {\n  const renderCell = (row: T, column: Column<T>, index: number) => {\n    if (column.render) {\n      return column.render(row, index);\n    }\n    const value = row[column.key as keyof T];\n    return value !== undefined && value !== null ? String(value) : '-';\n  };\n\n  return (\n    <div className={`mc-grid-container ${className}`}>\n      <div className=\"mc-grid-wrapper\">\n        <table className=\"mc-grid\">\n          <thead className=\"mc-grid__head\">\n            <tr>\n              {columns.map((column) => (\n                <th\n                  key={String(column.key)}\n                  className={`mc-grid__th ${column.sortable ? 'mc-grid__th--sortable' : ''} mc-grid__th--${column.align || 'left'}`}\n                  style={{ width: column.width }}\n                  onClick={() => column.sortable && onSort?.(String(column.key))}\n                >\n                  <div className=\"mc-grid__th-content\">\n                    <span>{column.header}</span>\n                    {column.sortable && sortColumn === column.key && (\n                      <span className=\"mc-grid__sort-icon\">\n                        {sortDirection === 'asc' ? '' : ''}\n                      </span>\n                    )}\n                  </div>\n                </th>\n              ))}\n            </tr>\n          </thead>\n          <tbody className=\"mc-grid__body\">\n            {loading ? (\n              <tr>\n                <td colSpan={columns.length} className=\"mc-grid__loading\">\n                  <div className=\"mc-grid__loader\">\n                    <span></span>\n                    <span></span>\n                    <span></span>\n                  </div>\n                </td>\n              </tr>\n            ) : data.length === 0 ? (\n              <tr>\n                <td colSpan={columns.length} className=\"mc-grid__empty\">\n                  {emptyMessage}\n                </td>\n              </tr>\n            ) : (\n              data.map((row, index) => (\n                <motion.tr\n                  key={String(row[keyField])}\n                  className={`mc-grid__row ${onRowClick ? 'mc-grid__row--clickable' : ''}`}\n                  onClick={() => onRowClick?.(row)}\n                  initial={{ opacity: 0, y: -5 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: index * 0.03 }}\n                >\n                  {columns.map((column) => (\n                    <td\n                      key={String(column.key)}\n                      className={`mc-grid__td mc-grid__td--${column.align || 'left'}`}\n                    >\n                      {renderCell(row, column, index)}\n                    </td>\n                  ))}\n                </motion.tr>\n              ))\n            )}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}\n\n// Pagination component\ninterface PaginationProps {\n  currentPage: number;\n  totalPages: number;\n  totalItems: number;\n  itemsPerPage: number;\n  onPageChange: (page: number) => void;\n}\n\nexport const Pagination: React.FC<PaginationProps> = ({\n  currentPage,\n  totalPages,\n  totalItems,\n  itemsPerPage,\n  onPageChange,\n}) => {\n  const startItem = (currentPage - 1) * itemsPerPage + 1;\n  const endItem = Math.min(currentPage * itemsPerPage, totalItems);\n\n  return (\n    <div className=\"mc-pagination\">\n      <div className=\"mc-pagination__info\">\n        Showing {startItem} to {endItem} of {totalItems} entries\n      </div>\n      <div className=\"mc-pagination__controls\">\n        <button\n          className=\"mc-pagination__btn\"\n          disabled={currentPage === 1}\n          onClick={() => onPageChange(currentPage - 1)}\n        >\n           Previous\n        </button>\n        <span className=\"mc-pagination__page\">\n          {currentPage} / {totalPages}\n        </span>\n        <button\n          className=\"mc-pagination__btn\"\n          disabled={currentPage === totalPages}\n          onClick={() => onPageChange(currentPage + 1)}\n        >\n          Next \n        </button>\n      </div>\n    </div>\n  );\n};\n","import React, { useState } from 'react';\nimport { Modal } from './Modal';\nimport { Button } from './Button';\nimport { FormField } from './FormField';\nimport { addMachineOrder } from '../../lib/supabase';\nimport './AddOrderModal.css';\n\ninterface AddOrderModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  machineId: string;\n  machineName: string;\n  onOrderAdded: (order: { orderNumber: string; product: string; batchNumber: string }) => void;\n}\n\nexport const AddOrderModal: React.FC<AddOrderModalProps> = ({\n  isOpen,\n  onClose,\n  machineId,\n  machineName,\n  onOrderAdded,\n}) => {\n  const [orderNumber, setOrderNumber] = useState('');\n  const [product, setProduct] = useState('');\n  const [batchNumber, setBatchNumber] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleSubmit = async () => {\n    // Validation\n    if (!orderNumber.trim()) {\n      setError('Order number is required');\n      return;\n    }\n    if (!product.trim()) {\n      setError('Product is required');\n      return;\n    }\n\n    setLoading(true);\n    setError('');\n\n    try {\n      // Add to machine order queue\n      await addMachineOrder(\n        machineId,\n        orderNumber.trim(),\n        product.trim(),\n        batchNumber.trim() || ''\n      );\n\n      // Notify parent and close\n      onOrderAdded({\n        orderNumber: orderNumber.trim(),\n        product: product.trim(),\n        batchNumber: batchNumber.trim(),\n      });\n\n      // Reset form\n      setOrderNumber('');\n      setProduct('');\n      setBatchNumber('');\n      onClose();\n    } catch (err) {\n      console.error('Failed to add order:', err);\n      setError('Failed to add order. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    setOrderNumber('');\n    setProduct('');\n    setBatchNumber('');\n    setError('');\n    onClose();\n  };\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={handleClose}\n      title=\"Add New Order\"\n      subtitle={machineName}\n      size=\"md\"\n      footer={\n        <div className=\"mc-add-order__actions\">\n          <Button variant=\"ghost\" onClick={handleClose} disabled={loading}>\n            Cancel\n          </Button>\n          <Button variant=\"success\" onClick={handleSubmit} loading={loading}>\n            Add Order & Start\n          </Button>\n        </div>\n      }\n    >\n      <div className=\"mc-add-order\">\n        <p className=\"mc-add-order__description\">\n          Create a new order for this machine. The order will be added to the queue and automatically selected.\n        </p>\n\n        {error && (\n          <div className=\"mc-add-order__error\">\n            <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n              <circle cx=\"12\" cy=\"12\" r=\"10\" />\n              <path d=\"M12 8v4M12 16h.01\" />\n            </svg>\n            {error}\n          </div>\n        )}\n\n        <div className=\"mc-add-order__form\">\n          <FormField\n            label=\"Order Number\"\n            id=\"order-number\"\n            value={orderNumber}\n            onChange={setOrderNumber}\n            placeholder=\"e.g., ORD-2024-001\"\n            required\n            disabled={loading}\n          />\n\n          <FormField\n            label=\"Product\"\n            id=\"product\"\n            value={product}\n            onChange={setProduct}\n            placeholder=\"e.g., Product A\"\n            required\n            disabled={loading}\n          />\n\n          <FormField\n            label=\"Batch Number\"\n            id=\"batch-number\"\n            value={batchNumber}\n            onChange={setBatchNumber}\n            placeholder=\"e.g., BATCH-001 (optional)\"\n            disabled={loading}\n          />\n        </div>\n\n        <div className=\"mc-add-order__hint\">\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <circle cx=\"12\" cy=\"12\" r=\"10\" />\n            <path d=\"M12 16v-4M12 8h.01\" />\n          </svg>\n          <span>Orders can also be added in bulk from the Admin Console.</span>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { useParams, useLocation, useNavigate } from 'react-router-dom';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport ShiftInfo from '../components/ShiftInfo';\r\nimport MainForm from '../components/MainForm';\r\nimport DashboardCharts from '../components/DashboardCharts';\r\nimport ConfirmDialog from '../components/ConfirmDialog';\r\nimport QRScanner from '../components/QRScanner';\r\nimport { WasteEntry, DowntimeEntry, ShiftData, SpeedEntry, SachetMassEntry, LooseCasesEntry, PalletScanEntry, ShiftSession, ProductionState, WASTE_TYPES, DOWNTIME_REASONS } from '../types';\r\nimport { submitShiftData, fetchMachineOrders, MachineOrderQueueRecord, updateMachineStatus } from '../lib/supabase';\r\nimport { saveShiftData, addFailedSubmission, saveLineSpeed, getLineSpeed } from '../lib/storage';\r\nimport { upsertLiveSession, deleteLiveSession, addActivityEvent } from '../lib/liveSession';\r\nimport { getCurrentShift, checkSubmissionWindow, getLocalHours } from '../lib/facilitySettings';\r\nimport {\r\n  checkForActiveSession,\r\n  acquireSessionLock,\r\n  releaseSessionLock,\r\n  subscribeToSessionConflicts,\r\n  saveProductionTimer,\r\n  loadProductionTimer,\r\n  clearProductionTimer,\r\n  calculateCurrentRunTime,\r\n  formatRunTime,\r\n  ProductionTimerState\r\n} from '../lib/sessionManager';\r\nimport { logError, showWarning, showSuccess, showError } from '../lib/errorMonitoring';\r\nimport { AddOrderModal } from '../components/ui';\r\n\r\n// Storage key for shift session\r\nconst getSessionKey = (machineName: string, shift: string, date: string) =>\r\n  `shift_session_${machineName}_${shift}_${date}`;\r\n\r\nconst CaptureScreen: React.FC = () => {\r\n  const { machineId } = useParams<{ machineId: string }>();\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n\r\n  // Get machine name from state, or restore from sessionStorage for sub-machines\r\n  // This ensures sub-machines keep their unique names even after page refresh\r\n  const getMachineName = (): string => {\r\n    const stateKey = `capture_machine_name_${machineId}`;\r\n    const fromState = (location.state as { machineName?: string })?.machineName;\r\n\r\n    if (fromState) {\r\n      // Save to sessionStorage for persistence across refreshes\r\n      sessionStorage.setItem(stateKey, fromState);\r\n      return fromState;\r\n    }\r\n\r\n    // Try to restore from sessionStorage\r\n    const restored = sessionStorage.getItem(stateKey);\r\n    if (restored) {\r\n      return restored;\r\n    }\r\n\r\n    // Fallback to machineId\r\n    return machineId || '';\r\n  };\r\n\r\n  const machineName = getMachineName();\r\n\r\n  // Get parent machine ID for sub-machines (orders are stored against parent)\r\n  const getParentMachineId = (): string => {\r\n    // Check location state first\r\n    const fromState = (location.state as { parentMachineId?: string })?.parentMachineId;\r\n    if (fromState) {\r\n      sessionStorage.setItem(`capture_parent_id_${machineId}`, fromState);\r\n      return fromState;\r\n    }\r\n\r\n    // Try to restore from sessionStorage\r\n    const restored = sessionStorage.getItem(`capture_parent_id_${machineId}`);\r\n    if (restored) {\r\n      return restored;\r\n    }\r\n\r\n    // Parse from machineId if it's a sub-machine (e.g., machine-xxx-sub-1 -> machine-xxx)\r\n    if (machineId && machineId.includes('-sub-')) {\r\n      return machineId.split('-sub-')[0];\r\n    }\r\n\r\n    // Return machineId as-is for non-sub-machines\r\n    return machineId || '';\r\n  };\r\n\r\n  const parentMachineId = getParentMachineId();\r\n\r\n  // Track current machine for chat widget location context\r\n  useEffect(() => {\r\n    if (machineName) {\r\n      localStorage.setItem('chat_current_machine', machineName);\r\n    }\r\n    return () => {\r\n      localStorage.removeItem('chat_current_machine');\r\n    };\r\n  }, [machineName]);\r\n\r\n  const [dateTime, setDateTime] = useState(new Date());\r\n  const [shift, setShift] = useState('');\r\n\r\n  // Loading and feedback states\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [toast, setToast] = useState<{ message: string; type: 'success' | 'error' } | null>(null);\r\n  const [showConfirmDialog, setShowConfirmDialog] = useState(false);\r\n\r\n  // State for the main form\r\n  const [operatorName, setOperatorName] = useState('');\r\n  const [orderNumber, setOrderNumber] = useState('');\r\n  const [product, setProduct] = useState('');\r\n  const [batchNumber, setBatchNumber] = useState('');\r\n  const [isSessionLocked, setIsSessionLocked] = useState(false);\r\n\r\n  // State for waste and downtime inputs\r\n  const [waste, setWaste] = useState<number | ''>('');\r\n  const [wasteType, setWasteType] = useState('');\r\n  const [downtime, setDowntime] = useState<number | ''>('');\r\n  const [downtimeReason, setDowntimeReason] = useState('');\r\n\r\n  // State for storing submitted entries\r\n  const [wasteEntries, setWasteEntries] = useState<WasteEntry[]>([]);\r\n  const [downtimeEntries, setDowntimeEntries] = useState<DowntimeEntry[]>([]);\r\n\r\n  // New states for Machine Speed, Sachet Mass, Loose Cases, Pallet Scans\r\n  const [speedEntries, setSpeedEntries] = useState<SpeedEntry[]>([]);\r\n  const [sachetMassEntries, setSachetMassEntries] = useState<SachetMassEntry[]>([]);\r\n  const [looseCasesEntries, setLooseCasesEntries] = useState<LooseCasesEntry[]>([]);\r\n  const [palletScanEntries, setPalletScanEntries] = useState<PalletScanEntry[]>([]);\r\n\r\n  // Modal states for new entries\r\n  const [showSpeedModal, setShowSpeedModal] = useState(false);\r\n  const [showSachetModal, setShowSachetModal] = useState(false);\r\n  const [showLooseCasesModal, setShowLooseCasesModal] = useState(false);\r\n  const [showQRScanner, setShowQRScanner] = useState(false);\r\n  const [showWasteModal, setShowWasteModal] = useState(false);\r\n  const [showDowntimeModal, setShowDowntimeModal] = useState(false);\r\n  const [speedInput, setSpeedInput] = useState<number | ''>('');\r\n  const [sachetMassInput, setSachetMassInput] = useState<number | ''>('');\r\n  const [looseCasesBatchInput, setLooseCasesBatchInput] = useState('');\r\n  const [looseCasesQuantityInput, setLooseCasesQuantityInput] = useState<number | ''>('');\r\n\r\n  // Submission window state\r\n  const [isInSubmissionWindow, setIsInSubmissionWindow] = useState(false);\r\n  const [, setTimeToWindow] = useState(''); // Time display for submission window\r\n\r\n  // Order queue state\r\n  const [availableOrders, setAvailableOrders] = useState<MachineOrderQueueRecord[]>([]);\r\n  const [showOrderSelect, setShowOrderSelect] = useState(false);\r\n  const [showAddOrderModal, setShowAddOrderModal] = useState(false);\r\n\r\n  // Tab state for compact layout\r\n  const [activeRecordTab, setActiveRecordTab] = useState<'waste' | 'downtime' | 'sachet' | 'product'>('waste');\r\n\r\n  // Shift change detection\r\n  const [lastKnownShift, setLastKnownShift] = useState<string | null>(null);\r\n  const [showShiftChangeModal, setShowShiftChangeModal] = useState(false);\r\n  const [newOperatorName, setNewOperatorName] = useState('');\r\n\r\n  // Changeover dialog state (shown when submitting outside window)\r\n  const [showChangeoverDialog, setShowChangeoverDialog] = useState(false);\r\n  const [willChangeover, setWillChangeover] = useState<boolean | null>(null);\r\n  const [willMaintenance, setWillMaintenance] = useState<boolean | null>(null);\r\n\r\n  // Production Timer state\r\n  const [productionState, setProductionState] = useState<ProductionState>({\r\n    isRunning: false,\r\n    startTime: null,\r\n    pausedAt: null,\r\n    totalRunTimeMs: 0,\r\n    lastResumedAt: null,\r\n  });\r\n  const [displayRunTime, setDisplayRunTime] = useState<string>('00:00:00');\r\n  const [showContinueModal, setShowContinueModal] = useState(false);\r\n  const [pauseDowntimeReason, setPauseDowntimeReason] = useState('');\r\n\r\n  // Show toast notification\r\n  const showToast = (message: string, type: 'success' | 'error') => {\r\n    setToast({ message, type });\r\n    setTimeout(() => setToast(null), 4000);\r\n  };\r\n\r\n  // Handle order selection from queue\r\n  const handleOrderSelect = (order: MachineOrderQueueRecord) => {\r\n    setOrderNumber(order.order_number);\r\n    setProduct(order.product);\r\n    setBatchNumber(order.batch_number);\r\n    setShowOrderSelect(false);\r\n    showToast(`Selected order: ${order.order_number}`, 'success');\r\n  };\r\n\r\n  // Handle new order added from AddOrderModal\r\n  const handleOrderAdded = (order: { orderNumber: string; product: string; batchNumber: string }) => {\r\n    setOrderNumber(order.orderNumber);\r\n    setProduct(order.product);\r\n    setBatchNumber(order.batchNumber);\r\n    setShowOrderSelect(false);\r\n    showToast(`Created and selected order: ${order.orderNumber}`, 'success');\r\n    // Refresh the order queue (use parent machine ID for sub-machines)\r\n    fetchMachineOrders(parentMachineId || '').then(orders => setAvailableOrders(orders)).catch(console.error);\r\n  };\r\n\r\n  // Session conflict state\r\n  const [sessionConflict, setSessionConflict] = useState<string | null>(null);\r\n  const unsubscribeConflictRef = useRef<(() => void) | null>(null);\r\n\r\n  // Check if within submission window using facility settings\r\n  const checkSubmissionWindowCallback = useCallback((currentDateTime: Date) => {\r\n    const result = checkSubmissionWindow(currentDateTime);\r\n    setIsInSubmissionWindow(result.isInWindow);\r\n    setTimeToWindow(result.isInWindow ? '' : result.timeToWindow);\r\n  }, []);\r\n\r\n  // Load saved session data and production timer\r\n  const loadSession = useCallback(async () => {\r\n    const currentDate = new Date().toISOString().split('T')[0];\r\n    const currentShift = getCurrentShift();\r\n    const sessionKey = getSessionKey(machineName, currentShift, currentDate);\r\n\r\n    // Check for session conflicts before loading\r\n    const { hasConflict, activeSession } = await checkForActiveSession(machineName, currentShift, currentDate);\r\n    if (hasConflict && activeSession) {\r\n      setSessionConflict(`Machine in use by ${activeSession.operator_name} since ${new Date(activeSession.started_at).toLocaleTimeString()}`);\r\n      showWarning(`This machine is currently being used by ${activeSession.operator_name}`);\r\n    }\r\n\r\n    // Load production timer state\r\n    const timerState = await loadProductionTimer(machineName, currentShift, currentDate);\r\n    if (timerState) {\r\n      setProductionState({\r\n        isRunning: timerState.isRunning,\r\n        startTime: timerState.startTime ? new Date(timerState.startTime) : null,\r\n        pausedAt: timerState.pausedAt ? new Date(timerState.pausedAt) : null,\r\n        totalRunTimeMs: timerState.totalRunTimeMs,\r\n        lastResumedAt: timerState.lastResumedAt ? new Date(timerState.lastResumedAt) : null,\r\n      });\r\n      if (timerState.isRunning || timerState.totalRunTimeMs > 0) {\r\n        setDisplayRunTime(formatRunTime(calculateCurrentRunTime(timerState)));\r\n      }\r\n    }\r\n\r\n    const savedSession = localStorage.getItem(sessionKey);\r\n    if (savedSession) {\r\n      try {\r\n        const session: ShiftSession = JSON.parse(savedSession);\r\n        if (session.locked) {\r\n          setOperatorName(session.operatorName);\r\n          setOrderNumber(session.orderNumber);\r\n          setProduct(session.product);\r\n          setBatchNumber(session.batchNumber);\r\n          setIsSessionLocked(true);\r\n\r\n          // Restore entry arrays\r\n          if (session.wasteEntries) setWasteEntries(session.wasteEntries);\r\n          if (session.downtimeEntries) setDowntimeEntries(session.downtimeEntries);\r\n          if (session.speedEntries && session.speedEntries.length > 0) {\r\n            setSpeedEntries(session.speedEntries);\r\n          } else {\r\n            // Check for shared line speed from sibling machines\r\n            const sharedSpeed = getLineSpeed(machineName, currentShift, currentDate);\r\n            if (sharedSpeed) {\r\n              const sharedSpeedEntry: SpeedEntry = {\r\n                id: uuidv4(),\r\n                speed: sharedSpeed.speed,\r\n                timestamp: new Date(sharedSpeed.updatedAt)\r\n              };\r\n              setSpeedEntries([sharedSpeedEntry]);\r\n              console.log(` Loaded shared speed ${sharedSpeed.speed} PPM from ${sharedSpeed.updatedBy}`);\r\n            }\r\n          }\r\n          if (session.sachetMassEntries) setSachetMassEntries(session.sachetMassEntries);\r\n          if (session.looseCasesEntries) setLooseCasesEntries(session.looseCasesEntries);\r\n          if (session.palletScanEntries) setPalletScanEntries(session.palletScanEntries);\r\n          return; // Session loaded from localStorage\r\n        }\r\n      } catch (e) {\r\n        console.error('Failed to load session:', e);\r\n      }\r\n    }\r\n\r\n    // No localStorage session - try to restore from Supabase live_sessions\r\n    try {\r\n      const { fetchLiveSessionByMachine } = await import('../lib/liveSession');\r\n      const liveSession = await fetchLiveSessionByMachine(machineName, currentShift, currentDate);\r\n      if (liveSession && liveSession.is_locked) {\r\n        // Restore session from Supabase\r\n        setOperatorName(liveSession.operator_name);\r\n        setOrderNumber(liveSession.order_number);\r\n        setProduct(liveSession.product);\r\n        setBatchNumber(liveSession.batch_number);\r\n        setIsSessionLocked(true);\r\n\r\n        // Check for shared line speed from sibling machines\r\n        const sharedSpeed = getLineSpeed(machineName, currentShift, currentDate);\r\n        let restoredSpeedEntries: SpeedEntry[] = [];\r\n        if (sharedSpeed) {\r\n          const sharedSpeedEntry: SpeedEntry = {\r\n            id: uuidv4(),\r\n            speed: sharedSpeed.speed,\r\n            timestamp: new Date(sharedSpeed.updatedAt)\r\n          };\r\n          restoredSpeedEntries = [sharedSpeedEntry];\r\n          setSpeedEntries(restoredSpeedEntries);\r\n          console.log(` Loaded shared speed ${sharedSpeed.speed} PPM from ${sharedSpeed.updatedBy}`);\r\n        }\r\n\r\n        // Save to localStorage for faster future loads\r\n        const localSession: ShiftSession = {\r\n          machineName: liveSession.machine_name,\r\n          operatorName: liveSession.operator_name,\r\n          orderNumber: liveSession.order_number,\r\n          product: liveSession.product,\r\n          batchNumber: liveSession.batch_number,\r\n          shift: liveSession.shift,\r\n          date: liveSession.session_date,\r\n          locked: true,\r\n          wasteEntries: [],\r\n          downtimeEntries: [],\r\n          speedEntries: restoredSpeedEntries,\r\n          sachetMassEntries: [],\r\n          looseCasesEntries: [],\r\n          palletScanEntries: [],\r\n        };\r\n        localStorage.setItem(sessionKey, JSON.stringify(localSession));\r\n        console.log(' Session restored from Supabase:', machineName);\r\n        return;\r\n      }\r\n    } catch (e) {\r\n      console.error('Failed to restore session from Supabase:', e);\r\n    }\r\n\r\n    // No session anywhere - try to load admin order details from database\r\n    try {\r\n      const { fetchActiveOrderDetails } = await import('../lib/supabase');\r\n      const activeOrder = await fetchActiveOrderDetails();\r\n      if (activeOrder) {\r\n        setOrderNumber(activeOrder.order_number);\r\n        setProduct(activeOrder.product);\r\n        setBatchNumber(activeOrder.batch_number);\r\n        return;\r\n      }\r\n    } catch (e) {\r\n      console.error('Failed to load from database:', e);\r\n    }\r\n\r\n    // Fall back to localStorage admin details\r\n    const adminOrderDetails = localStorage.getItem('admin_order_details');\r\n    if (adminOrderDetails) {\r\n      try {\r\n        const details = JSON.parse(adminOrderDetails);\r\n        if (details.orderNumber) setOrderNumber(details.orderNumber);\r\n        if (details.product) setProduct(details.product);\r\n        if (details.batchNumber) setBatchNumber(details.batchNumber);\r\n      } catch (e) {\r\n        console.error('Failed to load admin order details:', e);\r\n      }\r\n    }\r\n  }, [machineName]);\r\n\r\n  // Save session data with session locking\r\n  const saveSession = useCallback(async (showMessage = true) => {\r\n    if (!operatorName || !orderNumber || !product || !batchNumber) return;\r\n\r\n    const currentDate = new Date().toISOString().split('T')[0];\r\n    const currentShift = getCurrentShift();\r\n    const sessionKey = getSessionKey(machineName, currentShift, currentDate);\r\n\r\n    // Acquire session lock\r\n    const lockResult = await acquireSessionLock(machineName, operatorName, currentShift, currentDate);\r\n    if (!lockResult.success) {\r\n      showError(lockResult.error || 'Failed to acquire session lock');\r\n      return;\r\n    }\r\n\r\n    // Subscribe to session conflicts for real-time notifications\r\n    if (unsubscribeConflictRef.current) {\r\n      unsubscribeConflictRef.current();\r\n    }\r\n    unsubscribeConflictRef.current = subscribeToSessionConflicts(\r\n      machineName,\r\n      currentShift,\r\n      currentDate,\r\n      (conflictSession) => {\r\n        setSessionConflict(`Another user (${conflictSession.operator_name}) is accessing this machine`);\r\n      }\r\n    );\r\n\r\n    const session: ShiftSession = {\r\n      machineName,\r\n      operatorName,\r\n      orderNumber,\r\n      product,\r\n      batchNumber,\r\n      shift: currentShift,\r\n      date: currentDate,\r\n      locked: true,\r\n      // Persist entry arrays\r\n      wasteEntries,\r\n      downtimeEntries,\r\n      speedEntries,\r\n      sachetMassEntries,\r\n      looseCasesEntries,\r\n      palletScanEntries,\r\n    };\r\n\r\n    localStorage.setItem(sessionKey, JSON.stringify(session));\r\n\r\n    // Calculate totals for cross-browser sync\r\n    const totalWaste = wasteEntries.reduce((sum, e) => sum + e.waste, 0);\r\n    const totalDowntime = downtimeEntries.reduce((sum, e) => sum + e.downtime, 0);\r\n\r\n    // Sync to Supabase for cross-browser visibility\r\n    upsertLiveSession({\r\n      machineName,\r\n      operatorName,\r\n      orderNumber,\r\n      product,\r\n      batchNumber,\r\n      shift: currentShift,\r\n      date: currentDate,\r\n      locked: true,\r\n      totalWaste,\r\n      totalDowntime,\r\n    });\r\n\r\n    if (!isSessionLocked) {\r\n      setIsSessionLocked(true);\r\n\r\n      // Auto-start production timer when session is first locked\r\n      const now = new Date();\r\n      const newTimerState: ProductionState = {\r\n        isRunning: true,\r\n        startTime: now,\r\n        pausedAt: null,\r\n        totalRunTimeMs: 0,\r\n        lastResumedAt: now,\r\n      };\r\n      setProductionState(newTimerState);\r\n      setDisplayRunTime('00:00:00');\r\n\r\n      // Save the timer state\r\n      const timerStateToSave: ProductionTimerState = {\r\n        isRunning: true,\r\n        startTime: now.toISOString(),\r\n        pausedAt: null,\r\n        totalRunTimeMs: 0,\r\n        lastResumedAt: now.toISOString(),\r\n        pauseHistory: [],\r\n      };\r\n      saveProductionTimer(machineName, currentShift, currentDate, timerStateToSave);\r\n\r\n      // Update machine status to 'running' in Supabase\r\n      if (machineId) {\r\n        updateMachineStatus(machineId, 'running', operatorName, orderNumber, currentShift);\r\n      }\r\n      if (showMessage) showToast('Session locked - Production timer started', 'success');\r\n    }\r\n  }, [machineName, operatorName, orderNumber, product, batchNumber, wasteEntries, downtimeEntries, speedEntries, sachetMassEntries, looseCasesEntries, palletScanEntries, isSessionLocked, machineId]);\r\n\r\n  useEffect(() => {\r\n    loadSession();\r\n  }, [loadSession]);\r\n\r\n  // Ref to hold current production state for cleanup (to avoid stale closure)\r\n  const productionStateRef = useRef(productionState);\r\n  useEffect(() => {\r\n    productionStateRef.current = productionState;\r\n  }, [productionState]);\r\n\r\n  // Auto-save timer state every 30 seconds while running\r\n  useEffect(() => {\r\n    if (!productionState.isRunning || !isSessionLocked) return;\r\n\r\n    const autoSaveInterval = setInterval(() => {\r\n      const currentDate = new Date().toISOString().split('T')[0];\r\n      const currentShift = getCurrentShift();\r\n      const timerState: ProductionTimerState = {\r\n        isRunning: productionState.isRunning,\r\n        startTime: productionState.startTime?.toISOString() || null,\r\n        pausedAt: productionState.pausedAt?.toISOString() || null,\r\n        totalRunTimeMs: productionState.totalRunTimeMs,\r\n        lastResumedAt: productionState.lastResumedAt?.toISOString() || null,\r\n        pauseHistory: [],\r\n      };\r\n      saveProductionTimer(machineName, currentShift, currentDate, timerState);\r\n    }, 30000); // Every 30 seconds\r\n\r\n    return () => clearInterval(autoSaveInterval);\r\n  }, [productionState.isRunning, productionState.lastResumedAt, productionState.totalRunTimeMs, isSessionLocked, machineName]);\r\n\r\n  // Cleanup session lock and save timer on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      const currentDate = new Date().toISOString().split('T')[0];\r\n      const currentShift = getCurrentShift();\r\n\r\n      // Save timer state before leaving (use ref to get current state)\r\n      const state = productionStateRef.current;\r\n      if (state.isRunning || state.totalRunTimeMs > 0) {\r\n        const timerState: ProductionTimerState = {\r\n          isRunning: state.isRunning,\r\n          startTime: state.startTime?.toISOString() || null,\r\n          pausedAt: state.pausedAt?.toISOString() || null,\r\n          totalRunTimeMs: state.totalRunTimeMs,\r\n          lastResumedAt: state.lastResumedAt?.toISOString() || null,\r\n          pauseHistory: [],\r\n        };\r\n        saveProductionTimer(machineName, currentShift, currentDate, timerState);\r\n      }\r\n\r\n      // Release session lock when leaving the page\r\n      releaseSessionLock(machineName, currentShift, currentDate);\r\n\r\n      // Unsubscribe from conflict notifications\r\n      if (unsubscribeConflictRef.current) {\r\n        unsubscribeConflictRef.current();\r\n      }\r\n    };\r\n  }, [machineName]);\r\n\r\n  // Load available orders from machine queue\r\n  useEffect(() => {\r\n    const loadMachineOrders = async () => {\r\n      if (!parentMachineId) return;\r\n      try {\r\n        // Use parentMachineId for sub-machines (orders are stored against parent machine group)\r\n        const orders = await fetchMachineOrders(parentMachineId);\r\n        setAvailableOrders(orders);\r\n      } catch (e) {\r\n        console.error('Failed to load machine orders:', e);\r\n      }\r\n    };\r\n    loadMachineOrders();\r\n  }, [parentMachineId]);\r\n\r\n  // Auto-save entries when they change (if session is locked)\r\n  useEffect(() => {\r\n    if (isSessionLocked && operatorName && orderNumber && product && batchNumber) {\r\n      const currentDate = new Date().toISOString().split('T')[0];\r\n      const currentShift = getCurrentShift();\r\n      const sessionKey = getSessionKey(machineName, currentShift, currentDate);\r\n\r\n      const session: ShiftSession = {\r\n        machineName,\r\n        operatorName,\r\n        orderNumber,\r\n        product,\r\n        batchNumber,\r\n        shift: currentShift,\r\n        date: currentDate,\r\n        locked: true,\r\n        wasteEntries,\r\n        downtimeEntries,\r\n        speedEntries,\r\n        sachetMassEntries,\r\n        looseCasesEntries,\r\n        palletScanEntries,\r\n      };\r\n\r\n      localStorage.setItem(sessionKey, JSON.stringify(session));\r\n    }\r\n  }, [wasteEntries, downtimeEntries, speedEntries, sachetMassEntries, looseCasesEntries, palletScanEntries, isSessionLocked, machineName, operatorName, orderNumber, product, batchNumber]);\r\n\r\n  useEffect(() => {\r\n    const timer = setInterval(() => {\r\n      const now = new Date();\r\n      setDateTime(now);\r\n      checkSubmissionWindowCallback(now);\r\n    }, 1000);\r\n\r\n    // Set the shift using facility settings\r\n    const newShift = getCurrentShift();\r\n\r\n    // Detect shift change\r\n    if (lastKnownShift !== null && lastKnownShift !== newShift && isSessionLocked) {\r\n      // Shift has changed while session is active - prompt for new operator\r\n      setShowShiftChangeModal(true);\r\n    }\r\n\r\n    setShift(newShift);\r\n    setLastKnownShift(newShift);\r\n\r\n    return () => clearInterval(timer);\r\n  }, [dateTime, checkSubmissionWindow, lastKnownShift, isSessionLocked]);\r\n\r\n  // Production Timer - Update display every second when running\r\n  useEffect(() => {\r\n    if (!productionState.isRunning || !productionState.lastResumedAt) return;\r\n\r\n    const timerInterval = setInterval(() => {\r\n      const now = Date.now();\r\n      const currentSessionMs = now - productionState.lastResumedAt!.getTime();\r\n      const totalMs = productionState.totalRunTimeMs + currentSessionMs;\r\n\r\n      // Format as HH:MM:SS\r\n      const totalSeconds = Math.floor(totalMs / 1000);\r\n      const hours = Math.floor(totalSeconds / 3600);\r\n      const minutes = Math.floor((totalSeconds % 3600) / 60);\r\n      const seconds = totalSeconds % 60;\r\n      setDisplayRunTime(\r\n        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`\r\n      );\r\n    }, 1000);\r\n\r\n    return () => clearInterval(timerInterval);\r\n  }, [productionState.isRunning, productionState.lastResumedAt, productionState.totalRunTimeMs]);\r\n\r\n  // Sync entry totals to Supabase when waste or downtime entries change\r\n  useEffect(() => {\r\n    if (!isSessionLocked) return;\r\n\r\n    const currentDate = new Date().toISOString().split('T')[0];\r\n    const currentShift = getCurrentShift();\r\n\r\n    // Calculate totals\r\n    const totalWaste = wasteEntries.reduce((sum, e) => sum + e.waste, 0);\r\n    const totalDowntime = downtimeEntries.reduce((sum, e) => sum + e.downtime, 0);\r\n\r\n    // Sync to Supabase\r\n    upsertLiveSession({\r\n      machineName,\r\n      operatorName,\r\n      orderNumber,\r\n      product,\r\n      batchNumber,\r\n      shift: currentShift,\r\n      date: currentDate,\r\n      locked: true,\r\n      totalWaste,\r\n      totalDowntime,\r\n    });\r\n\r\n    console.log(' Synced entry totals to Supabase:', { totalWaste, totalDowntime });\r\n  }, [wasteEntries, downtimeEntries, isSessionLocked, machineName, operatorName, orderNumber, product, batchNumber]);\r\n\r\n  // Helper to persist timer state\r\n  const persistTimerState = useCallback((state: ProductionState) => {\r\n    const currentDate = new Date().toISOString().split('T')[0];\r\n    const currentShift = getCurrentShift();\r\n    const timerState: ProductionTimerState = {\r\n      isRunning: state.isRunning,\r\n      startTime: state.startTime?.toISOString() || null,\r\n      pausedAt: state.pausedAt?.toISOString() || null,\r\n      totalRunTimeMs: state.totalRunTimeMs,\r\n      lastResumedAt: state.lastResumedAt?.toISOString() || null,\r\n      pauseHistory: [],\r\n    };\r\n    saveProductionTimer(machineName, currentShift, currentDate, timerState);\r\n  }, [machineName]);\r\n\r\n  // Start production timer (called when session is locked)\r\n  const handleStartProduction = useCallback(() => {\r\n    const now = new Date();\r\n    const newState: ProductionState = {\r\n      isRunning: true,\r\n      startTime: now,\r\n      pausedAt: null,\r\n      totalRunTimeMs: 0,\r\n      lastResumedAt: now,\r\n    };\r\n    setProductionState(newState);\r\n    setDisplayRunTime('00:00:00');\r\n    persistTimerState(newState);\r\n\r\n    // Add activity event\r\n    addActivityEvent({\r\n      type: 'machine_start',\r\n      machine_name: machineName,\r\n      operator_name: operatorName,\r\n      message: 'Production started',\r\n      details: `Order: ${orderNumber} | Product: ${product}`,\r\n    });\r\n  }, [persistTimerState, machineName, operatorName, orderNumber, product]);\r\n\r\n  // Pause production - record pause start time\r\n  const handlePauseProduction = useCallback(() => {\r\n    if (!productionState.isRunning) return;\r\n\r\n    const now = new Date();\r\n    // Calculate run time accumulated so far\r\n    const currentSessionMs = productionState.lastResumedAt\r\n      ? now.getTime() - productionState.lastResumedAt.getTime()\r\n      : 0;\r\n\r\n    const newState: ProductionState = {\r\n      ...productionState,\r\n      isRunning: false,\r\n      pausedAt: now,\r\n      totalRunTimeMs: productionState.totalRunTimeMs + currentSessionMs,\r\n    };\r\n    setProductionState(newState);\r\n    persistTimerState(newState);\r\n    showToast('Production paused - timer stopped', 'success');\r\n\r\n    // Add activity event\r\n    addActivityEvent({\r\n      type: 'machine_pause',\r\n      machine_name: machineName,\r\n      operator_name: operatorName,\r\n      message: 'Production paused',\r\n    });\r\n  }, [productionState, persistTimerState, showToast, machineName, operatorName]);\r\n\r\n  // Continue production - show modal to get reason, then record downtime\r\n  const handleContinueProduction = useCallback(() => {\r\n    if (!pauseDowntimeReason) {\r\n      showToast('Please select a downtime reason', 'error');\r\n      return;\r\n    }\r\n\r\n    if (!productionState.pausedAt) return;\r\n\r\n    const now = new Date();\r\n    const pauseDurationMs = now.getTime() - productionState.pausedAt.getTime();\r\n    const pauseDurationMinutes = Math.ceil(pauseDurationMs / 60000); // Round up to nearest minute\r\n\r\n    // Create downtime entry automatically\r\n    const newDowntimeEntry: DowntimeEntry = {\r\n      id: uuidv4(),\r\n      downtime: pauseDurationMinutes,\r\n      downtimeReason: pauseDowntimeReason,\r\n      notes: 'Auto-recorded from production pause',\r\n      timestamp: productionState.pausedAt,\r\n    };\r\n    setDowntimeEntries(prev => [...prev, newDowntimeEntry]);\r\n\r\n    // Resume production\r\n    const newState: ProductionState = {\r\n      ...productionState,\r\n      isRunning: true,\r\n      pausedAt: null,\r\n      lastResumedAt: now,\r\n    };\r\n    setProductionState(newState);\r\n    persistTimerState(newState);\r\n\r\n    // Reset modal state\r\n    setShowContinueModal(false);\r\n    setPauseDowntimeReason('');\r\n    showToast(`Production resumed. ${pauseDurationMinutes} min downtime recorded.`, 'success');\r\n\r\n    // Add activity events\r\n    addActivityEvent({\r\n      type: 'machine_resume',\r\n      machine_name: machineName,\r\n      operator_name: operatorName,\r\n      message: 'Production resumed',\r\n      details: `Reason: ${pauseDowntimeReason}`,\r\n    });\r\n    addActivityEvent({\r\n      type: 'downtime_recorded',\r\n      machine_name: machineName,\r\n      operator_name: operatorName,\r\n      message: `Downtime recorded: ${pauseDurationMinutes} min`,\r\n      details: pauseDowntimeReason,\r\n    });\r\n  }, [pauseDowntimeReason, productionState, persistTimerState, showToast, machineName, operatorName]);\r\n\r\n  // Handle Waste Entry from Modal\r\n  const handleWasteSubmit = () => {\r\n    if (waste && wasteType) {\r\n      const newEntry: WasteEntry = {\r\n        id: uuidv4(),\r\n        waste: Number(waste),\r\n        wasteType,\r\n        timestamp: new Date()\r\n      };\r\n      setWasteEntries([...wasteEntries, newEntry]);\r\n      setWaste('');\r\n      setWasteType('');\r\n      setShowWasteModal(false);\r\n      showToast('Waste entry added', 'success');\r\n\r\n      // Add activity event\r\n      addActivityEvent({\r\n        type: 'waste_recorded',\r\n        machine_name: machineName,\r\n        operator_name: operatorName,\r\n        message: `Waste recorded: ${Number(waste).toFixed(1)} kg`,\r\n        details: wasteType,\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDeleteWasteEntry = (id: string) => {\r\n    setWasteEntries(wasteEntries.filter(entry => entry.id !== id));\r\n    showToast('Entry removed', 'success');\r\n  };\r\n\r\n  const handleDeleteDowntimeEntry = (id: string) => {\r\n    setDowntimeEntries(downtimeEntries.filter(entry => entry.id !== id));\r\n    showToast('Entry removed', 'success');\r\n  };\r\n\r\n  // Handle Downtime Entry from Modal\r\n  const handleDowntimeSubmit = () => {\r\n    if (downtime && downtimeReason) {\r\n      const newEntry: DowntimeEntry = {\r\n        id: uuidv4(),\r\n        downtime: Number(downtime),\r\n        downtimeReason,\r\n        notes: undefined,\r\n        timestamp: new Date()\r\n      };\r\n      setDowntimeEntries([...downtimeEntries, newEntry]);\r\n      setDowntime('');\r\n      setDowntimeReason('');\r\n      setShowDowntimeModal(false);\r\n      showToast('Downtime entry added', 'success');\r\n\r\n      // Add activity event\r\n      addActivityEvent({\r\n        type: 'downtime_recorded',\r\n        machine_name: machineName,\r\n        operator_name: operatorName,\r\n        message: `Downtime recorded: ${Number(downtime)} min`,\r\n        details: downtimeReason,\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleSubmitClick = (e: React.MouseEvent<HTMLButtonElement>) => {\r\n    e.preventDefault();\r\n\r\n    // Validation\r\n    if (!operatorName || !orderNumber || !product || !batchNumber) {\r\n      showToast('Please fill in all shift details', 'error');\r\n      return;\r\n    }\r\n\r\n    if (wasteEntries.length === 0 && downtimeEntries.length === 0) {\r\n      showToast('Please add at least one waste or downtime entry', 'error');\r\n      return;\r\n    }\r\n\r\n    // If outside submission window, show changeover dialog first\r\n    if (!isInSubmissionWindow) {\r\n      setWillChangeover(null);\r\n      setWillMaintenance(null);\r\n      setShowChangeoverDialog(true);\r\n    } else {\r\n      // Within window, go directly to confirmation\r\n      setShowConfirmDialog(true);\r\n    }\r\n  };\r\n\r\n  const handleChangeoverConfirm = () => {\r\n    if (willChangeover === null || willMaintenance === null) {\r\n      showToast('Please answer both questions', 'error');\r\n      return;\r\n    }\r\n    setShowChangeoverDialog(false);\r\n    setShowConfirmDialog(true);\r\n  };\r\n\r\n  // Handle shift change confirmation - update operator for new shift\r\n  const handleShiftChangeConfirm = () => {\r\n    if (!newOperatorName.trim()) {\r\n      showToast('Please enter the new operator name/number', 'error');\r\n      return;\r\n    }\r\n\r\n    // Update the operator name for the new shift\r\n    setOperatorName(newOperatorName.trim());\r\n    setShowShiftChangeModal(false);\r\n    setNewOperatorName('');\r\n\r\n    // Update machine status with new operator\r\n    if (machineId) {\r\n      updateMachineStatus(machineId, 'running', newOperatorName.trim(), orderNumber, shift);\r\n    }\r\n\r\n    // Update the session with new operator\r\n    const currentDate = new Date().toISOString().split('T')[0];\r\n    const sessionKey = getSessionKey(machineName, shift, currentDate);\r\n\r\n    const session: ShiftSession = {\r\n      machineName,\r\n      operatorName: newOperatorName.trim(),\r\n      orderNumber,\r\n      product,\r\n      batchNumber,\r\n      shift,\r\n      date: currentDate,\r\n      locked: true,\r\n      wasteEntries,\r\n      downtimeEntries,\r\n      speedEntries,\r\n      sachetMassEntries,\r\n      looseCasesEntries,\r\n      palletScanEntries,\r\n    };\r\n\r\n    localStorage.setItem(sessionKey, JSON.stringify(session));\r\n    showToast(`Operator changed to ${newOperatorName.trim()} for ${shift} shift`, 'success');\r\n  };\r\n\r\n  const handleConfirmedSubmit = async () => {\r\n    setShowConfirmDialog(false);\r\n    setIsSubmitting(true);\r\n\r\n    // Calculate totals\r\n    const totalWaste = wasteEntries.reduce((sum, e) => sum + e.waste, 0);\r\n    const totalDowntime = downtimeEntries.reduce((sum, e) => sum + e.downtime, 0);\r\n\r\n    // Create shift data object\r\n    const shiftData: ShiftData = {\r\n      id: uuidv4(),\r\n      operatorName,\r\n      machine: machineName,\r\n      orderNumber,\r\n      product,\r\n      batchNumber,\r\n      shift,\r\n      date: dateTime.toISOString().split('T')[0],\r\n      wasteEntries,\r\n      downtimeEntries,\r\n      speedEntries,\r\n      sachetMassEntries,\r\n      looseCasesEntries,\r\n      palletScanEntries,\r\n      totalWaste,\r\n      totalDowntime,\r\n      submittedAt: new Date()\r\n    };\r\n\r\n    // Prepare submission data for potential retry queue\r\n    const submissionPayload = {\r\n      shiftData: {\r\n        operator_name: operatorName,\r\n        machine: machineName,\r\n        order_number: orderNumber,\r\n        product,\r\n        batch_number: batchNumber,\r\n        shift,\r\n        submission_date: dateTime.toISOString().split('T')[0],\r\n        is_early_submission: !isInSubmissionWindow,\r\n        will_changeover: willChangeover ?? undefined,\r\n        will_maintenance_cleaning: willMaintenance ?? undefined,\r\n      },\r\n      wasteEntries: wasteEntries.map(e => ({ waste: e.waste, wasteType: e.wasteType, timestamp: e.timestamp })),\r\n      downtimeEntries: downtimeEntries.map(e => ({ downtime: e.downtime, downtimeReason: e.downtimeReason, timestamp: e.timestamp })),\r\n      speedEntries: speedEntries.map(e => ({ speed: e.speed, timestamp: e.timestamp })),\r\n      sachetMassEntries: sachetMassEntries.map(e => ({ mass: e.mass, timestamp: e.timestamp })),\r\n      looseCasesEntries: looseCasesEntries.map(e => ({ batchNumber: e.batchNumber, cases: e.cases, timestamp: e.timestamp })),\r\n      palletScanEntries: palletScanEntries.map(e => ({ qrCode: e.qrCode, batchNumber: e.batchNumber, palletNumber: e.palletNumber, casesCount: e.casesCount, timestamp: e.timestamp })),\r\n    };\r\n\r\n    try {\r\n      // Save to local storage first\r\n      saveShiftData(shiftData);\r\n\r\n      // Try to submit to Supabase with all data including changeover info\r\n      const result = await submitShiftData(\r\n        submissionPayload.shiftData,\r\n        submissionPayload.wasteEntries,\r\n        submissionPayload.downtimeEntries,\r\n        submissionPayload.speedEntries,\r\n        submissionPayload.sachetMassEntries,\r\n        submissionPayload.looseCasesEntries,\r\n        submissionPayload.palletScanEntries\r\n      );\r\n\r\n      // Show success with any warnings\r\n      if (result.warnings.length > 0) {\r\n        showToast(`Submitted with warnings: ${result.warnings.join(', ')}`, 'success');\r\n      } else {\r\n        showToast('Shift data submitted successfully', 'success');\r\n      }\r\n\r\n      // Add activity event for shift submission\r\n      addActivityEvent({\r\n        type: 'shift_submitted',\r\n        machine_name: machineName,\r\n        operator_name: operatorName,\r\n        message: 'Shift submitted',\r\n        details: `Order: ${orderNumber} | Waste: ${shiftData.totalWaste.toFixed(1)}kg | Downtime: ${shiftData.totalDowntime}min`,\r\n      });\r\n\r\n      // Reset form for new submission\r\n      // Unlock shift details\r\n      setIsSessionLocked(false);\r\n\r\n      // Update machine status to 'idle' since order is complete\r\n      if (machineId) {\r\n        updateMachineStatus(machineId, 'idle');\r\n      }\r\n\r\n      // Clear all entries\r\n      setWasteEntries([]);\r\n      setDowntimeEntries([]);\r\n      setSpeedEntries([]);\r\n      setSachetMassEntries([]);\r\n      setLooseCasesEntries([]);\r\n      setPalletScanEntries([]);\r\n\r\n      // Reset changeover state\r\n      setWillChangeover(null);\r\n      setWillMaintenance(false);\r\n\r\n      // Clear session storage so new details can be entered\r\n      sessionStorage.removeItem(`session_${machineId}`);\r\n\r\n      // Clear the localStorage session key as well\r\n      const currentDate = new Date().toISOString().split('T')[0];\r\n      const sessionKey = getSessionKey(machineName, shift, currentDate);\r\n      localStorage.removeItem(sessionKey);\r\n\r\n      // Delete from Supabase live_sessions so other browsers see it as available\r\n      deleteLiveSession(machineName, shift, currentDate);\r\n\r\n      // Keep operator name but clear order-specific fields for new order\r\n      setOrderNumber('');\r\n      setProduct('');\r\n      setBatchNumber('');\r\n\r\n    } catch (error) {\r\n      console.error('Submission error:', error);\r\n\r\n      // Add to failed submissions queue for retry\r\n      addFailedSubmission(submissionPayload, String(error));\r\n\r\n      // Still saved locally, show partial success with retry info\r\n      showToast('Saved locally. Will retry sync automatically.', 'error');\r\n\r\n      // Clear form since data is saved locally\r\n      setIsSessionLocked(false);\r\n\r\n      // Update machine status to 'idle' since order is \"complete\" (saved locally)\r\n      if (machineId) {\r\n        updateMachineStatus(machineId, 'idle');\r\n      }\r\n\r\n      // Clear the localStorage session key\r\n      const currentDate = new Date().toISOString().split('T')[0];\r\n      const sessionKey = getSessionKey(machineName, shift, currentDate);\r\n      localStorage.removeItem(sessionKey);\r\n\r\n      // Also delete from Supabase live_sessions\r\n      deleteLiveSession(machineName, shift, currentDate);\r\n\r\n      setWasteEntries([]);\r\n      setDowntimeEntries([]);\r\n      setSpeedEntries([]);\r\n      setSachetMassEntries([]);\r\n      setLooseCasesEntries([]);\r\n      setPalletScanEntries([]);\r\n      setWillChangeover(null);\r\n      setWillMaintenance(false);\r\n      setOrderNumber('');\r\n      setProduct('');\r\n      setBatchNumber('');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleBack = () => {\r\n    // Only warn if session is NOT locked (entries won't be auto-saved)\r\n    const hasEntries = wasteEntries.length > 0 || downtimeEntries.length > 0 ||\r\n      speedEntries.length > 0 || sachetMassEntries.length > 0 ||\r\n      looseCasesEntries.length > 0 || palletScanEntries.length > 0;\r\n\r\n    if (hasEntries && !isSessionLocked) {\r\n      if (window.confirm('You have entries that are not saved to a session. Are you sure you want to go back? Lock your shift details first to save entries.')) {\r\n        navigate('/');\r\n      }\r\n    } else {\r\n      // Session is locked = entries are auto-saved, safe to go back\r\n      navigate('/');\r\n    }\r\n  };\r\n\r\n  // Handle Speed Entry\r\n  const handleSpeedSubmit = () => {\r\n    if (speedInput && speedInput > 0) {\r\n      const newEntry: SpeedEntry = {\r\n        id: uuidv4(),\r\n        speed: Number(speedInput),\r\n        timestamp: new Date()\r\n      };\r\n      setSpeedEntries([...speedEntries, newEntry]);\r\n      setSpeedInput('');\r\n      setShowSpeedModal(false);\r\n      showToast('Machine speed recorded', 'success');\r\n\r\n      // Save to shared line storage so other machines can see it\r\n      const currentDate = new Date().toISOString().split('T')[0];\r\n      const shift = getCurrentShift();\r\n      saveLineSpeed(machineName, shift, currentDate, Number(speedInput));\r\n\r\n      // Add activity event\r\n      addActivityEvent({\r\n        type: 'speed_recorded',\r\n        machine_name: machineName,\r\n        operator_name: operatorName,\r\n        message: `Speed recorded: ${Number(speedInput)} units/hr`,\r\n      });\r\n    }\r\n  };\r\n\r\n  // Speed entry deletion (available for future UI enhancement)\r\n  const _handleDeleteSpeedEntry = (id: string) => {\r\n    setSpeedEntries(speedEntries.filter(entry => entry.id !== id));\r\n    showToast('Speed entry removed', 'success');\r\n  };\r\n  // Suppress unused variable warning\r\n  void _handleDeleteSpeedEntry;\r\n\r\n  // Handle Sachet Mass Entry\r\n  const handleSachetMassSubmit = () => {\r\n    if (sachetMassInput && sachetMassInput > 0) {\r\n      const newEntry: SachetMassEntry = {\r\n        id: uuidv4(),\r\n        mass: Number(sachetMassInput),\r\n        timestamp: new Date()\r\n      };\r\n      setSachetMassEntries([...sachetMassEntries, newEntry]);\r\n      setSachetMassInput('');\r\n      setShowSachetModal(false);\r\n      showToast('Sachet mass recorded', 'success');\r\n\r\n      // Add activity event\r\n      addActivityEvent({\r\n        type: 'sachet_mass_added',\r\n        machine_name: machineName,\r\n        operator_name: operatorName,\r\n        message: `Sachet mass recorded: ${Number(sachetMassInput)}g`,\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleToggleSachetIgnore = (id: string) => {\r\n    setSachetMassEntries(sachetMassEntries.map(entry =>\r\n      entry.id === id ? { ...entry, ignored: !entry.ignored } : entry\r\n    ));\r\n  };\r\n\r\n  // Handle Loose Cases Entry (cases not part of a full pallet)\r\n  const handleLooseCasesSubmit = () => {\r\n    if (looseCasesBatchInput && looseCasesBatchInput.length === 5 && looseCasesQuantityInput && looseCasesQuantityInput > 0) {\r\n      const newEntry: LooseCasesEntry = {\r\n        id: uuidv4(),\r\n        batchNumber: looseCasesBatchInput,\r\n        cases: Number(looseCasesQuantityInput),\r\n        timestamp: new Date()\r\n      };\r\n      setLooseCasesEntries([...looseCasesEntries, newEntry]);\r\n      setLooseCasesBatchInput('');\r\n      setLooseCasesQuantityInput('');\r\n      setShowLooseCasesModal(false);\r\n      showToast('Loose cases recorded', 'success');\r\n\r\n      // Add activity event\r\n      addActivityEvent({\r\n        type: 'cases_added',\r\n        machine_name: machineName,\r\n        operator_name: operatorName,\r\n        message: `Loose cases added: ${Number(looseCasesQuantityInput)} cases`,\r\n        details: `Batch: ${looseCasesBatchInput}`,\r\n      });\r\n    } else if (looseCasesBatchInput.length !== 5) {\r\n      showToast('Batch number must be 5 digits', 'error');\r\n    }\r\n  };\r\n\r\n  const handleToggleLooseCasesIgnore = (id: string) => {\r\n    setLooseCasesEntries(looseCasesEntries.map(entry =>\r\n      entry.id === id ? { ...entry, ignored: !entry.ignored } : entry\r\n    ));\r\n  };\r\n\r\n  // Parse 13-digit QR code: BBBBBPPPPCCCC\r\n  // B = batch (5 digits), P = pallet number (4 digits), C = cases count (4 digits)\r\n  const parsePalletQRCode = (qrData: string): { batchNumber: string; palletNumber: string; casesCount: number } | null => {\r\n    // Remove any whitespace\r\n    const cleaned = qrData.trim();\r\n\r\n    // Check if it's exactly 13 digits\r\n    if (!/^\\d{13}$/.test(cleaned)) {\r\n      return null;\r\n    }\r\n\r\n    const casesCount = parseInt(cleaned.substring(9, 13), 10);\r\n\r\n    // Extra safety check for NaN (shouldn't happen given regex validation)\r\n    if (Number.isNaN(casesCount)) {\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      batchNumber: cleaned.substring(0, 5),    // First 5 digits\r\n      palletNumber: cleaned.substring(5, 9),   // Next 4 digits\r\n      casesCount\r\n    };\r\n  };\r\n\r\n  // Handle QR Code Pallet Scan\r\n  const handlePalletScan = (qrData: string) => {\r\n    const parsed = parsePalletQRCode(qrData);\r\n\r\n    if (!parsed) {\r\n      showToast('Invalid QR code format. Expected 13 digits: BBBBBPPPPCCCC', 'error');\r\n      return;\r\n    }\r\n\r\n    // Check for duplicate pallet scan (same QR code already scanned)\r\n    const isDuplicate = palletScanEntries.some(entry => entry.qrCode === qrData);\r\n    if (isDuplicate) {\r\n      showToast(`Pallet ${parsed.palletNumber} has already been scanned!`, 'error');\r\n      return;\r\n    }\r\n\r\n    const newEntry: PalletScanEntry = {\r\n      id: uuidv4(),\r\n      qrCode: qrData,\r\n      batchNumber: parsed.batchNumber,\r\n      palletNumber: parsed.palletNumber,\r\n      casesCount: parsed.casesCount,\r\n      timestamp: new Date()\r\n    };\r\n    setPalletScanEntries([...palletScanEntries, newEntry]);\r\n    showToast(`Pallet ${parsed.palletNumber} scanned (${parsed.casesCount} cases)`, 'success');\r\n\r\n    // Add activity event\r\n    addActivityEvent({\r\n      type: 'pallet_scanned',\r\n      machine_name: machineName,\r\n      operator_name: operatorName,\r\n      message: `Pallet scanned: ${parsed.casesCount} cases`,\r\n      details: `Pallet #${parsed.palletNumber} | Batch: ${parsed.batchNumber}`,\r\n    });\r\n  };\r\n\r\n  const handleTogglePalletIgnore = (id: string) => {\r\n    setPalletScanEntries(palletScanEntries.map(entry =>\r\n      entry.id === id ? { ...entry, ignored: !entry.ignored } : entry\r\n    ));\r\n  };\r\n\r\n  // Format timestamp for pallet scans\r\n  const formatScanTime = (timestamp: Date) => {\r\n    const date = new Date(timestamp);\r\n    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n  };\r\n\r\n  // Calculate totals for preview\r\n  const totalWaste = wasteEntries.reduce((sum, e) => sum + e.waste, 0);\r\n  const totalDowntime = downtimeEntries.reduce((sum, e) => sum + e.downtime, 0);\r\n\r\n  return (\r\n    <motion.div\r\n      className=\"capture-screen-v2 no-scroll-layout\"\r\n      initial={{ opacity: 0, x: 20 }}\r\n      animate={{ opacity: 1, x: 0 }}\r\n      exit={{ opacity: 0, x: -20 }}\r\n    >\r\n      {/* Loading Overlay */}\r\n      {isSubmitting && (\r\n        <div className=\"spinner-overlay-v2\">\r\n          <div className=\"spinner-v2\"></div>\r\n          <p>Submitting shift data...</p>\r\n        </div>\r\n      )}\r\n\r\n      {/* Toast Notification */}\r\n      {toast && (\r\n        <motion.div\r\n          className=\"toast-container-v2\"\r\n          initial={{ opacity: 0, y: -20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          exit={{ opacity: 0, y: -20 }}\r\n        >\r\n          <div className={`toast-message-v2 ${toast.type}`}>\r\n            <span className=\"toast-icon\">{toast.type === 'success' ? '' : '!'}</span>\r\n            {toast.message}\r\n          </div>\r\n        </motion.div>\r\n      )}\r\n\r\n      {/* Header */}\r\n      <header className=\"capture-header-v2\">\r\n        <button className=\"back-btn-v2\" onClick={handleBack}>\r\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n            <path d=\"M19 12H5M12 19l-7-7 7-7\" />\r\n          </svg>\r\n          Back\r\n        </button>\r\n        <div className=\"capture-title-v2\">\r\n          <h1>{machineName}</h1>\r\n          <span className=\"capture-subtitle\">Recording Waste & Downtime</span>\r\n        </div>\r\n        <div className={`shift-badge-v2 ${shift.toLowerCase()}`}>\r\n          <span className=\"shift-icon\">{shift === 'Day' ? '' : ''}</span>\r\n          {shift} Shift\r\n        </div>\r\n      </header>\r\n\r\n      <main className=\"capture-main\">\r\n        {/* Left Column - Form */}\r\n        <div className=\"capture-form-column\">\r\n          <section className={`form-section ${isSessionLocked ? 'collapsed' : ''}`}>\r\n            <h2 className=\"section-heading\">\r\n              Shift Details\r\n              {isSessionLocked && <span className=\"locked-badge\"> Locked</span>}\r\n            </h2>\r\n\r\n            {/* Compact Badge View - shown when session is locked */}\r\n            {isSessionLocked && (\r\n              <div className=\"shift-details-compact\">\r\n                <div className=\"shift-detail-badge\">\r\n                  <span className=\"badge-icon\"></span>\r\n                  <span className=\"badge-value\">{operatorName}</span>\r\n                </div>\r\n                <div className=\"shift-detail-badge\">\r\n                  <span className=\"badge-icon\"></span>\r\n                  <span className=\"badge-value\">{orderNumber}</span>\r\n                </div>\r\n                <div className=\"shift-detail-badge\">\r\n                  <span className=\"badge-icon\"></span>\r\n                  <span className=\"badge-value\">{product}</span>\r\n                </div>\r\n                <div className=\"shift-detail-badge\">\r\n                  <span className=\"badge-icon\"></span>\r\n                  <span className=\"badge-value\">\r\n                    {speedEntries.length > 0 ? `${speedEntries[speedEntries.length - 1].speed} PPM` : '--'}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Order Queue Selection */}\r\n            {!isSessionLocked && (\r\n              <div className=\"order-queue-select\">\r\n                <div className=\"order-buttons-row\">\r\n                  <button\r\n                    className=\"select-order-btn add-new\"\r\n                    onClick={() => setShowAddOrderModal(true)}\r\n                  >\r\n                    <span className=\"btn-icon\">+</span>\r\n                    Add New Order\r\n                  </button>\r\n                  <button\r\n                    className=\"select-order-btn existing\"\r\n                    onClick={() => setShowOrderSelect(true)}\r\n                    disabled={availableOrders.length === 0}\r\n                  >\r\n                    <span className=\"btn-icon\"></span>\r\n                    Select Existing{availableOrders.length > 0 ? ` (${availableOrders.length})` : ''}\r\n                  </button>\r\n                </div>\r\n                {orderNumber && (\r\n                  <span className=\"current-order-badge\">\r\n                    Current: {orderNumber}\r\n                  </span>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"form-grid\">\r\n              <MainForm\r\n                operatorName={operatorName}\r\n                setOperatorName={isSessionLocked ? () => { } : setOperatorName}\r\n                machine={machineName}\r\n                setMachine={() => { }}\r\n                orderNumber={orderNumber}\r\n                setOrderNumber={isSessionLocked ? () => { } : setOrderNumber}\r\n                product={product}\r\n                setProduct={isSessionLocked ? () => { } : setProduct}\r\n                batchNumber={batchNumber}\r\n                setBatchNumber={isSessionLocked ? () => { } : setBatchNumber}\r\n                hideMachine={true}\r\n                disabled={isSessionLocked}\r\n              />\r\n              <ShiftInfo dateTime={dateTime} shift={shift} />\r\n            </div>\r\n\r\n            {/* Machine Speed in Shift Details */}\r\n            <div className=\"speed-setting\">\r\n              <div className=\"speed-display\">\r\n                <span className=\"speed-label\"> Machine Speed</span>\r\n                <span className=\"speed-value\">\r\n                  {speedEntries.length > 0\r\n                    ? `${speedEntries[speedEntries.length - 1].speed} PPM`\r\n                    : 'Not Set'}\r\n                </span>\r\n                {speedEntries.length > 1 && (\r\n                  <span className=\"speed-history-count\" title=\"Speed change history\">\r\n                    ({speedEntries.length} changes)\r\n                  </span>\r\n                )}\r\n              </div>\r\n              <button\r\n                className=\"speed-change-btn\"\r\n                onClick={() => setShowSpeedModal(true)}\r\n              >\r\n                {speedEntries.length > 0 ? 'Change' : 'Set Speed'}\r\n              </button>\r\n            </div>\r\n\r\n            {!isSessionLocked && operatorName && orderNumber && product && batchNumber && (\r\n              speedEntries.length > 0 ? (\r\n                <button\r\n                  className=\"lock-session-btn\"\r\n                  onClick={() => {\r\n                    saveSession(true);\r\n                    handleStartProduction();\r\n                  }}\r\n                >\r\n                   Lock Shift Details & Start Production\r\n                </button>\r\n              ) : (\r\n                <button\r\n                  className=\"lock-session-btn disabled\"\r\n                  onClick={() => setShowSpeedModal(true)}\r\n                  title=\"Set machine speed to continue\"\r\n                >\r\n                   Set Machine Speed to Start\r\n                </button>\r\n              )\r\n            )}\r\n          </section>\r\n\r\n          {/* Machine Details Section - Production Timer */}\r\n          {isSessionLocked && (\r\n            <section className=\"form-section machine-details-section\">\r\n              <h2 className=\"section-heading\">\r\n                <span className=\"section-icon\"></span>\r\n                Machine Details\r\n                <span className={`production-status-badge ${productionState.isRunning ? 'running' : 'paused'}`}>\r\n                  {productionState.isRunning ? ' Running' : ' Paused'}\r\n                </span>\r\n              </h2>\r\n\r\n              <div className=\"machine-details-grid\">\r\n                {/* Production Start Time */}\r\n                <div className=\"detail-card\">\r\n                  <span className=\"detail-label\">Production Started</span>\r\n                  <span className=\"detail-value\">\r\n                    {productionState.startTime\r\n                      ? productionState.startTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })\r\n                      : '--:--'}\r\n                  </span>\r\n                </div>\r\n\r\n                {/* Run Time Timer */}\r\n                <div className=\"detail-card timer-card\">\r\n                  <span className=\"detail-label\">Run Time</span>\r\n                  <span className=\"detail-value timer-value\">{displayRunTime}</span>\r\n                </div>\r\n\r\n                {/* Pause/Continue Button */}\r\n                <div className=\"detail-card action-card\">\r\n                  {productionState.isRunning ? (\r\n                    <button\r\n                      className=\"pause-continue-btn pause\"\r\n                      onClick={handlePauseProduction}\r\n                    >\r\n                      <span className=\"btn-icon\"></span>\r\n                      Pause Production\r\n                    </button>\r\n                  ) : (\r\n                    <button\r\n                      className=\"pause-continue-btn continue\"\r\n                      onClick={() => setShowContinueModal(true)}\r\n                    >\r\n                      <span className=\"btn-icon\"></span>\r\n                      Continue Production\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Pause Duration Display */}\r\n              {productionState.pausedAt && (\r\n                <div className=\"pause-duration-display\">\r\n                  <span className=\"pause-icon\"></span>\r\n                  Paused since {productionState.pausedAt.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                </div>\r\n              )}\r\n            </section>\r\n          )}\r\n\r\n          {/* Recording Tabs - Compact Layout */}\r\n          <div className=\"recording-tabs-container\">\r\n            <div className=\"recording-tabs\">\r\n              <button\r\n                className={`recording-tab ${activeRecordTab === 'waste' ? 'active' : ''} ${wasteEntries.length > 0 ? 'has-entries' : ''}`}\r\n                onClick={() => setActiveRecordTab('waste')}\r\n              >\r\n                <span className=\"tab-icon\"></span>\r\n                <span className=\"tab-label\">Waste</span>\r\n                {wasteEntries.length > 0 && <span className=\"tab-badge\">{wasteEntries.length}</span>}\r\n              </button>\r\n              <button\r\n                className={`recording-tab ${activeRecordTab === 'downtime' ? 'active' : ''} ${downtimeEntries.length > 0 ? 'has-entries' : ''}`}\r\n                onClick={() => setActiveRecordTab('downtime')}\r\n              >\r\n                <span className=\"tab-icon\"></span>\r\n                <span className=\"tab-label\">Downtime</span>\r\n                {downtimeEntries.length > 0 && <span className=\"tab-badge\">{downtimeEntries.length}</span>}\r\n              </button>\r\n              <button\r\n                className={`recording-tab ${activeRecordTab === 'sachet' ? 'active' : ''} ${sachetMassEntries.length > 0 ? 'has-entries' : ''}`}\r\n                onClick={() => setActiveRecordTab('sachet')}\r\n              >\r\n                <span className=\"tab-icon\"></span>\r\n                <span className=\"tab-label\">Sachet</span>\r\n                {sachetMassEntries.length > 0 && <span className=\"tab-badge\">{sachetMassEntries.length}</span>}\r\n              </button>\r\n              <button\r\n                className={`recording-tab ${activeRecordTab === 'product' ? 'active' : ''} ${(palletScanEntries.length > 0 || looseCasesEntries.length > 0) ? 'has-entries' : ''}`}\r\n                onClick={() => setActiveRecordTab('product')}\r\n              >\r\n                <span className=\"tab-icon\"></span>\r\n                <span className=\"tab-label\">Product</span>\r\n                {(palletScanEntries.length > 0 || looseCasesEntries.length > 0) && (\r\n                  <span className=\"tab-badge\">\r\n                    {palletScanEntries.filter(e => !e.ignored).reduce((sum, e) => sum + e.casesCount, 0) +\r\n                      looseCasesEntries.filter(e => !e.ignored).reduce((sum, e) => sum + e.cases, 0)}\r\n                  </span>\r\n                )}\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"recording-tab-content\">\r\n              {/* Waste Tab Content */}\r\n              {activeRecordTab === 'waste' && (\r\n                <div className=\"tab-panel waste-panel\">\r\n                  <button\r\n                    className=\"capture-add-btn waste-btn\"\r\n                    onClick={() => setShowWasteModal(true)}\r\n                  >\r\n                    <span className=\"btn-icon\">+</span>\r\n                    Record Waste\r\n                  </button>\r\n                  {wasteEntries.length > 0 && (\r\n                    <>\r\n                      <div className=\"capture-entries-list\">\r\n                        {wasteEntries.slice().reverse().map((entry, index) => (\r\n                          <div key={entry.id} className={`capture-entry-item waste-entry ${index === 0 ? 'latest' : ''}`}>\r\n                            <div className=\"entry-main\">\r\n                              <span className=\"entry-value\">{entry.waste}</span>\r\n                              <span className=\"entry-unit\">kg</span>\r\n                            </div>\r\n                            <span className=\"entry-type\">{entry.wasteType}</span>\r\n                            <span className=\"entry-time\">\r\n                              {new Date(entry.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                            </span>\r\n                            <button\r\n                              className=\"entry-delete-btn\"\r\n                              onClick={() => handleDeleteWasteEntry(entry.id)}\r\n                              title=\"Delete this entry\"\r\n                            >\r\n                              \r\n                            </button>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                      <div className=\"section-total\">\r\n                        <span>Total Waste:</span>\r\n                        <strong>{wasteEntries.reduce((sum, e) => sum + e.waste, 0).toFixed(1)} kg</strong>\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* Downtime Tab Content */}\r\n              {activeRecordTab === 'downtime' && (\r\n                <div className=\"tab-panel downtime-panel\">\r\n                  <button\r\n                    className=\"capture-add-btn downtime-btn\"\r\n                    onClick={() => setShowDowntimeModal(true)}\r\n                  >\r\n                    <span className=\"btn-icon\">+</span>\r\n                    Record Downtime\r\n                  </button>\r\n                  {downtimeEntries.length > 0 && (\r\n                    <>\r\n                      <div className=\"capture-entries-list\">\r\n                        {downtimeEntries.slice().reverse().map((entry, index) => (\r\n                          <div key={entry.id} className={`capture-entry-item downtime-entry ${index === 0 ? 'latest' : ''}`}>\r\n                            <div className=\"entry-main\">\r\n                              <span className=\"entry-value\">{entry.downtime}</span>\r\n                              <span className=\"entry-unit\">min</span>\r\n                            </div>\r\n                            <span className=\"entry-reason\">{entry.downtimeReason}</span>\r\n                            <span className=\"entry-time\">\r\n                              {new Date(entry.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                            </span>\r\n                            <button\r\n                              className=\"entry-delete-btn\"\r\n                              onClick={() => handleDeleteDowntimeEntry(entry.id)}\r\n                              title=\"Delete this entry\"\r\n                            >\r\n                              \r\n                            </button>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                      <div className=\"section-total\">\r\n                        <span>Total Downtime:</span>\r\n                        <strong>{Math.floor(downtimeEntries.reduce((sum, e) => sum + e.downtime, 0) / 60)}h {downtimeEntries.reduce((sum, e) => sum + e.downtime, 0) % 60}m</strong>\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* Sachet Mass Tab Content */}\r\n              {activeRecordTab === 'sachet' && (\r\n                <div className=\"tab-panel sachet-panel\">\r\n                  <button\r\n                    className=\"capture-add-btn\"\r\n                    onClick={() => setShowSachetModal(true)}\r\n                  >\r\n                    <span className=\"btn-icon\">+</span>\r\n                    Record Sachet Mass\r\n                  </button>\r\n                  {sachetMassEntries.length > 0 && (\r\n                    <div className=\"capture-entries-list\">\r\n                      {sachetMassEntries.map(entry => (\r\n                        <div key={entry.id} className={`capture-entry-item ${entry.ignored ? 'ignored' : ''}`}>\r\n                          <div className=\"entry-main\">\r\n                            <span className=\"entry-value\">{entry.mass}</span>\r\n                            <span className=\"entry-unit\">g</span>\r\n                          </div>\r\n                          <span className=\"entry-time\">\r\n                            {new Date(entry.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                          </span>\r\n                          <button\r\n                            className={`entry-ignore-btn ${entry.ignored ? 'ignored' : ''}`}\r\n                            onClick={() => handleToggleSachetIgnore(entry.id)}\r\n                            title={entry.ignored ? 'Include this entry' : 'Ignore this entry'}\r\n                          >\r\n                            {entry.ignored ? '' : ''}\r\n                          </button>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* Product Confirmation Tab Content */}\r\n              {activeRecordTab === 'product' && (\r\n                <div className=\"tab-panel product-panel\">\r\n                  {/* Action Buttons */}\r\n                  <div className=\"product-action-buttons\">\r\n                    <button\r\n                      className=\"capture-add-btn scan-btn\"\r\n                      onClick={() => setShowQRScanner(true)}\r\n                    >\r\n                      <span className=\"btn-icon\"></span>\r\n                      Scan Pallet\r\n                    </button>\r\n                    <button\r\n                      className=\"capture-add-btn loose-cases-btn\"\r\n                      onClick={() => setShowLooseCasesModal(true)}\r\n                    >\r\n                      <span className=\"btn-icon\">+</span>\r\n                      Add Loose Cases\r\n                    </button>\r\n                  </div>\r\n\r\n                  {/* Pallet Scans List */}\r\n                  {palletScanEntries.length > 0 && (\r\n                    <div className=\"product-entries-section\">\r\n                      <h4 className=\"entries-subheading\">Scanned Pallets ({palletScanEntries.filter(e => !e.ignored).length})</h4>\r\n                      <div className=\"capture-entries-list pallet-list\">\r\n                        {palletScanEntries.slice().reverse().map((entry, index) => (\r\n                          <div key={entry.id} className={`capture-entry-item pallet-entry ${entry.ignored ? 'ignored' : ''} ${index === 0 ? 'latest' : ''}`}>\r\n                            <div className=\"entry-main\">\r\n                              <span className=\"pallet-badge\">P{entry.palletNumber}</span>\r\n                              <div className=\"pallet-details\">\r\n                                <span className=\"pallet-batch\">Batch: {entry.batchNumber}</span>\r\n                                <span className=\"pallet-cases\">{entry.casesCount} cases</span>\r\n                              </div>\r\n                            </div>\r\n                            <span className=\"entry-time\">\r\n                              {formatScanTime(entry.timestamp)}\r\n                            </span>\r\n                            <button\r\n                              className={`entry-ignore-btn ${entry.ignored ? 'ignored' : ''}`}\r\n                              onClick={() => handleTogglePalletIgnore(entry.id)}\r\n                              title={entry.ignored ? 'Include this pallet' : 'Ignore this pallet'}\r\n                            >\r\n                              {entry.ignored ? '' : ''}\r\n                            </button>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Loose Cases List */}\r\n                  {looseCasesEntries.length > 0 && (\r\n                    <div className=\"product-entries-section\">\r\n                      <h4 className=\"entries-subheading\">Loose Cases ({looseCasesEntries.filter(e => !e.ignored).length})</h4>\r\n                      <div className=\"capture-entries-list loose-cases-list\">\r\n                        {looseCasesEntries.slice().reverse().map((entry, index) => (\r\n                          <div key={entry.id} className={`capture-entry-item loose-entry ${entry.ignored ? 'ignored' : ''}`}>\r\n                            <div className=\"entry-main\">\r\n                              <span className=\"loose-badge\">LC</span>\r\n                              <div className=\"loose-details\">\r\n                                <span className=\"loose-batch\">Batch: {entry.batchNumber}</span>\r\n                                <span className=\"loose-cases\">{entry.cases} cases</span>\r\n                              </div>\r\n                            </div>\r\n                            <span className=\"entry-time\">\r\n                              {formatScanTime(entry.timestamp)}\r\n                            </span>\r\n                            <button\r\n                              className={`entry-ignore-btn ${entry.ignored ? 'ignored' : ''}`}\r\n                              onClick={() => handleToggleLooseCasesIgnore(entry.id)}\r\n                              title={entry.ignored ? 'Include this entry' : 'Ignore this entry'}\r\n                            >\r\n                              {entry.ignored ? '' : ''}\r\n                            </button>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Summary */}\r\n                  {(palletScanEntries.length > 0 || looseCasesEntries.length > 0) && (\r\n                    <div className=\"product-summary\">\r\n                      <div className=\"summary-item\">\r\n                        <span className=\"summary-label\">Total Pallets:</span>\r\n                        <span className=\"summary-value\">{palletScanEntries.filter(e => !e.ignored).length}</span>\r\n                      </div>\r\n                      <div className=\"summary-item\">\r\n                        <span className=\"summary-label\">Total Cases:</span>\r\n                        <span className=\"summary-value\">\r\n                          {palletScanEntries.filter(e => !e.ignored).reduce((sum, e) => sum + e.casesCount, 0) +\r\n                            looseCasesEntries.filter(e => !e.ignored).reduce((sum, e) => sum + e.cases, 0)}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right Column - Summary & Charts */}\r\n        <div className=\"capture-summary-column\">\r\n          {/* Live Stats */}\r\n          <div className=\"live-stats-card\">\r\n            <h3>Session Totals</h3>\r\n            <div className=\"stats-grid\">\r\n              <div className=\"stat-box waste\">\r\n                <span className=\"stat-number\">{totalWaste.toFixed(1)}</span>\r\n                <span className=\"stat-unit\">kg waste</span>\r\n              </div>\r\n              <div className=\"stat-box downtime\">\r\n                <span className=\"stat-number\">{totalDowntime}</span>\r\n                <span className=\"stat-unit\">min downtime</span>\r\n              </div>\r\n              <div className=\"stat-box cases\">\r\n                <span className=\"stat-number\">\r\n                  {palletScanEntries.filter(e => !e.ignored).reduce((sum, e) => sum + e.casesCount, 0) +\r\n                    looseCasesEntries.filter(e => !e.ignored).reduce((sum, e) => sum + e.cases, 0)}\r\n                </span>\r\n                <span className=\"stat-unit\">cases</span>\r\n              </div>\r\n              <div className=\"stat-box pallets\">\r\n                <span className=\"stat-number\">{palletScanEntries.filter(e => !e.ignored).length}</span>\r\n                <span className=\"stat-unit\">pallets</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Charts */}\r\n          <div className=\"charts-card\">\r\n            <h3>Visual Summary</h3>\r\n            <DashboardCharts wasteEntries={wasteEntries} downtimeEntries={downtimeEntries} />\r\n          </div>\r\n\r\n          {/* Submission Preview */}\r\n          {(wasteEntries.length > 0 || downtimeEntries.length > 0) && (\r\n            <motion.div\r\n              className=\"submission-card\"\r\n              initial={{ opacity: 0, scale: 0.95 }}\r\n              animate={{ opacity: 1, scale: 1 }}\r\n            >\r\n              <h3>Ready to Submit</h3>\r\n              <div className=\"submission-details\">\r\n                <div className=\"detail-row\">\r\n                  <span>Operator</span>\r\n                  <strong>{operatorName || ''}</strong>\r\n                </div>\r\n                <div className=\"detail-row\">\r\n                  <span>Machine</span>\r\n                  <strong>{machineName}</strong>\r\n                </div>\r\n                <div className=\"detail-row\">\r\n                  <span>Order</span>\r\n                  <strong>{orderNumber || ''}</strong>\r\n                </div>\r\n                <div className=\"detail-row highlight waste\">\r\n                  <span>Total Waste</span>\r\n                  <strong>{totalWaste.toFixed(1)} kg</strong>\r\n                </div>\r\n                <div className=\"detail-row highlight downtime\">\r\n                  <span>Total Downtime</span>\r\n                  <strong>{Math.floor(totalDowntime / 60)}h {totalDowntime % 60}m</strong>\r\n                </div>\r\n              </div>\r\n              <button\r\n                className={`submit-btn-v2 ${!isInSubmissionWindow ? 'early-submit' : ''}`}\r\n                onClick={handleSubmitClick}\r\n                disabled={isSubmitting || !operatorName || !orderNumber || !product || !batchNumber}\r\n              >\r\n                {isSubmitting ? (\r\n                  <>\r\n                    <span className=\"btn-spinner\"></span>\r\n                    Submitting...\r\n                  </>\r\n                ) : (\r\n                  'Finalize Submission'\r\n                )}\r\n              </button>\r\n              {!isInSubmissionWindow && (\r\n                <p className=\"submission-window-note\">\r\n                   Submitting early - you'll be asked about changeover\r\n                </p>\r\n              )}\r\n            </motion.div>\r\n          )}\r\n        </div>\r\n      </main>\r\n\r\n      {/* Confirmation Dialog */}\r\n      <ConfirmDialog\r\n        isOpen={showConfirmDialog}\r\n        title=\"Confirm Submission\"\r\n        message={`You are about to submit ${wasteEntries.length} waste entries and ${downtimeEntries.length} downtime entries for ${machineName}.${willChangeover !== null ? ` Changeover: ${willChangeover ? 'Yes' : 'No'}. Maintenance/Cleaning: ${willMaintenance ? 'Yes' : 'No'}.` : ''} This action cannot be undone.`}\r\n        confirmText=\"Submit\"\r\n        cancelText=\"Review\"\r\n        type=\"success\"\r\n        onConfirm={handleConfirmedSubmit}\r\n        onCancel={() => setShowConfirmDialog(false)}\r\n      />\r\n\r\n      {/* Changeover Dialog (shown when submitting outside window) */}\r\n      <AnimatePresence>\r\n        {showChangeoverDialog && (\r\n          <motion.div\r\n            className=\"capture-modal-overlay\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n          >\r\n            <motion.div\r\n              className=\"capture-modal changeover-modal\"\r\n              initial={{ scale: 0.9, opacity: 0 }}\r\n              animate={{ scale: 1, opacity: 1 }}\r\n              exit={{ scale: 0.9, opacity: 0 }}\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <h3 className=\"modal-title\">\r\n                <span className=\"modal-icon\"></span>\r\n                Early Submission\r\n              </h3>\r\n              <p className=\"changeover-intro\">\r\n                You are submitting before the end of shift window. Please answer the following:\r\n              </p>\r\n\r\n              <div className=\"changeover-question\">\r\n                <label className=\"question-label\">\r\n                  Will there be a changeover to a new product and order?\r\n                </label>\r\n                <div className=\"question-options\">\r\n                  <button\r\n                    className={`option-btn ${willChangeover === true ? 'selected yes' : ''}`}\r\n                    onClick={() => setWillChangeover(true)}\r\n                  >\r\n                     Yes\r\n                  </button>\r\n                  <button\r\n                    className={`option-btn ${willChangeover === false ? 'selected no' : ''}`}\r\n                    onClick={() => setWillChangeover(false)}\r\n                  >\r\n                     No\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"changeover-question\">\r\n                <label className=\"question-label\">\r\n                  Will there be maintenance or cleaning before next production start?\r\n                </label>\r\n                <div className=\"question-options\">\r\n                  <button\r\n                    className={`option-btn ${willMaintenance === true ? 'selected yes' : ''}`}\r\n                    onClick={() => setWillMaintenance(true)}\r\n                  >\r\n                     Yes\r\n                  </button>\r\n                  <button\r\n                    className={`option-btn ${willMaintenance === false ? 'selected no' : ''}`}\r\n                    onClick={() => setWillMaintenance(false)}\r\n                  >\r\n                     No\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"modal-actions\">\r\n                <button\r\n                  className=\"modal-btn cancel\"\r\n                  onClick={() => setShowChangeoverDialog(false)}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  className=\"modal-btn confirm\"\r\n                  onClick={handleChangeoverConfirm}\r\n                  disabled={willChangeover === null || willMaintenance === null}\r\n                >\r\n                  Continue to Submit\r\n                </button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Shift Change Modal */}\r\n      <AnimatePresence>\r\n        {showShiftChangeModal && (\r\n          <motion.div\r\n            className=\"capture-modal-overlay\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n          >\r\n            <motion.div\r\n              className=\"capture-modal shift-change-modal\"\r\n              initial={{ scale: 0.9, opacity: 0 }}\r\n              animate={{ scale: 1, opacity: 1 }}\r\n              exit={{ scale: 0.9, opacity: 0 }}\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <h3 className=\"modal-title\">\r\n                <span className=\"modal-icon\"></span>\r\n                Shift Change Detected\r\n              </h3>\r\n              <p className=\"modal-description\">\r\n                The shift has changed to <strong>{shift}</strong> shift.\r\n                Please enter the new operator's name or number.\r\n              </p>\r\n              <div className=\"modal-form\">\r\n                <label className=\"modal-label\">New Operator Name/Number</label>\r\n                <input\r\n                  type=\"text\"\r\n                  className=\"modal-input\"\r\n                  placeholder=\"Enter operator name or number...\"\r\n                  value={newOperatorName}\r\n                  onChange={e => setNewOperatorName(e.target.value)}\r\n                  autoFocus\r\n                />\r\n              </div>\r\n              <div className=\"shift-change-info\">\r\n                <p><strong>Current Order:</strong> {orderNumber}</p>\r\n                <p><strong>Previous Operator:</strong> {operatorName}</p>\r\n              </div>\r\n              <div className=\"modal-actions\">\r\n                <button\r\n                  className=\"modal-btn confirm\"\r\n                  onClick={handleShiftChangeConfirm}\r\n                  disabled={!newOperatorName.trim()}\r\n                >\r\n                  Confirm Operator Change\r\n                </button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Machine Speed Modal */}\r\n      <AnimatePresence>\r\n        {showSpeedModal && (\r\n          <motion.div\r\n            className=\"capture-modal-overlay\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            onClick={() => setShowSpeedModal(false)}\r\n          >\r\n            <motion.div\r\n              className=\"capture-modal\"\r\n              initial={{ scale: 0.9, opacity: 0 }}\r\n              animate={{ scale: 1, opacity: 1 }}\r\n              exit={{ scale: 0.9, opacity: 0 }}\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <h3 className=\"modal-title\">\r\n                <span className=\"modal-icon\"></span>\r\n                Record Machine Speed\r\n              </h3>\r\n              <div className=\"modal-form\">\r\n                <label className=\"modal-label\">Speed (PPM - Packs Per Minute)</label>\r\n                <input\r\n                  type=\"number\"\r\n                  className=\"modal-input\"\r\n                  placeholder=\"Enter speed...\"\r\n                  value={speedInput}\r\n                  onChange={e => setSpeedInput(e.target.value ? Number(e.target.value) : '')}\r\n                  autoFocus\r\n                />\r\n              </div>\r\n              <div className=\"modal-actions\">\r\n                <button\r\n                  className=\"modal-btn cancel\"\r\n                  onClick={() => { setShowSpeedModal(false); setSpeedInput(''); }}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  className=\"modal-btn confirm\"\r\n                  onClick={handleSpeedSubmit}\r\n                  disabled={!speedInput || speedInput <= 0}\r\n                >\r\n                  Confirm\r\n                </button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Sachet Mass Modal */}\r\n      <AnimatePresence>\r\n        {showSachetModal && (\r\n          <motion.div\r\n            className=\"capture-modal-overlay\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            onClick={() => setShowSachetModal(false)}\r\n          >\r\n            <motion.div\r\n              className=\"capture-modal\"\r\n              initial={{ scale: 0.9, opacity: 0 }}\r\n              animate={{ scale: 1, opacity: 1 }}\r\n              exit={{ scale: 0.9, opacity: 0 }}\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <h3 className=\"modal-title\">\r\n                <span className=\"modal-icon\"></span>\r\n                Record Sachet Mass\r\n              </h3>\r\n              <div className=\"modal-form\">\r\n                <label className=\"modal-label\">Mass (grams)</label>\r\n                <input\r\n                  type=\"number\"\r\n                  step=\"0.1\"\r\n                  className=\"modal-input\"\r\n                  placeholder=\"Enter mass in grams...\"\r\n                  value={sachetMassInput}\r\n                  onChange={e => setSachetMassInput(e.target.value ? Number(e.target.value) : '')}\r\n                  autoFocus\r\n                />\r\n              </div>\r\n              <div className=\"modal-actions\">\r\n                <button\r\n                  className=\"modal-btn cancel\"\r\n                  onClick={() => { setShowSachetModal(false); setSachetMassInput(''); }}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  className=\"modal-btn confirm\"\r\n                  onClick={handleSachetMassSubmit}\r\n                  disabled={!sachetMassInput || sachetMassInput <= 0}\r\n                >\r\n                  Confirm\r\n                </button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Waste Modal */}\r\n      <AnimatePresence>\r\n        {showWasteModal && (\r\n          <motion.div\r\n            className=\"capture-modal-overlay\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            onClick={() => setShowWasteModal(false)}\r\n          >\r\n            <motion.div\r\n              className=\"capture-modal waste-modal\"\r\n              initial={{ scale: 0.9, opacity: 0 }}\r\n              animate={{ scale: 1, opacity: 1 }}\r\n              exit={{ scale: 0.9, opacity: 0 }}\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <h3 className=\"modal-title\">\r\n                <span className=\"modal-icon\"></span>\r\n                Record Waste\r\n              </h3>\r\n              <div className=\"modal-form\">\r\n                <div className=\"form-row\">\r\n                  <label className=\"modal-label\">Waste Type</label>\r\n                  <select\r\n                    className=\"modal-select\"\r\n                    value={wasteType}\r\n                    onChange={e => setWasteType(e.target.value)}\r\n                  >\r\n                    <option value=\"\">Select waste type...</option>\r\n                    {WASTE_TYPES.map(type => (\r\n                      <option key={type} value={type}>{type}</option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n                <div className=\"form-row\">\r\n                  <label className=\"modal-label\">Weight (kg)</label>\r\n                  <input\r\n                    type=\"number\"\r\n                    step=\"0.1\"\r\n                    className=\"modal-input\"\r\n                    placeholder=\"Enter weight in kg...\"\r\n                    value={waste}\r\n                    onChange={e => setWaste(e.target.value ? Number(e.target.value) : '')}\r\n                    min={0}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"modal-actions\">\r\n                <button\r\n                  className=\"modal-btn cancel\"\r\n                  onClick={() => {\r\n                    setShowWasteModal(false);\r\n                    setWaste('');\r\n                    setWasteType('');\r\n                  }}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  className=\"modal-btn confirm waste-confirm\"\r\n                  onClick={handleWasteSubmit}\r\n                  disabled={!waste || waste <= 0 || !wasteType}\r\n                >\r\n                  Add Waste Entry\r\n                </button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Downtime Modal */}\r\n      <AnimatePresence>\r\n        {showDowntimeModal && (\r\n          <motion.div\r\n            className=\"capture-modal-overlay\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            onClick={() => setShowDowntimeModal(false)}\r\n          >\r\n            <motion.div\r\n              className=\"capture-modal downtime-modal\"\r\n              initial={{ scale: 0.9, opacity: 0 }}\r\n              animate={{ scale: 1, opacity: 1 }}\r\n              exit={{ scale: 0.9, opacity: 0 }}\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <h3 className=\"modal-title\">\r\n                <span className=\"modal-icon\"></span>\r\n                Record Downtime\r\n              </h3>\r\n              <div className=\"modal-form\">\r\n                <div className=\"form-row\">\r\n                  <label className=\"modal-label\">Downtime Reason</label>\r\n                  <select\r\n                    className=\"modal-select\"\r\n                    value={downtimeReason}\r\n                    onChange={e => setDowntimeReason(e.target.value)}\r\n                  >\r\n                    <option value=\"\">Select reason...</option>\r\n                    {DOWNTIME_REASONS.map(reason => (\r\n                      <option key={reason} value={reason}>{reason}</option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n                <div className=\"form-row\">\r\n                  <label className=\"modal-label\">Duration (minutes)</label>\r\n                  <input\r\n                    type=\"number\"\r\n                    className=\"modal-input\"\r\n                    placeholder=\"Enter minutes...\"\r\n                    value={downtime}\r\n                    onChange={e => setDowntime(e.target.value ? Number(e.target.value) : '')}\r\n                    min={1}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"modal-actions\">\r\n                <button\r\n                  className=\"modal-btn cancel\"\r\n                  onClick={() => {\r\n                    setShowDowntimeModal(false);\r\n                    setDowntime('');\r\n                    setDowntimeReason('');\r\n                  }}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  className=\"modal-btn confirm downtime-confirm\"\r\n                  onClick={handleDowntimeSubmit}\r\n                  disabled={!downtime || downtime <= 0 || !downtimeReason}\r\n                >\r\n                  Add Downtime Entry\r\n                </button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Continue Production Modal */}\r\n      <AnimatePresence>\r\n        {showContinueModal && (\r\n          <motion.div\r\n            className=\"capture-modal-overlay\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            onClick={() => setShowContinueModal(false)}\r\n          >\r\n            <motion.div\r\n              className=\"capture-modal continue-modal\"\r\n              initial={{ scale: 0.9, opacity: 0 }}\r\n              animate={{ scale: 1, opacity: 1 }}\r\n              exit={{ scale: 0.9, opacity: 0 }}\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <h3 className=\"modal-title\">\r\n                <span className=\"modal-icon\"></span>\r\n                Continue Production\r\n              </h3>\r\n              <div className=\"modal-form\">\r\n                <div className=\"pause-info\">\r\n                  <span className=\"pause-duration-label\">Paused Duration:</span>\r\n                  <span className=\"pause-duration-value\">\r\n                    {productionState.pausedAt\r\n                      ? `${Math.ceil((Date.now() - productionState.pausedAt.getTime()) / 60000)} minutes`\r\n                      : '0 minutes'}\r\n                  </span>\r\n                </div>\r\n                <div className=\"form-row\">\r\n                  <label className=\"modal-label\">What was the reason for this downtime?</label>\r\n                  <select\r\n                    className=\"modal-select\"\r\n                    value={pauseDowntimeReason}\r\n                    onChange={e => setPauseDowntimeReason(e.target.value)}\r\n                    autoFocus\r\n                  >\r\n                    <option value=\"\">Select reason...</option>\r\n                    {DOWNTIME_REASONS.map(reason => (\r\n                      <option key={reason} value={reason}>{reason}</option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n              </div>\r\n              <div className=\"modal-actions\">\r\n                <button\r\n                  className=\"modal-btn cancel\"\r\n                  onClick={() => {\r\n                    setShowContinueModal(false);\r\n                    setPauseDowntimeReason('');\r\n                  }}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  className=\"modal-btn confirm continue-confirm\"\r\n                  onClick={handleContinueProduction}\r\n                  disabled={!pauseDowntimeReason}\r\n                >\r\n                  Record & Continue\r\n                </button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Loose Cases Modal */}\r\n      <AnimatePresence>\r\n        {showLooseCasesModal && (\r\n          <motion.div\r\n            className=\"capture-modal-overlay\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            onClick={() => setShowLooseCasesModal(false)}\r\n          >\r\n            <motion.div\r\n              className=\"capture-modal loose-cases-modal\"\r\n              initial={{ scale: 0.9, opacity: 0 }}\r\n              animate={{ scale: 1, opacity: 1 }}\r\n              exit={{ scale: 0.9, opacity: 0 }}\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <h3 className=\"modal-title\">\r\n                <span className=\"modal-icon\"></span>\r\n                Add Loose Cases\r\n              </h3>\r\n              <p className=\"modal-description\">\r\n                Enter cases that are not part of a full pallet scan\r\n              </p>\r\n              <div className=\"modal-form\">\r\n                <div className=\"form-row\">\r\n                  <label className=\"modal-label\">Batch Number (5 digits)</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    className=\"modal-input\"\r\n                    placeholder=\"e.g., 12345\"\r\n                    value={looseCasesBatchInput}\r\n                    onChange={e => {\r\n                      const value = e.target.value.replace(/\\D/g, '').slice(0, 5);\r\n                      setLooseCasesBatchInput(value);\r\n                    }}\r\n                    maxLength={5}\r\n                    autoFocus\r\n                  />\r\n                </div>\r\n                <div className=\"form-row\">\r\n                  <label className=\"modal-label\">Number of Cases</label>\r\n                  <input\r\n                    type=\"number\"\r\n                    className=\"modal-input\"\r\n                    placeholder=\"Enter quantity...\"\r\n                    value={looseCasesQuantityInput}\r\n                    onChange={e => setLooseCasesQuantityInput(e.target.value ? Number(e.target.value) : '')}\r\n                    min={1}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"modal-actions\">\r\n                <button\r\n                  className=\"modal-btn cancel\"\r\n                  onClick={() => {\r\n                    setShowLooseCasesModal(false);\r\n                    setLooseCasesBatchInput('');\r\n                    setLooseCasesQuantityInput('');\r\n                  }}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  className=\"modal-btn confirm\"\r\n                  onClick={handleLooseCasesSubmit}\r\n                  disabled={looseCasesBatchInput.length !== 5 || !looseCasesQuantityInput || looseCasesQuantityInput <= 0}\r\n                >\r\n                  Add Cases\r\n                </button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* QR Scanner for Pallet Scans */}\r\n      <QRScanner\r\n        isOpen={showQRScanner}\r\n        onClose={() => setShowQRScanner(false)}\r\n        onScan={handlePalletScan}\r\n        recentScans={palletScanEntries.map(e => e.qrCode)}\r\n      />\r\n\r\n      {/* Order Queue Selection Modal */}\r\n      <AnimatePresence>\r\n        {showOrderSelect && (\r\n          <motion.div\r\n            className=\"capture-modal-overlay\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            onClick={() => setShowOrderSelect(false)}\r\n          >\r\n            <motion.div\r\n              className=\"capture-modal order-select-modal\"\r\n              initial={{ scale: 0.9, opacity: 0 }}\r\n              animate={{ scale: 1, opacity: 1 }}\r\n              exit={{ scale: 0.9, opacity: 0 }}\r\n              onClick={e => e.stopPropagation()}\r\n            >\r\n              <h3 className=\"modal-title\">\r\n                <span className=\"modal-icon\"></span>\r\n                Select Order\r\n              </h3>\r\n              <p className=\"modal-description\">\r\n                Choose an order from the queue (sorted by priority)\r\n              </p>\r\n              <div className=\"order-queue-list\">\r\n                {availableOrders.map((order, index) => (\r\n                  <button\r\n                    key={order.id}\r\n                    className={`order-queue-item ${orderNumber === order.order_number ? 'selected' : ''}`}\r\n                    onClick={() => handleOrderSelect(order)}\r\n                  >\r\n                    <span className=\"order-priority\">#{index + 1}</span>\r\n                    <div className=\"order-details\">\r\n                      <span className=\"order-number\">{order.order_number}</span>\r\n                      <span className=\"order-product\">{order.product}</span>\r\n                      <span className=\"order-batch\">Batch: {order.batch_number}</span>\r\n                    </div>\r\n                    {orderNumber === order.order_number && (\r\n                      <span className=\"order-selected-badge\"></span>\r\n                    )}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n              <div className=\"modal-actions\">\r\n                <button\r\n                  className=\"modal-btn add-order\"\r\n                  onClick={() => {\r\n                    setShowOrderSelect(false);\r\n                    setShowAddOrderModal(true);\r\n                  }}\r\n                >\r\n                  + Add New Order\r\n                </button>\r\n                <button\r\n                  className=\"modal-btn cancel\"\r\n                  onClick={() => setShowOrderSelect(false)}\r\n                >\r\n                  Cancel\r\n                </button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      {/* Add Order Modal */}\r\n      <AddOrderModal\r\n        isOpen={showAddOrderModal}\r\n        onClose={() => setShowAddOrderModal(false)}\r\n        machineId={machineId || ''}\r\n        machineName={machineName}\r\n        onOrderAdded={handleOrderAdded}\r\n      />\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default CaptureScreen;\r\n","import React from 'react';\r\nimport { format } from 'date-fns';\r\n\r\ninterface ShiftInfoProps {\r\n  dateTime: Date;\r\n  shift: string;\r\n}\r\n\r\nconst ShiftInfo: React.FC<ShiftInfoProps> = ({ dateTime, shift }) => {\r\n  return (\r\n    <div className=\"shift-info-card\">\r\n      <div className=\"shift-info-header\">\r\n        <span className=\"info-label\">Current Date</span>\r\n        <span className=\"info-value date\">{format(dateTime, 'EEEE,')}</span>\r\n        <span className=\"info-value\">{format(dateTime, 'MMM d, yyyy')}</span>\r\n      </div>\r\n      <div className=\"shift-info-time\">\r\n        <span className=\"info-label\">Current Time</span>\r\n        <span className=\"time-display\">{format(dateTime, 'HH:mm:ss')}</span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShiftInfo;\r\n","import React from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface ConfirmDialogProps {\r\n  isOpen: boolean;\r\n  title: string;\r\n  message: string;\r\n  confirmText?: string;\r\n  cancelText?: string;\r\n  onConfirm: () => void;\r\n  onCancel: () => void;\r\n  type?: 'default' | 'danger' | 'success';\r\n}\r\n\r\nconst ConfirmDialog: React.FC<ConfirmDialogProps> = ({\r\n  isOpen,\r\n  title,\r\n  message,\r\n  confirmText = 'Confirm',\r\n  cancelText = 'Cancel',\r\n  onConfirm,\r\n  onCancel,\r\n  type = 'default',\r\n}) => {\r\n  const getButtonClass = () => {\r\n    switch (type) {\r\n      case 'danger':\r\n        return 'btn-danger';\r\n      case 'success':\r\n        return 'btn-success';\r\n      default:\r\n        return 'btn-primary';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {isOpen && (\r\n        <motion.div\r\n          className=\"confirm-dialog-overlay\"\r\n          initial={{ opacity: 0 }}\r\n          animate={{ opacity: 1 }}\r\n          exit={{ opacity: 0 }}\r\n          onClick={onCancel}\r\n        >\r\n          <motion.div\r\n            className=\"confirm-dialog\"\r\n            initial={{ opacity: 0, scale: 0.9, y: 20 }}\r\n            animate={{ opacity: 1, scale: 1, y: 0 }}\r\n            exit={{ opacity: 0, scale: 0.9, y: 20 }}\r\n            onClick={(e) => e.stopPropagation()}\r\n          >\r\n            <div className=\"confirm-dialog-header\">\r\n              <h3>{title}</h3>\r\n            </div>\r\n            <div className=\"confirm-dialog-body\">\r\n              <p>{message}</p>\r\n            </div>\r\n            <div className=\"confirm-dialog-footer\">\r\n              <button \r\n                className=\"btn btn-outline-secondary\" \r\n                onClick={onCancel}\r\n              >\r\n                {cancelText}\r\n              </button>\r\n              <button \r\n                className={`btn ${getButtonClass()}`} \r\n                onClick={onConfirm}\r\n              >\r\n                {confirmText}\r\n              </button>\r\n            </div>\r\n          </motion.div>\r\n        </motion.div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n};\r\n\r\nexport default ConfirmDialog;\r\n"],"names":["_ref","operatorName","setOperatorName","machine","setMachine","orderNumber","setOrderNumber","product","setProduct","batchNumber","setBatchNumber","hideMachine","disabled","_jsxs","className","children","_jsx","htmlFor","type","id","value","onChange","e","target","placeholder","readOnly","COLORS","EmptyChart","message","icon","_ref2","wasteEntries","downtimeEntries","wasteData","reduce","acc","entry","existing","find","item","name","wasteType","waste","push","downtimeData","downtimeReason","downtime","length","ResponsiveContainer","width","height","BarChart","data","margin","top","right","left","bottom","CartesianGrid","strokeDasharray","stroke","XAxis","dataKey","tick","fill","fontSize","axisLine","tickLine","YAxis","Tooltip","contentStyle","background","border","borderRadius","color","Bar","radius","PieChart","Pie","cx","cy","labelLine","label","_ref3","percent","concat","toFixed","outerRadius","innerRadius","strokeWidth","map","index","Cell","formatter","style","isOpen","onClose","onScan","recentScans","error","setError","useState","setIsScanning","lastScanned","setLastScanned","showSuccess","setShowSuccess","scannerRef","useRef","containerRef","isOpenRef","useEffect","current","timeoutId","setTimeout","startScannerInternal","clearTimeout","stopScannerInternal","async","getState","Html5QrcodeScannerState","SCANNING","stop","clear","err","console","scanner","Html5Qrcode","start","facingMode","fps","qrbox","aspectRatio","decodedText","handleSuccessfulScan","toString","includes","qrData","navigator","vibrate","handleClose","AnimatePresence","motion","div","initial","opacity","animate","exit","onClick","scale","stopPropagation","ref","Button","variant","size","iconPosition","loading","fullWidth","props","_objectWithoutProperties","_excluded","isDisabled","_objectSpread","Modal","title","subtitle","footer","closeOnOverlay","showCloseButton","document","body","overflow","handleEscape","key","addEventListener","removeEventListener","transition","duration","undefined","y","ease","viewBox","d","FormField","required","hint","AddOrderModal","machineId","machineName","onOrderAdded","setLoading","trim","addMachineOrder","r","getSessionKey","shift","date","CaptureScreen","useParams","location","useLocation","navigate","useNavigate","getMachineName","_location$state","stateKey","fromState","state","sessionStorage","setItem","restored","getItem","parentMachineId","getParentMachineId","_location$state2","split","localStorage","removeItem","dateTime","setDateTime","Date","setShift","isSubmitting","setIsSubmitting","toast","setToast","showConfirmDialog","setShowConfirmDialog","isSessionLocked","setIsSessionLocked","setWaste","setWasteType","setDowntime","setDowntimeReason","setWasteEntries","setDowntimeEntries","speedEntries","setSpeedEntries","sachetMassEntries","setSachetMassEntries","looseCasesEntries","setLooseCasesEntries","palletScanEntries","setPalletScanEntries","showSpeedModal","setShowSpeedModal","showSachetModal","setShowSachetModal","showLooseCasesModal","setShowLooseCasesModal","showQRScanner","setShowQRScanner","showWasteModal","setShowWasteModal","showDowntimeModal","setShowDowntimeModal","speedInput","setSpeedInput","sachetMassInput","setSachetMassInput","looseCasesBatchInput","setLooseCasesBatchInput","looseCasesQuantityInput","setLooseCasesQuantityInput","isInSubmissionWindow","setIsInSubmissionWindow","setTimeToWindow","availableOrders","setAvailableOrders","showOrderSelect","setShowOrderSelect","showAddOrderModal","setShowAddOrderModal","activeRecordTab","setActiveRecordTab","lastKnownShift","setLastKnownShift","showShiftChangeModal","setShowShiftChangeModal","newOperatorName","setNewOperatorName","showChangeoverDialog","setShowChangeoverDialog","willChangeover","setWillChangeover","willMaintenance","setWillMaintenance","productionState","setProductionState","isRunning","startTime","pausedAt","totalRunTimeMs","lastResumedAt","displayRunTime","setDisplayRunTime","showContinueModal","setShowContinueModal","pauseDowntimeReason","setPauseDowntimeReason","showToast","sessionConflict","setSessionConflict","unsubscribeConflictRef","checkSubmissionWindowCallback","useCallback","currentDateTime","result","checkSubmissionWindow","isInWindow","timeToWindow","loadSession","currentDate","toISOString","currentShift","getCurrentShift","sessionKey","hasConflict","activeSession","checkForActiveSession","operator_name","started_at","toLocaleTimeString","showWarning","timerState","loadProductionTimer","formatRunTime","calculateCurrentRunTime","savedSession","session","JSON","parse","locked","sharedSpeed","getLineSpeed","sharedSpeedEntry","uuidv4","speed","timestamp","updatedAt","log","updatedBy","fetchLiveSessionByMachine","liveSession","is_locked","order_number","batch_number","restoredSpeedEntries","localSession","machine_name","session_date","stringify","fetchActiveOrderDetails","activeOrder","adminOrderDetails","details","saveSession","showMessage","arguments","lockResult","acquireSessionLock","success","showError","subscribeToSessionConflicts","conflictSession","totalWaste","sum","totalDowntime","upsertLiveSession","now","timerStateToSave","pauseHistory","saveProductionTimer","updateMachineStatus","productionStateRef","autoSaveInterval","setInterval","_productionState$star","_productionState$paus","_productionState$last","clearInterval","_state$startTime","_state$pausedAt","_state$lastResumedAt","releaseSessionLock","orders","fetchMachineOrders","loadMachineOrders","timer","newShift","timerInterval","currentSessionMs","getTime","totalMs","totalSeconds","Math","floor","hours","minutes","seconds","padStart","persistTimerState","_state$startTime2","_state$pausedAt2","_state$lastResumedAt2","handleStartProduction","newState","addActivityEvent","handlePauseProduction","handleContinueProduction","pauseDurationMs","pauseDurationMinutes","ceil","newDowntimeEntry","notes","prev","formatScanTime","hour","minute","x","handleBack","window","confirm","toLowerCase","MainForm","ShiftInfo","filter","ignored","casesCount","cases","_Fragment","slice","reverse","handleDeleteWasteEntry","handleDeleteDowntimeEntry","mass","handleToggleSachetIgnore","palletNumber","handleTogglePalletIgnore","handleToggleLooseCasesIgnore","DashboardCharts","preventDefault","ConfirmDialog","confirmText","cancelText","onConfirm","shiftData","submittedAt","submissionPayload","submission_date","is_early_submission","will_changeover","will_maintenance_cleaning","qrCode","saveShiftData","submitShiftData","warnings","join","deleteLiveSession","addFailedSubmission","String","onCancel","handleChangeoverConfirm","autoFocus","handleShiftChangeConfirm","Number","handleSpeedSubmit","newEntry","saveLineSpeed","step","handleSachetMassSubmit","WASTE_TYPES","min","handleWasteSubmit","DOWNTIME_REASONS","reason","handleDowntimeSubmit","replace","maxLength","handleLooseCasesSubmit","QRScanner","parsed","cleaned","test","parseInt","substring","isNaN","parsePalletQRCode","some","order","handleOrderSelect","then","catch","format","getButtonClass"],"ignoreList":[],"sourceRoot":""}