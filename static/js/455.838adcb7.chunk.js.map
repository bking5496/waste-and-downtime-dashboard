{"version":3,"file":"static/js/455.838adcb7.chunk.js","mappings":"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","sources":["pages/AdminConsole.tsx","types.ts","lib/storage.ts"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport {\r\n    isSupabaseConfigured,\r\n    fetchAllMachineOrders,\r\n    addMachineOrder,\r\n    removeMachineOrder,\r\n    updateMachineOrderPriorities,\r\n    clearMachineOrders,\r\n    MachineOrderQueueRecord\r\n} from '../lib/supabase';\r\nimport { getMachinesData } from '../lib/storage';\r\nimport { Machine } from '../types';\r\nimport {\r\n    getFacilitySettings,\r\n    saveFacilitySettings,\r\n    resetFacilitySettings,\r\n    FacilitySettings,\r\n    formatShiftTimes\r\n} from '../lib/facilitySettings';\r\nimport { showSuccess, showError } from '../lib/errorMonitoring';\r\n\r\n// Parsed order from bulk paste\r\ninterface ParsedOrder {\r\n    machineName: string;\r\n    machineId: string;\r\n    orderNumber: string;\r\n    product: string;\r\n    batchNumber: string;\r\n    valid: boolean;\r\n    error?: string;\r\n}\r\n\r\nconst AdminConsole: React.FC = () => {\r\n    const navigate = useNavigate();\r\n\r\n    // Form state for adding new orders\r\n    const [selectedMachine, setSelectedMachine] = useState('');\r\n    const [orderNumber, setOrderNumber] = useState('');\r\n    const [product, setProduct] = useState('');\r\n    const [batchNumber, setBatchNumber] = useState('');\r\n\r\n    // Bulk paste state\r\n    const [bulkPasteText, setBulkPasteText] = useState('');\r\n    const [parsedOrders, setParsedOrders] = useState<ParsedOrder[]>([]);\r\n    const [showBulkPreview, setShowBulkPreview] = useState(false);\r\n    const [activeTab, setActiveTab] = useState<'single' | 'bulk'>('bulk');\r\n\r\n    // Data state\r\n    const [machines, setMachines] = useState<Machine[]>([]);\r\n    const [machineOrders, setMachineOrders] = useState<Record<string, MachineOrderQueueRecord[]>>({});\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n    const [toast, setToast] = useState<{ message: string; type: 'success' | 'error' } | null>(null);\r\n\r\n    // Facility settings state\r\n    const [facilitySettings, setFacilitySettings] = useState<FacilitySettings>(getFacilitySettings());\r\n    const [showSettingsPanel, setShowSettingsPanel] = useState(false);\r\n\r\n    const showToast = (message: string, type: 'success' | 'error') => {\r\n        setToast({ message, type });\r\n        setTimeout(() => setToast(null), 4000);\r\n    };\r\n\r\n    // Handle facility settings save\r\n    const handleSaveSettings = () => {\r\n        try {\r\n            const updated = saveFacilitySettings(facilitySettings);\r\n            setFacilitySettings(updated);\r\n            showSuccess('Facility settings saved');\r\n            setShowSettingsPanel(false);\r\n        } catch (e) {\r\n            showError('Failed to save settings');\r\n        }\r\n    };\r\n\r\n    // Handle facility settings reset\r\n    const handleResetSettings = () => {\r\n        if (window.confirm('Reset all facility settings to defaults?')) {\r\n            const defaults = resetFacilitySettings();\r\n            setFacilitySettings(defaults);\r\n            showSuccess('Settings reset to defaults');\r\n        }\r\n    };\r\n\r\n    // Load machines and orders\r\n    const loadData = useCallback(async () => {\r\n        setIsLoading(true);\r\n        try {\r\n            // Load machines from storage\r\n            const machinesData = getMachinesData();\r\n            setMachines(machinesData);\r\n\r\n            if (machinesData.length > 0 && !selectedMachine) {\r\n                setSelectedMachine(machinesData[0].id);\r\n            }\r\n\r\n            // Load orders from Supabase\r\n            if (isSupabaseConfigured) {\r\n                const allOrders = await fetchAllMachineOrders();\r\n                // Group orders by machine\r\n                const grouped: Record<string, MachineOrderQueueRecord[]> = {};\r\n                machinesData.forEach(m => {\r\n                    grouped[m.id] = allOrders.filter(o => o.machine_id === m.id);\r\n                });\r\n                setMachineOrders(grouped);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error loading data:', error);\r\n            showToast('Failed to load data', 'error');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }, [selectedMachine]);\r\n\r\n    useEffect(() => {\r\n        loadData();\r\n    }, [loadData]);\r\n\r\n    // Find machine by name (case-insensitive, partial match)\r\n    const findMachine = useCallback((name: string): Machine | undefined => {\r\n        const normalizedName = name.trim().toLowerCase();\r\n        return machines.find(m =>\r\n            m.name.toLowerCase() === normalizedName ||\r\n            m.name.toLowerCase().includes(normalizedName) ||\r\n            normalizedName.includes(m.name.toLowerCase())\r\n        );\r\n    }, [machines]);\r\n\r\n    // Parse bulk paste text\r\n    const parseBulkText = useCallback((text: string): ParsedOrder[] => {\r\n        if (!text.trim()) return [];\r\n\r\n        const lines = text.split('\\n').filter(line => line.trim());\r\n        const orders: ParsedOrder[] = [];\r\n\r\n        for (const line of lines) {\r\n            // Try to split by tab first, then comma\r\n            let parts = line.split('\\t');\r\n            if (parts.length < 4) {\r\n                parts = line.split(',');\r\n            }\r\n\r\n            // Clean up parts\r\n            parts = parts.map(p => p.trim());\r\n\r\n            if (parts.length >= 4) {\r\n                const [machineName, orderNum, prod, batch] = parts;\r\n                const machine = findMachine(machineName);\r\n\r\n                orders.push({\r\n                    machineName: machineName,\r\n                    machineId: machine?.id || '',\r\n                    orderNumber: orderNum,\r\n                    product: prod,\r\n                    batchNumber: batch,\r\n                    valid: !!machine && !!orderNum && !!prod && !!batch,\r\n                    error: !machine ? `Machine \"${machineName}\" not found` :\r\n                           !orderNum ? 'Missing order number' :\r\n                           !prod ? 'Missing product' :\r\n                           !batch ? 'Missing batch' : undefined\r\n                });\r\n            } else if (parts.length > 0 && parts[0]) {\r\n                // Invalid line format\r\n                orders.push({\r\n                    machineName: parts[0] || 'Unknown',\r\n                    machineId: '',\r\n                    orderNumber: parts[1] || '',\r\n                    product: parts[2] || '',\r\n                    batchNumber: parts[3] || '',\r\n                    valid: false,\r\n                    error: 'Invalid format. Expected: Machine, Order, Product, Batch'\r\n                });\r\n            }\r\n        }\r\n\r\n        return orders;\r\n    }, [findMachine]);\r\n\r\n    // Handle bulk text change\r\n    const handleBulkTextChange = (text: string) => {\r\n        setBulkPasteText(text);\r\n        const parsed = parseBulkText(text);\r\n        setParsedOrders(parsed);\r\n        setShowBulkPreview(parsed.length > 0);\r\n    };\r\n\r\n    // Import all valid orders\r\n    const handleBulkImport = async () => {\r\n        const validOrders = parsedOrders.filter(o => o.valid);\r\n        if (validOrders.length === 0) {\r\n            showToast('No valid orders to import', 'error');\r\n            return;\r\n        }\r\n\r\n        setIsSaving(true);\r\n        try {\r\n            // Group orders by machine to maintain priority within each machine\r\n            const ordersByMachine: Record<string, ParsedOrder[]> = {};\r\n            validOrders.forEach(order => {\r\n                if (!ordersByMachine[order.machineId]) {\r\n                    ordersByMachine[order.machineId] = [];\r\n                }\r\n                ordersByMachine[order.machineId].push(order);\r\n            });\r\n\r\n            // Add orders for each machine in sequence\r\n            for (const machineId of Object.keys(ordersByMachine)) {\r\n                const machineOrders = ordersByMachine[machineId];\r\n                for (const order of machineOrders) {\r\n                    await addMachineOrder(\r\n                        order.machineId,\r\n                        order.orderNumber,\r\n                        order.product,\r\n                        order.batchNumber\r\n                    );\r\n                }\r\n            }\r\n\r\n            await loadData();\r\n            showToast(`Successfully imported ${validOrders.length} orders`, 'success');\r\n\r\n            // Clear the form\r\n            setBulkPasteText('');\r\n            setParsedOrders([]);\r\n            setShowBulkPreview(false);\r\n        } catch (error) {\r\n            console.error('Error importing orders:', error);\r\n            showToast('Failed to import orders', 'error');\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    const handleAddOrder = async () => {\r\n        if (!selectedMachine) {\r\n            showToast('Please select a machine', 'error');\r\n            return;\r\n        }\r\n        if (!orderNumber.trim() || !product.trim() || !batchNumber.trim()) {\r\n            showToast('Please fill in all fields', 'error');\r\n            return;\r\n        }\r\n\r\n        setIsSaving(true);\r\n        try {\r\n            if (isSupabaseConfigured) {\r\n                await addMachineOrder(selectedMachine, orderNumber, product, batchNumber);\r\n                await loadData();\r\n                showToast('Order added successfully', 'success');\r\n                // Clear form\r\n                setOrderNumber('');\r\n                setProduct('');\r\n                setBatchNumber('');\r\n            } else {\r\n                showToast('Supabase not configured', 'error');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error adding order:', error);\r\n            showToast('Failed to add order', 'error');\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    const handleRemoveOrder = async (orderId: number) => {\r\n        if (!window.confirm('Remove this order from the queue?')) return;\r\n\r\n        try {\r\n            await removeMachineOrder(orderId);\r\n            await loadData();\r\n            showToast('Order removed', 'success');\r\n        } catch (error) {\r\n            console.error('Error removing order:', error);\r\n            showToast('Failed to remove order', 'error');\r\n        }\r\n    };\r\n\r\n    const handleMoveOrder = async (machineId: string, orderId: number, direction: 'up' | 'down') => {\r\n        const orders = machineOrders[machineId] || [];\r\n        const currentIndex = orders.findIndex(o => o.id === orderId);\r\n        if (currentIndex === -1) return;\r\n\r\n        const newIndex = direction === 'up' ? currentIndex - 1 : currentIndex + 1;\r\n        if (newIndex < 0 || newIndex >= orders.length) return;\r\n\r\n        // Swap orders\r\n        const newOrders = [...orders];\r\n        [newOrders[currentIndex], newOrders[newIndex]] = [newOrders[newIndex], newOrders[currentIndex]];\r\n\r\n        // Update local state immediately for responsiveness\r\n        setMachineOrders(prev => ({\r\n            ...prev,\r\n            [machineId]: newOrders\r\n        }));\r\n\r\n        // Update priorities in database\r\n        try {\r\n            const orderIds = newOrders.map(o => o.id!);\r\n            await updateMachineOrderPriorities(machineId, orderIds);\r\n        } catch (error) {\r\n            console.error('Error updating order priorities:', error);\r\n            // Reload data to restore correct state\r\n            await loadData();\r\n            showToast('Failed to reorder', 'error');\r\n        }\r\n    };\r\n\r\n    const handleClearMachineOrders = async (machineId: string) => {\r\n        const machine = machines.find(m => m.id === machineId);\r\n        if (!window.confirm(`Clear all orders for ${machine?.name || machineId}?`)) return;\r\n\r\n        try {\r\n            await clearMachineOrders(machineId);\r\n            await loadData();\r\n            showToast('Orders cleared', 'success');\r\n        } catch (error) {\r\n            console.error('Error clearing orders:', error);\r\n            showToast('Failed to clear orders', 'error');\r\n        }\r\n    };\r\n\r\n    // Count valid and invalid orders\r\n    const validCount = parsedOrders.filter(o => o.valid).length;\r\n    const invalidCount = parsedOrders.filter(o => !o.valid).length;\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"admin-console loading\">\r\n                <div className=\"spinner-v2\"></div>\r\n                <p>Loading order queues...</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <motion.div\r\n            className=\"admin-console\"\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: -20 }}\r\n        >\r\n            {/* Toast */}\r\n            <AnimatePresence>\r\n                {toast && (\r\n                    <motion.div\r\n                        className=\"toast-container-v2\"\r\n                        initial={{ opacity: 0, y: -20 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        exit={{ opacity: 0, y: -20 }}\r\n                    >\r\n                        <div className={`toast-message-v2 ${toast.type}`}>\r\n                            <span className=\"toast-icon\">{toast.type === 'success' ? 'âœ“' : '!'}</span>\r\n                            {toast.message}\r\n                        </div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            {/* Header */}\r\n            <header className=\"admin-header\">\r\n                <button className=\"back-btn-v2\" onClick={() => navigate('/')}>\r\n                    <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                        <path d=\"M19 12H5M12 19l-7-7 7-7\" />\r\n                    </svg>\r\n                    Back\r\n                </button>\r\n                <div className=\"admin-title\">\r\n                    <h1>Admin Console</h1>\r\n                    <span className=\"admin-subtitle\">Machine Order Queues</span>\r\n                </div>\r\n            </header>\r\n\r\n            <main className=\"admin-main\">\r\n                {/* Add Order Section with Tabs */}\r\n                <section className=\"admin-form-section\">\r\n                    <div className=\"admin-tabs\">\r\n                        <button\r\n                            className={`admin-tab ${activeTab === 'bulk' ? 'active' : ''}`}\r\n                            onClick={() => setActiveTab('bulk')}\r\n                        >\r\n                            <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" width=\"18\" height=\"18\">\r\n                                <path d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2\" />\r\n                            </svg>\r\n                            Bulk Import\r\n                        </button>\r\n                        <button\r\n                            className={`admin-tab ${activeTab === 'single' ? 'active' : ''}`}\r\n                            onClick={() => setActiveTab('single')}\r\n                        >\r\n                            <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" width=\"18\" height=\"18\">\r\n                                <path d=\"M12 5v14M5 12h14\" />\r\n                            </svg>\r\n                            Single Order\r\n                        </button>\r\n                    </div>\r\n\r\n                    {activeTab === 'bulk' ? (\r\n                        <div className=\"admin-form bulk-form\">\r\n                            <div className=\"form-field\">\r\n                                <label className=\"form-label\">\r\n                                    Paste Orders (one per line)\r\n                                    <span className=\"form-hint\">Format: Machine, Order Number, Product, Batch Number</span>\r\n                                </label>\r\n                                <textarea\r\n                                    className=\"form-textarea\"\r\n                                    placeholder={`Example:\\nCanline, ORD-001, Product A, BATCH001\\nSachet Line, ORD-002, Product B, BATCH002\\nCanline, ORD-003, Product C, BATCH003`}\r\n                                    value={bulkPasteText}\r\n                                    onChange={e => handleBulkTextChange(e.target.value)}\r\n                                    rows={8}\r\n                                />\r\n                            </div>\r\n\r\n                            {/* Preview */}\r\n                            {showBulkPreview && (\r\n                                <div className=\"bulk-preview\">\r\n                                    <div className=\"preview-header\">\r\n                                        <h3>Preview ({validCount} valid, {invalidCount} invalid)</h3>\r\n                                    </div>\r\n                                    <div className=\"preview-list\">\r\n                                        {parsedOrders.map((order, index) => (\r\n                                            <div\r\n                                                key={index}\r\n                                                className={`preview-item ${order.valid ? 'valid' : 'invalid'}`}\r\n                                            >\r\n                                                <span className=\"preview-priority\">{index + 1}</span>\r\n                                                <div className=\"preview-details\">\r\n                                                    <span className=\"preview-machine\">{order.machineName}</span>\r\n                                                    <span className=\"preview-order\">{order.orderNumber}</span>\r\n                                                    <span className=\"preview-product\">{order.product}</span>\r\n                                                    <span className=\"preview-batch\">{order.batchNumber}</span>\r\n                                                </div>\r\n                                                {!order.valid && (\r\n                                                    <span className=\"preview-error\">{order.error}</span>\r\n                                                )}\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            <div className=\"admin-actions\">\r\n                                <button\r\n                                    className=\"admin-save-btn\"\r\n                                    onClick={handleBulkImport}\r\n                                    disabled={isSaving || validCount === 0}\r\n                                >\r\n                                    {isSaving ? 'Importing...' : `Import ${validCount} Orders`}\r\n                                </button>\r\n                                {bulkPasteText && (\r\n                                    <button\r\n                                        className=\"admin-clear-btn\"\r\n                                        onClick={() => {\r\n                                            setBulkPasteText('');\r\n                                            setParsedOrders([]);\r\n                                            setShowBulkPreview(false);\r\n                                        }}\r\n                                    >\r\n                                        Clear\r\n                                    </button>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"admin-form\">\r\n                            <div className=\"form-field\">\r\n                                <label className=\"form-label\">Machine</label>\r\n                                <select\r\n                                    className=\"form-input\"\r\n                                    value={selectedMachine}\r\n                                    onChange={e => setSelectedMachine(e.target.value)}\r\n                                >\r\n                                    <option value=\"\">Select a machine...</option>\r\n                                    {machines.map(machine => (\r\n                                        <option key={machine.id} value={machine.id}>\r\n                                            {machine.name}\r\n                                        </option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n\r\n                            <div className=\"form-field\">\r\n                                <label className=\"form-label\">Order Number</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    className=\"form-input\"\r\n                                    placeholder=\"Enter order number\"\r\n                                    value={orderNumber}\r\n                                    onChange={e => setOrderNumber(e.target.value)}\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"form-field\">\r\n                                <label className=\"form-label\">Product</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    className=\"form-input\"\r\n                                    placeholder=\"Enter product name\"\r\n                                    value={product}\r\n                                    onChange={e => setProduct(e.target.value)}\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"form-field\">\r\n                                <label className=\"form-label\">Batch Number</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    className=\"form-input\"\r\n                                    placeholder=\"Enter batch number\"\r\n                                    value={batchNumber}\r\n                                    onChange={e => setBatchNumber(e.target.value)}\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"admin-actions\">\r\n                                <button\r\n                                    className=\"admin-save-btn\"\r\n                                    onClick={handleAddOrder}\r\n                                    disabled={isSaving}\r\n                                >\r\n                                    {isSaving ? 'Adding...' : 'Add to Queue'}\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </section>\r\n\r\n                {/* Machine Order Queues */}\r\n                <section className=\"admin-queues-section\">\r\n                    <h2 className=\"section-heading\">\r\n                        <span className=\"section-icon\">#</span>\r\n                        Order Queues by Machine\r\n                    </h2>\r\n\r\n                    {machines.length === 0 ? (\r\n                        <div className=\"info-card\">\r\n                            <span className=\"info-icon\">!</span>\r\n                            <p>No machines configured. Add machines in Machine Settings first.</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"machine-queues-grid\">\r\n                            {machines.map(machine => {\r\n                                const orders = machineOrders[machine.id] || [];\r\n                                return (\r\n                                    <div key={machine.id} className=\"machine-queue-card\">\r\n                                        <div className=\"machine-queue-header\">\r\n                                            <h3>{machine.name}</h3>\r\n                                            <span className=\"queue-count\">{orders.length} orders</span>\r\n                                            {orders.length > 0 && (\r\n                                                <button\r\n                                                    className=\"clear-queue-btn\"\r\n                                                    onClick={() => handleClearMachineOrders(machine.id)}\r\n                                                    title=\"Clear all orders\"\r\n                                                >\r\n                                                    Clear\r\n                                                </button>\r\n                                            )}\r\n                                        </div>\r\n\r\n                                        {orders.length === 0 ? (\r\n                                            <div className=\"empty-queue\">\r\n                                                <p>No orders in queue</p>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <div className=\"queue-list\">\r\n                                                {orders.map((order, index) => (\r\n                                                    <motion.div\r\n                                                        key={order.id}\r\n                                                        className=\"queue-item\"\r\n                                                        initial={{ opacity: 0, x: -10 }}\r\n                                                        animate={{ opacity: 1, x: 0 }}\r\n                                                        transition={{ delay: index * 0.05 }}\r\n                                                    >\r\n                                                        <div className=\"queue-item-priority\">\r\n                                                            {index + 1}\r\n                                                        </div>\r\n                                                        <div className=\"queue-item-details\">\r\n                                                            <div className=\"queue-order-number\">{order.order_number}</div>\r\n                                                            <div className=\"queue-product\">{order.product}</div>\r\n                                                            <div className=\"queue-batch\">Batch: {order.batch_number}</div>\r\n                                                        </div>\r\n                                                        <div className=\"queue-item-actions\">\r\n                                                            <button\r\n                                                                className=\"queue-move-btn\"\r\n                                                                onClick={() => handleMoveOrder(machine.id, order.id!, 'up')}\r\n                                                                disabled={index === 0}\r\n                                                                title=\"Move up\"\r\n                                                            >\r\n                                                                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" width=\"16\" height=\"16\">\r\n                                                                    <path d=\"M18 15l-6-6-6 6\" />\r\n                                                                </svg>\r\n                                                            </button>\r\n                                                            <button\r\n                                                                className=\"queue-move-btn\"\r\n                                                                onClick={() => handleMoveOrder(machine.id, order.id!, 'down')}\r\n                                                                disabled={index === orders.length - 1}\r\n                                                                title=\"Move down\"\r\n                                                            >\r\n                                                                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" width=\"16\" height=\"16\">\r\n                                                                    <path d=\"M6 9l6 6 6-6\" />\r\n                                                                </svg>\r\n                                                            </button>\r\n                                                            <button\r\n                                                                className=\"queue-remove-btn\"\r\n                                                                onClick={() => handleRemoveOrder(order.id!)}\r\n                                                                title=\"Remove order\"\r\n                                                            >\r\n                                                                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" width=\"16\" height=\"16\">\r\n                                                                    <path d=\"M18 6L6 18M6 6l12 12\" />\r\n                                                                </svg>\r\n                                                            </button>\r\n                                                        </div>\r\n                                                    </motion.div>\r\n                                                ))}\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    )}\r\n                </section>\r\n\r\n                <section className=\"admin-info-section\">\r\n                    <div className=\"info-card\">\r\n                        <span className=\"info-icon\">i</span>\r\n                        <p>\r\n                            <strong>Bulk Import:</strong> Paste from Excel or CSV. Each line: Machine, Order, Product, Batch.\r\n                            Top to bottom = priority order (1st line = highest priority).\r\n                        </p>\r\n                    </div>\r\n                </section>\r\n\r\n                {/* Facility Settings Section */}\r\n                <section className=\"admin-settings-section\">\r\n                    <div className=\"settings-header\" onClick={() => setShowSettingsPanel(!showSettingsPanel)}>\r\n                        <h2 className=\"section-heading\">\r\n                            <span className=\"section-icon\">&#9881;</span>\r\n                            Facility Settings\r\n                        </h2>\r\n                        <span className={`expand-icon ${showSettingsPanel ? 'expanded' : ''}`}>\r\n                            {showSettingsPanel ? 'âˆ’' : '+'}\r\n                        </span>\r\n                    </div>\r\n\r\n                    <AnimatePresence>\r\n                        {showSettingsPanel && (\r\n                            <motion.div\r\n                                className=\"settings-panel\"\r\n                                initial={{ height: 0, opacity: 0 }}\r\n                                animate={{ height: 'auto', opacity: 1 }}\r\n                                exit={{ height: 0, opacity: 0 }}\r\n                                transition={{ duration: 0.2 }}\r\n                            >\r\n                                <div className=\"settings-grid\">\r\n                                    {/* Shift Configuration */}\r\n                                    <div className=\"settings-group\">\r\n                                        <h3>Shift Times</h3>\r\n                                        <div className=\"settings-row\">\r\n                                            <label>Day Shift Start</label>\r\n                                            <select\r\n                                                value={facilitySettings.dayShiftStart}\r\n                                                onChange={(e) => setFacilitySettings(prev => ({\r\n                                                    ...prev,\r\n                                                    dayShiftStart: parseInt(e.target.value)\r\n                                                }))}\r\n                                            >\r\n                                                {Array.from({ length: 24 }, (_, i) => (\r\n                                                    <option key={i} value={i}>{i.toString().padStart(2, '0')}:00</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        <div className=\"settings-row\">\r\n                                            <label>Day Shift End</label>\r\n                                            <select\r\n                                                value={facilitySettings.dayShiftEnd}\r\n                                                onChange={(e) => setFacilitySettings(prev => ({\r\n                                                    ...prev,\r\n                                                    dayShiftEnd: parseInt(e.target.value)\r\n                                                }))}\r\n                                            >\r\n                                                {Array.from({ length: 24 }, (_, i) => (\r\n                                                    <option key={i} value={i}>{i.toString().padStart(2, '0')}:00</option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                        <div className=\"settings-preview\">\r\n                                            Current: Day {formatShiftTimes().day}, Night {formatShiftTimes().night}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Timezone */}\r\n                                    <div className=\"settings-group\">\r\n                                        <h3>Timezone</h3>\r\n                                        <div className=\"settings-row\">\r\n                                            <label>UTC Offset</label>\r\n                                            <select\r\n                                                value={facilitySettings.timezoneOffset}\r\n                                                onChange={(e) => setFacilitySettings(prev => ({\r\n                                                    ...prev,\r\n                                                    timezoneOffset: parseInt(e.target.value)\r\n                                                }))}\r\n                                            >\r\n                                                {Array.from({ length: 25 }, (_, i) => i - 12).map(offset => (\r\n                                                    <option key={offset} value={offset}>\r\n                                                        UTC{offset >= 0 ? '+' : ''}{offset}\r\n                                                    </option>\r\n                                                ))}\r\n                                            </select>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Submission Window */}\r\n                                    <div className=\"settings-group\">\r\n                                        <h3>Submission Window</h3>\r\n                                        <div className=\"settings-row\">\r\n                                            <label>Window Size (minutes)</label>\r\n                                            <input\r\n                                                type=\"number\"\r\n                                                min=\"5\"\r\n                                                max=\"60\"\r\n                                                value={facilitySettings.submissionWindowMinutes}\r\n                                                onChange={(e) => setFacilitySettings(prev => ({\r\n                                                    ...prev,\r\n                                                    submissionWindowMinutes: parseInt(e.target.value) || 15\r\n                                                }))}\r\n                                            />\r\n                                        </div>\r\n                                        <div className=\"settings-hint\">\r\n                                            Time before/after shift end when submissions are allowed\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Session Locking */}\r\n                                    <div className=\"settings-group\">\r\n                                        <h3>Session Locking</h3>\r\n                                        <div className=\"settings-row checkbox-row\">\r\n                                            <label>\r\n                                                <input\r\n                                                    type=\"checkbox\"\r\n                                                    checked={facilitySettings.sessionLockingEnabled}\r\n                                                    onChange={(e) => setFacilitySettings(prev => ({\r\n                                                        ...prev,\r\n                                                        sessionLockingEnabled: e.target.checked\r\n                                                    }))}\r\n                                                />\r\n                                                Enable session locking\r\n                                            </label>\r\n                                        </div>\r\n                                        <div className=\"settings-hint\">\r\n                                            Prevents multiple users from editing the same shift\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Facility Info */}\r\n                                    <div className=\"settings-group\">\r\n                                        <h3>Facility Info</h3>\r\n                                        <div className=\"settings-row\">\r\n                                            <label>Name</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={facilitySettings.facilityName}\r\n                                                onChange={(e) => setFacilitySettings(prev => ({\r\n                                                    ...prev,\r\n                                                    facilityName: e.target.value\r\n                                                }))}\r\n                                            />\r\n                                        </div>\r\n                                        <div className=\"settings-row\">\r\n                                            <label>Location</label>\r\n                                            <input\r\n                                                type=\"text\"\r\n                                                value={facilitySettings.facilityLocation}\r\n                                                onChange={(e) => setFacilitySettings(prev => ({\r\n                                                    ...prev,\r\n                                                    facilityLocation: e.target.value\r\n                                                }))}\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"settings-actions\">\r\n                                    <button className=\"admin-save-btn\" onClick={handleSaveSettings}>\r\n                                        Save Settings\r\n                                    </button>\r\n                                    <button className=\"admin-clear-btn\" onClick={handleResetSettings}>\r\n                                        Reset to Defaults\r\n                                    </button>\r\n                                </div>\r\n                            </motion.div>\r\n                        )}\r\n                    </AnimatePresence>\r\n                </section>\r\n            </main>\r\n\r\n            {/* Settings Panel Styles */}\r\n            <style>{`\r\n                .admin-settings-section {\r\n                    margin-top: 2rem;\r\n                    background: #1a1a2e;\r\n                    border-radius: 12px;\r\n                    border: 1px solid rgba(255, 255, 255, 0.1);\r\n                    overflow: hidden;\r\n                }\r\n\r\n                .settings-header {\r\n                    display: flex;\r\n                    justify-content: space-between;\r\n                    align-items: center;\r\n                    padding: 1rem 1.5rem;\r\n                    cursor: pointer;\r\n                    transition: background 0.2s;\r\n                }\r\n\r\n                .settings-header:hover {\r\n                    background: rgba(255, 255, 255, 0.05);\r\n                }\r\n\r\n                .settings-header .section-heading {\r\n                    margin: 0;\r\n                    font-size: 1.1rem;\r\n                }\r\n\r\n                .expand-icon {\r\n                    font-size: 1.5rem;\r\n                    color: #20C997;\r\n                    transition: transform 0.2s;\r\n                }\r\n\r\n                .expand-icon.expanded {\r\n                    transform: rotate(180deg);\r\n                }\r\n\r\n                .settings-panel {\r\n                    border-top: 1px solid rgba(255, 255, 255, 0.1);\r\n                    padding: 1.5rem;\r\n                    overflow: hidden;\r\n                }\r\n\r\n                .settings-grid {\r\n                    display: grid;\r\n                    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\r\n                    gap: 1.5rem;\r\n                }\r\n\r\n                .settings-group {\r\n                    background: rgba(0, 0, 0, 0.2);\r\n                    padding: 1rem;\r\n                    border-radius: 8px;\r\n                }\r\n\r\n                .settings-group h3 {\r\n                    margin: 0 0 1rem 0;\r\n                    font-size: 0.9rem;\r\n                    color: #20C997;\r\n                    text-transform: uppercase;\r\n                    letter-spacing: 0.05em;\r\n                }\r\n\r\n                .settings-row {\r\n                    display: flex;\r\n                    justify-content: space-between;\r\n                    align-items: center;\r\n                    margin-bottom: 0.75rem;\r\n                }\r\n\r\n                .settings-row label {\r\n                    color: rgba(255, 255, 255, 0.8);\r\n                    font-size: 0.9rem;\r\n                }\r\n\r\n                .settings-row select,\r\n                .settings-row input[type=\"number\"],\r\n                .settings-row input[type=\"text\"] {\r\n                    background: #16213e;\r\n                    border: 1px solid rgba(255, 255, 255, 0.2);\r\n                    border-radius: 4px;\r\n                    padding: 0.5rem;\r\n                    color: #fff;\r\n                    min-width: 100px;\r\n                }\r\n\r\n                .settings-row select:focus,\r\n                .settings-row input:focus {\r\n                    outline: none;\r\n                    border-color: #20C997;\r\n                }\r\n\r\n                .checkbox-row label {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 0.5rem;\r\n                    cursor: pointer;\r\n                }\r\n\r\n                .checkbox-row input[type=\"checkbox\"] {\r\n                    width: 18px;\r\n                    height: 18px;\r\n                    accent-color: #20C997;\r\n                }\r\n\r\n                .settings-preview {\r\n                    font-size: 0.8rem;\r\n                    color: rgba(255, 255, 255, 0.5);\r\n                    margin-top: 0.5rem;\r\n                }\r\n\r\n                .settings-hint {\r\n                    font-size: 0.75rem;\r\n                    color: rgba(255, 255, 255, 0.4);\r\n                    margin-top: 0.25rem;\r\n                }\r\n\r\n                .settings-actions {\r\n                    display: flex;\r\n                    gap: 1rem;\r\n                    margin-top: 1.5rem;\r\n                    padding-top: 1rem;\r\n                    border-top: 1px solid rgba(255, 255, 255, 0.1);\r\n                }\r\n            `}</style>\r\n        </motion.div>\r\n    );\r\n};\r\n\r\nexport default AdminConsole;\r\n","export interface WasteEntry {\r\n  id: string;\r\n  waste: number;\r\n  wasteType: string;\r\n  timestamp: Date;\r\n}\r\n\r\nexport interface DowntimeEntry {\r\n  id: string;\r\n  downtime: number;\r\n  downtimeReason: string;\r\n  notes?: string;\r\n  timestamp: Date;\r\n}\r\n\r\n// Production timer state for tracking run time and pauses\r\nexport interface ProductionState {\r\n  isRunning: boolean;\r\n  startTime: Date | null;       // When production started\r\n  pausedAt: Date | null;        // When current pause began\r\n  totalRunTimeMs: number;       // Accumulated run time in milliseconds\r\n  lastResumedAt: Date | null;   // When last resumed from pause\r\n}\r\n\r\nexport interface SpeedEntry {\r\n  id: string;\r\n  speed: number;\r\n  timestamp: Date;\r\n}\r\n\r\nexport interface SachetMassEntry {\r\n  id: string;\r\n  mass: number; // in grams\r\n  timestamp: Date;\r\n  ignored?: boolean; // Can be set to ignore but not deleted\r\n}\r\n\r\n// Loose cases entry - for cases not part of a full pallet\r\nexport interface LooseCasesEntry {\r\n  id: string;\r\n  batchNumber: string; // 5-digit batch number\r\n  cases: number; // number of loose cases\r\n  timestamp: Date;\r\n  ignored?: boolean;\r\n}\r\n\r\n// Pallet Scan entry - QR code is 13 digits: BBBBBPPPPCCCC\r\n// B = batch number (5 digits), P = pallet number (4 digits), C = cases count (4 digits)\r\nexport interface PalletScanEntry {\r\n  id: string;\r\n  qrCode: string; // Full 13-digit QR code\r\n  batchNumber: string; // Extracted: first 5 digits\r\n  palletNumber: string; // Extracted: digits 6-9 (4 digits)\r\n  casesCount: number; // Extracted: last 4 digits\r\n  timestamp: Date;\r\n  ignored?: boolean;\r\n}\r\n\r\n// Legacy CasesPerHourEntry - kept for backwards compatibility\r\nexport interface CasesPerHourEntry {\r\n  id: string;\r\n  cases: number;\r\n  hour: number;\r\n  timestamp: Date;\r\n  ignored?: boolean;\r\n}\r\n\r\nexport interface ShiftData {\r\n  id: string;\r\n  operatorName: string;\r\n  machine: string;\r\n  subMachine?: string; // For machines that are groups (e.g., \"Universal 2 - Machine 1\")\r\n  orderNumber: string;\r\n  product: string;\r\n  batchNumber: string;\r\n  shift: string;\r\n  date: string;\r\n  wasteEntries: WasteEntry[];\r\n  downtimeEntries: DowntimeEntry[];\r\n  speedEntries?: SpeedEntry[];\r\n  sachetMassEntries?: SachetMassEntry[];\r\n  casesPerHourEntries?: CasesPerHourEntry[]; // Legacy - kept for backwards compatibility\r\n  looseCasesEntries?: LooseCasesEntry[]; // New: loose cases with batch number\r\n  palletScanEntries?: PalletScanEntry[];\r\n  submittedAt: Date;\r\n  totalWaste: number;\r\n  totalDowntime: number;\r\n}\r\n\r\nexport interface ShiftSession {\r\n  machineName: string;\r\n  operatorName: string;\r\n  orderNumber: string;\r\n  product: string;\r\n  batchNumber: string;\r\n  shift: string;\r\n  date: string;\r\n  locked: boolean; // Once set, these values are locked for the shift\r\n  // Entry data persisted with session\r\n  wasteEntries?: WasteEntry[];\r\n  downtimeEntries?: DowntimeEntry[];\r\n  speedEntries?: SpeedEntry[];\r\n  sachetMassEntries?: SachetMassEntry[];\r\n  casesPerHourEntries?: CasesPerHourEntry[]; // Legacy\r\n  looseCasesEntries?: LooseCasesEntry[]; // New\r\n  palletScanEntries?: PalletScanEntry[];\r\n}\r\n\r\nexport interface Machine {\r\n  id: string;\r\n  name: string;\r\n  status: 'running' | 'idle' | 'maintenance';\r\n  currentOperator?: string;\r\n  currentOrder?: string;\r\n  currentShift?: string;\r\n  lastSubmission?: string;\r\n  todayWaste?: number;\r\n  todayDowntime?: number;\r\n  subMachineCount?: number; // Number of sub-machines (e.g., 4 for \"Universal 2\")\r\n}\r\n\r\n// ==============================================\r\n// DEFAULT DATA\r\n// ==============================================\r\n\r\nexport const OPERATORS: string[] = [];\r\nexport const MACHINES: Machine[] = [];\r\n\r\n// Waste Types - common manufacturing waste categories\r\nexport const WASTE_TYPES: string[] = [\r\n  'Start-up Waste',\r\n  'Changeover Waste',\r\n  'Defective Product',\r\n  'Material Spillage',\r\n];\r\n\r\n// Downtime Reasons - categorized by planned vs unplanned\r\nexport const PLANNED_DOWNTIME_REASONS: string[] = [\r\n  'Scheduled Maintenance',\r\n  'Changeover',\r\n];\r\n\r\nexport const UNPLANNED_DOWNTIME_REASONS: string[] = [\r\n  'Machine Breakdown',\r\n  'Material Shortage',\r\n];\r\n\r\n// Combined downtime reasons for selection\r\nexport const DOWNTIME_REASONS: string[] = [\r\n  'Machine Breakdown',\r\n  'Scheduled Maintenance',\r\n  'Changeover',\r\n  'Material Shortage',\r\n];\r\n\r\nexport const ORDER_NUMBERS: string[] = [];\r\nexport const PRODUCTS: string[] = [];\r\nexport const BATCH_NUMBERS: string[] = [];\r\n\r\n","import { ShiftData, Machine, MACHINES } from '../types';\r\nimport {\r\n  fetchMachines,\r\n  upsertMachine,\r\n  removeMachine,\r\n  syncMachinesToSupabase,\r\n  subscribeMachineChanges,\r\n  MachineRecord,\r\n  submitShiftData,\r\n  isSupabaseConfigured\r\n} from './supabase';\r\n\r\nconst STORAGE_KEY = 'waste_downtime_history';\r\nconst MACHINES_KEY = 'machines_data';\r\nconst MACHINES_SYNC_KEY = 'machines_last_sync';\r\nconst FAILED_SUBMISSIONS_KEY = 'failed_submissions_queue';\r\nconst HISTORY_MAX_DAYS = 90; // Keep history for 90 days\r\nconst HISTORY_MAX_ENTRIES = 1000; // Maximum entries to keep\r\n\r\n// ==========================================\r\n// FAILED SUBMISSIONS RETRY QUEUE\r\n// ==========================================\r\n\r\ninterface FailedSubmission {\r\n  id: string;\r\n  timestamp: string;\r\n  retryCount: number;\r\n  maxRetries: number;\r\n  data: {\r\n    shiftData: any;\r\n    wasteEntries: any[];\r\n    downtimeEntries: any[];\r\n    speedEntries?: any[];\r\n    sachetMassEntries?: any[];\r\n    looseCasesEntries?: any[];\r\n    palletScanEntries?: any[];\r\n  };\r\n  error: string;\r\n}\r\n\r\n// Get failed submissions queue\r\nexport const getFailedSubmissions = (): FailedSubmission[] => {\r\n  const stored = localStorage.getItem(FAILED_SUBMISSIONS_KEY);\r\n  if (!stored) return [];\r\n  try {\r\n    return JSON.parse(stored);\r\n  } catch {\r\n    return [];\r\n  }\r\n};\r\n\r\n// Add a failed submission to the retry queue\r\nexport const addFailedSubmission = (\r\n  data: FailedSubmission['data'],\r\n  error: string\r\n): void => {\r\n  const queue = getFailedSubmissions();\r\n  const newEntry: FailedSubmission = {\r\n    id: `failed_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n    timestamp: new Date().toISOString(),\r\n    retryCount: 0,\r\n    maxRetries: 3,\r\n    data,\r\n    error,\r\n  };\r\n  queue.push(newEntry);\r\n  localStorage.setItem(FAILED_SUBMISSIONS_KEY, JSON.stringify(queue));\r\n};\r\n\r\n// Remove a submission from the failed queue\r\nexport const removeFailedSubmission = (id: string): void => {\r\n  const queue = getFailedSubmissions();\r\n  const filtered = queue.filter(s => s.id !== id);\r\n  localStorage.setItem(FAILED_SUBMISSIONS_KEY, JSON.stringify(filtered));\r\n};\r\n\r\n// Retry all failed submissions\r\nexport const retryFailedSubmissions = async (): Promise<{\r\n  succeeded: number;\r\n  failed: number;\r\n  remaining: number;\r\n}> => {\r\n  if (!isSupabaseConfigured) {\r\n    return { succeeded: 0, failed: 0, remaining: getFailedSubmissions().length };\r\n  }\r\n\r\n  const queue = getFailedSubmissions();\r\n  let succeeded = 0;\r\n  let failed = 0;\r\n\r\n  for (const submission of queue) {\r\n    if (submission.retryCount >= submission.maxRetries) {\r\n      // Max retries reached, keep in queue but don't retry\r\n      failed++;\r\n      continue;\r\n    }\r\n\r\n    try {\r\n      await submitShiftData(\r\n        submission.data.shiftData,\r\n        submission.data.wasteEntries,\r\n        submission.data.downtimeEntries,\r\n        submission.data.speedEntries,\r\n        submission.data.sachetMassEntries,\r\n        submission.data.looseCasesEntries,\r\n        submission.data.palletScanEntries\r\n      );\r\n      removeFailedSubmission(submission.id);\r\n      succeeded++;\r\n    } catch (e) {\r\n      // Update retry count\r\n      const updatedQueue = getFailedSubmissions().map(s =>\r\n        s.id === submission.id\r\n          ? { ...s, retryCount: s.retryCount + 1, error: String(e) }\r\n          : s\r\n      );\r\n      localStorage.setItem(FAILED_SUBMISSIONS_KEY, JSON.stringify(updatedQueue));\r\n      failed++;\r\n    }\r\n  }\r\n\r\n  return {\r\n    succeeded,\r\n    failed,\r\n    remaining: getFailedSubmissions().length,\r\n  };\r\n};\r\n\r\n// Clear all failed submissions (manual clear)\r\nexport const clearFailedSubmissions = (): void => {\r\n  localStorage.removeItem(FAILED_SUBMISSIONS_KEY);\r\n};\r\n\r\n// ==========================================\r\n// LOCALSTORAGE CLEANUP\r\n// ==========================================\r\n\r\n// Clean up old history entries\r\nexport const cleanupOldHistory = (): { removed: number; remaining: number } => {\r\n  const history = getShiftHistory();\r\n  const now = new Date();\r\n  const cutoffDate = new Date(now.getTime() - HISTORY_MAX_DAYS * 24 * 60 * 60 * 1000);\r\n\r\n  // Filter out entries older than cutoff date\r\n  let cleaned = history.filter(item => {\r\n    const itemDate = new Date(item.date);\r\n    return itemDate >= cutoffDate;\r\n  });\r\n\r\n  // Also limit to max entries (keep most recent)\r\n  if (cleaned.length > HISTORY_MAX_ENTRIES) {\r\n    cleaned = cleaned.slice(0, HISTORY_MAX_ENTRIES);\r\n  }\r\n\r\n  const removed = history.length - cleaned.length;\r\n\r\n  if (removed > 0) {\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(cleaned));\r\n    console.log(`Cleaned up ${removed} old history entries`);\r\n  }\r\n\r\n  return { removed, remaining: cleaned.length };\r\n};\r\n\r\n// Get localStorage usage stats\r\nexport const getStorageStats = (): {\r\n  historyCount: number;\r\n  failedCount: number;\r\n  totalSizeKB: number;\r\n  oldestEntry: string | null;\r\n} => {\r\n  const history = getShiftHistory();\r\n  const failed = getFailedSubmissions();\r\n\r\n  // Estimate total localStorage size\r\n  let totalSize = 0;\r\n  for (let i = 0; i < localStorage.length; i++) {\r\n    const key = localStorage.key(i);\r\n    if (key) {\r\n      const value = localStorage.getItem(key) || '';\r\n      totalSize += key.length + value.length;\r\n    }\r\n  }\r\n\r\n  const oldestEntry = history.length > 0\r\n    ? history[history.length - 1].date\r\n    : null;\r\n\r\n  return {\r\n    historyCount: history.length,\r\n    failedCount: failed.length,\r\n    totalSizeKB: Math.round(totalSize / 1024),\r\n    oldestEntry,\r\n  };\r\n};\r\n\r\n// Run cleanup on app startup (debounced to run once per day)\r\nexport const maybeRunCleanup = (): void => {\r\n  const lastCleanupKey = 'last_storage_cleanup';\r\n  const lastCleanup = localStorage.getItem(lastCleanupKey);\r\n  const now = new Date();\r\n\r\n  if (lastCleanup) {\r\n    const lastDate = new Date(lastCleanup);\r\n    const hoursSinceCleanup = (now.getTime() - lastDate.getTime()) / (1000 * 60 * 60);\r\n    if (hoursSinceCleanup < 24) {\r\n      return; // Already cleaned up today\r\n    }\r\n  }\r\n\r\n  // Run cleanup\r\n  const result = cleanupOldHistory();\r\n  localStorage.setItem(lastCleanupKey, now.toISOString());\r\n\r\n  if (result.removed > 0) {\r\n    console.log(`Storage cleanup: removed ${result.removed} entries, ${result.remaining} remaining`);\r\n  }\r\n};\r\n\r\n// Flag to track if we're using Supabase\r\nlet useSupabase = true;\r\nlet machinesCache: Machine[] | null = null;\r\nlet machinesListeners: ((machines: Machine[]) => void)[] = [];\r\n\r\n// Convert Supabase record to local Machine type\r\nconst toLocalMachine = (record: MachineRecord): Machine => ({\r\n  id: record.id,\r\n  name: record.name,\r\n  status: record.status,\r\n  currentOperator: record.current_operator,\r\n  currentOrder: record.current_order,\r\n  currentShift: record.current_shift,\r\n  lastSubmission: record.last_submission,\r\n  todayWaste: record.today_waste,\r\n  todayDowntime: record.today_downtime,\r\n  subMachineCount: record.sub_machine_count,\r\n});\r\n\r\n// Convert local Machine to Supabase record\r\nconst toSupabaseRecord = (machine: Machine): MachineRecord => ({\r\n  id: machine.id,\r\n  name: machine.name,\r\n  status: machine.status,\r\n  current_operator: machine.currentOperator,\r\n  current_order: machine.currentOrder,\r\n  current_shift: machine.currentShift,\r\n  last_submission: machine.lastSubmission,\r\n  today_waste: machine.todayWaste,\r\n  today_downtime: machine.todayDowntime,\r\n  sub_machine_count: machine.subMachineCount,\r\n});\r\n\r\n// Initialize machines from Supabase\r\nexport const initializeMachines = async (): Promise<Machine[]> => {\r\n  try {\r\n    const records = await fetchMachines();\r\n\r\n    if (records.length > 0) {\r\n      machinesCache = records.map(toLocalMachine);\r\n      // Also save to localStorage as backup\r\n      localStorage.setItem(MACHINES_KEY, JSON.stringify(machinesCache));\r\n      localStorage.setItem(MACHINES_SYNC_KEY, new Date().toISOString());\r\n      return machinesCache;\r\n    } else {\r\n      // No machines in Supabase, sync default machines\r\n      console.log('No machines in Supabase, syncing defaults...');\r\n      const defaultMachines = MACHINES.map(toSupabaseRecord);\r\n      await syncMachinesToSupabase(defaultMachines);\r\n      machinesCache = MACHINES;\r\n      localStorage.setItem(MACHINES_KEY, JSON.stringify(MACHINES));\r\n      return MACHINES;\r\n    }\r\n  } catch (error) {\r\n    console.error('Failed to initialize from Supabase, using localStorage:', error);\r\n    useSupabase = false;\r\n    return getMachinesDataLocal();\r\n  }\r\n};\r\n\r\n// Subscribe to real-time machine updates - OPTIMIZED\r\nexport const subscribeToMachineUpdates = (callback: (machines: Machine[]) => void) => {\r\n  machinesListeners.push(callback);\r\n\r\n  // Provide current machines getter for optimized real-time updates\r\n  const getCurrentMachines = (): MachineRecord[] => {\r\n    const current = machinesCache || getMachinesDataLocal();\r\n    return current.map(toSupabaseRecord);\r\n  };\r\n\r\n  // Set up Supabase real-time subscription with optimized handler\r\n  const unsubscribe = subscribeMachineChanges(\r\n    (records) => {\r\n      machinesCache = records.map(toLocalMachine);\r\n      localStorage.setItem(MACHINES_KEY, JSON.stringify(machinesCache));\r\n\r\n      // Notify all listeners\r\n      machinesListeners.forEach(listener => listener(machinesCache!));\r\n    },\r\n    getCurrentMachines\r\n  );\r\n\r\n  // Return cleanup function\r\n  return () => {\r\n    machinesListeners = machinesListeners.filter(l => l !== callback);\r\n    if (machinesListeners.length === 0) {\r\n      unsubscribe();\r\n    }\r\n  };\r\n};\r\n\r\n// Get machines from localStorage (fallback)\r\nconst getMachinesDataLocal = (): Machine[] => {\r\n  const stored = localStorage.getItem(MACHINES_KEY);\r\n  if (!stored) {\r\n    localStorage.setItem(MACHINES_KEY, JSON.stringify(MACHINES));\r\n    return MACHINES;\r\n  }\r\n\r\n  try {\r\n    return JSON.parse(stored);\r\n  } catch {\r\n    return MACHINES;\r\n  }\r\n};\r\n\r\n// Save shift data to local storage\r\nexport const saveShiftData = (data: ShiftData): void => {\r\n  const existing = getShiftHistory();\r\n  existing.unshift(data);\r\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(existing));\r\n\r\n  // Update machine data\r\n  updateMachineLastSubmission(data.machine, data.submittedAt.toISOString());\r\n};\r\n\r\n// Get all shift history\r\nexport const getShiftHistory = (): ShiftData[] => {\r\n  const stored = localStorage.getItem(STORAGE_KEY);\r\n  if (!stored) return [];\r\n\r\n  try {\r\n    const parsed = JSON.parse(stored);\r\n    return parsed.map((item: any) => ({\r\n      ...item,\r\n      submittedAt: new Date(item.submittedAt),\r\n      wasteEntries: item.wasteEntries.map((w: any) => ({\r\n        ...w,\r\n        timestamp: new Date(w.timestamp),\r\n      })),\r\n      downtimeEntries: item.downtimeEntries.map((d: any) => ({\r\n        ...d,\r\n        timestamp: new Date(d.timestamp),\r\n      })),\r\n    }));\r\n  } catch {\r\n    return [];\r\n  }\r\n};\r\n\r\n// Get shift history for a specific date range\r\nexport const getShiftHistoryByDateRange = (startDate: Date, endDate: Date): ShiftData[] => {\r\n  const history = getShiftHistory();\r\n  return history.filter(item => {\r\n    const itemDate = new Date(item.date);\r\n    return itemDate >= startDate && itemDate <= endDate;\r\n  });\r\n};\r\n\r\n// Get shift history for a specific machine\r\nexport const getShiftHistoryByMachine = (machineName: string): ShiftData[] => {\r\n  const history = getShiftHistory();\r\n  return history.filter(item => item.machine === machineName);\r\n};\r\n\r\n// Get today's statistics\r\nexport const getTodayStats = () => {\r\n  const today = new Date().toISOString().split('T')[0];\r\n  const history = getShiftHistory();\r\n  const todayData = history.filter(item => item.date === today);\r\n\r\n  const totalWaste = todayData.reduce((sum, item) => sum + item.totalWaste, 0);\r\n  const totalDowntime = todayData.reduce((sum, item) => sum + item.totalDowntime, 0);\r\n  const submissionCount = todayData.length;\r\n\r\n  return { totalWaste, totalDowntime, submissionCount };\r\n};\r\n\r\n// Update machine last submission\r\nexport const updateMachineLastSubmission = (machineName: string, timestamp: string): void => {\r\n  const machines = getMachinesData();\r\n  const machineIndex = machines.findIndex(m => m.name === machineName);\r\n  if (machineIndex !== -1) {\r\n    machines[machineIndex].lastSubmission = getTimeAgo(new Date(timestamp));\r\n  }\r\n  localStorage.setItem(MACHINES_KEY, JSON.stringify(machines));\r\n};\r\n\r\n// Get machines data with local modifications\r\nexport const getMachinesData = (): Machine[] => {\r\n  // Return cache if available\r\n  if (machinesCache) {\r\n    return machinesCache;\r\n  }\r\n\r\n  // Otherwise return from localStorage\r\n  return getMachinesDataLocal();\r\n};\r\n\r\n// Update a single machine\r\nexport const updateMachine = async (machineId: string, updates: Partial<Machine>): Promise<void> => {\r\n  const machines = getMachinesData();\r\n  const index = machines.findIndex(m => m.id === machineId);\r\n  if (index !== -1) {\r\n    machines[index] = { ...machines[index], ...updates };\r\n    machinesCache = machines;\r\n    localStorage.setItem(MACHINES_KEY, JSON.stringify(machines));\r\n\r\n    // Sync to Supabase\r\n    if (useSupabase) {\r\n      try {\r\n        await upsertMachine(toSupabaseRecord(machines[index]));\r\n      } catch (error) {\r\n        console.error('Failed to sync machine update to Supabase:', error);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n// Add a new machine\r\nexport const addMachine = async (machine: Machine): Promise<void> => {\r\n  const machines = getMachinesData();\r\n  machines.push(machine);\r\n  machinesCache = machines;\r\n  localStorage.setItem(MACHINES_KEY, JSON.stringify(machines));\r\n\r\n  // Sync to Supabase\r\n  if (useSupabase) {\r\n    try {\r\n      await upsertMachine(toSupabaseRecord(machine));\r\n    } catch (error) {\r\n      console.error('Failed to sync new machine to Supabase:', error);\r\n    }\r\n  }\r\n};\r\n\r\n// Delete a machine\r\nexport const deleteMachine = async (machineId: string): Promise<void> => {\r\n  const machines = getMachinesData();\r\n  const filtered = machines.filter(m => m.id !== machineId);\r\n  machinesCache = filtered;\r\n  localStorage.setItem(MACHINES_KEY, JSON.stringify(filtered));\r\n\r\n  // Sync to Supabase\r\n  if (useSupabase) {\r\n    try {\r\n      await removeMachine(machineId);\r\n    } catch (error) {\r\n      console.error('Failed to delete machine from Supabase:', error);\r\n    }\r\n  }\r\n};\r\n\r\n// Reset machines to default\r\nexport const resetMachines = async (): Promise<void> => {\r\n  machinesCache = MACHINES;\r\n  localStorage.setItem(MACHINES_KEY, JSON.stringify(MACHINES));\r\n\r\n  // Sync to Supabase\r\n  if (useSupabase) {\r\n    try {\r\n      await syncMachinesToSupabase(MACHINES.map(toSupabaseRecord));\r\n    } catch (error) {\r\n      console.error('Failed to reset machines in Supabase:', error);\r\n    }\r\n  }\r\n};\r\n\r\n// Helper function to format time ago\r\nexport const getTimeAgo = (date: Date): string => {\r\n  const now = new Date();\r\n  const diffMs = now.getTime() - date.getTime();\r\n  const diffMins = Math.floor(diffMs / 60000);\r\n  const diffHours = Math.floor(diffMins / 60);\r\n  const diffDays = Math.floor(diffHours / 24);\r\n\r\n  if (diffMins < 1) return 'Just now';\r\n  if (diffMins < 60) return `${diffMins} min ago`;\r\n  if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;\r\n  return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;\r\n};\r\n\r\n// Export data to CSV\r\nexport const exportToCSV = (data: ShiftData[], filename: string): void => {\r\n  const headers = [\r\n    'Date',\r\n    'Shift',\r\n    'Operator',\r\n    'Machine',\r\n    'Order Number',\r\n    'Product',\r\n    'Batch Number',\r\n    'Entry Type',\r\n    'Waste Type',\r\n    'Waste (kg)',\r\n    'Downtime Reason',\r\n    'Downtime (min)',\r\n    'Submitted At',\r\n  ];\r\n\r\n  const rows: string[][] = [];\r\n\r\n  data.forEach(item => {\r\n    const baseRow = [\r\n      item.date,\r\n      item.shift,\r\n      item.operatorName,\r\n      item.machine,\r\n      item.orderNumber,\r\n      item.product,\r\n      item.batchNumber,\r\n    ];\r\n    const submittedAt = new Date(item.submittedAt).toLocaleString();\r\n\r\n    // Add a row for each waste entry\r\n    if (item.wasteEntries && item.wasteEntries.length > 0) {\r\n      item.wasteEntries.forEach(w => {\r\n        rows.push([\r\n          ...baseRow,\r\n          'Waste',\r\n          w.wasteType,\r\n          w.waste.toFixed(2),\r\n          '',\r\n          '',\r\n          submittedAt,\r\n        ]);\r\n      });\r\n    }\r\n\r\n    // Add a row for each downtime entry\r\n    if (item.downtimeEntries && item.downtimeEntries.length > 0) {\r\n      item.downtimeEntries.forEach(d => {\r\n        rows.push([\r\n          ...baseRow,\r\n          'Downtime',\r\n          '',\r\n          '',\r\n          d.downtimeReason,\r\n          d.downtime.toString(),\r\n          submittedAt,\r\n        ]);\r\n      });\r\n    }\r\n\r\n    // If no entries at all, still add one summary row\r\n    if ((!item.wasteEntries || item.wasteEntries.length === 0) &&\r\n      (!item.downtimeEntries || item.downtimeEntries.length === 0)) {\r\n      rows.push([\r\n        ...baseRow,\r\n        'Summary',\r\n        '',\r\n        item.totalWaste.toFixed(2),\r\n        '',\r\n        item.totalDowntime.toString(),\r\n        submittedAt,\r\n      ]);\r\n    }\r\n  });\r\n\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...rows.map(row => row.map(cell => `\"${cell}\"`).join(',')),\r\n  ].join('\\n');\r\n\r\n  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n  const link = document.createElement('a');\r\n  const url = URL.createObjectURL(blob);\r\n  link.setAttribute('href', url);\r\n  link.setAttribute('download', `${filename}.csv`);\r\n  link.style.visibility = 'hidden';\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n  // Clean up the object URL to prevent memory leak\r\n  URL.revokeObjectURL(url);\r\n};\r\n\r\n// Clear all history (for testing)\r\nexport const clearHistory = (): void => {\r\n  localStorage.removeItem(STORAGE_KEY);\r\n  localStorage.removeItem(MACHINES_KEY);\r\n};\r\n"],"names":["AdminConsole","navigate","useNavigate","selectedMachine","setSelectedMachine","useState","orderNumber","setOrderNumber","product","setProduct","batchNumber","setBatchNumber","bulkPasteText","setBulkPasteText","parsedOrders","setParsedOrders","showBulkPreview","setShowBulkPreview","activeTab","setActiveTab","machines","setMachines","machineOrders","setMachineOrders","isLoading","setIsLoading","isSaving","setIsSaving","toast","setToast","facilitySettings","setFacilitySettings","getFacilitySettings","showSettingsPanel","setShowSettingsPanel","showToast","message","type","setTimeout","loadData","useCallback","async","machinesData","getMachinesData","length","id","isSupabaseConfigured","allOrders","fetchAllMachineOrders","grouped","forEach","m","filter","o","machine_id","error","console","useEffect","findMachine","name","normalizedName","trim","toLowerCase","find","includes","parseBulkText","text","lines","split","line","orders","parts","map","p","machineName","orderNum","prod","batch","machine","push","machineId","valid","undefined","concat","handleMoveOrder","orderId","direction","currentIndex","findIndex","newIndex","newOrders","prev","_objectSpread","orderIds","updateMachineOrderPriorities","validCount","invalidCount","_jsxs","className","children","_jsx","motion","div","initial","opacity","y","animate","exit","AnimatePresence","onClick","viewBox","fill","stroke","strokeWidth","d","width","height","placeholder","value","onChange","e","parsed","handleBulkTextChange","target","rows","order","index","validOrders","ordersByMachine","Object","keys","addMachineOrder","disabled","window","confirm","clearMachineOrders","handleClearMachineOrders","title","x","transition","delay","order_number","batch_number","removeMachineOrder","handleRemoveOrder","duration","dayShiftStart","parseInt","Array","from","_","i","toString","padStart","dayShiftEnd","formatShiftTimes","day","night","timezoneOffset","offset","min","max","submissionWindowMinutes","checked","sessionLockingEnabled","facilityName","facilityLocation","handleSaveSettings","updated","saveFacilitySettings","showSuccess","showError","handleResetSettings","defaults","resetFacilitySettings","MACHINES","WASTE_TYPES","DOWNTIME_REASONS","STORAGE_KEY","MACHINES_KEY","FAILED_SUBMISSIONS_KEY","getFailedSubmissions","stored","localStorage","getItem","JSON","parse","_unused","addFailedSubmission","data","queue","newEntry","Date","now","Math","random","substr","timestamp","toISOString","retryCount","maxRetries","setItem","stringify","removeFailedSubmission","filtered","s","retryFailedSubmissions","succeeded","failed","remaining","submission","submitShiftData","shiftData","wasteEntries","downtimeEntries","speedEntries","sachetMassEntries","looseCasesEntries","palletScanEntries","updatedQueue","String","maybeRunCleanup","lastCleanupKey","lastCleanup","lastDate","getTime","result","cleanupOldHistory","history","getShiftHistory","cutoffDate","HISTORY_MAX_DAYS","cleaned","item","date","slice","removed","log","useSupabase","machinesCache","machinesListeners","toLocalMachine","record","status","currentOperator","current_operator","currentOrder","current_order","currentShift","current_shift","lastSubmission","last_submission","todayWaste","today_waste","todayDowntime","today_downtime","subMachineCount","sub_machine_count","toSupabaseRecord","initializeMachines","records","fetchMachines","defaultMachines","syncMachinesToSupabase","getMachinesDataLocal","subscribeToMachineUpdates","callback","unsubscribe","subscribeMachineChanges","listener","getCurrentMachines","l","_unused2","saveShiftData","existing","unshift","updateMachineLastSubmission","submittedAt","w","_unused3","getTodayStats","today","todayData","totalWaste","reduce","sum","totalDowntime","submissionCount","machineIndex","getTimeAgo","updateMachine","updates","upsertMachine","addMachine","deleteMachine","removeMachine","diffMs","diffMins","floor","diffHours","diffDays","exportToCSV","filename","baseRow","shift","operatorName","toLocaleString","wasteType","waste","toFixed","downtimeReason","downtime","csvContent","join","row","cell","blob","Blob","link","document","createElement","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild","revokeObjectURL"],"ignoreList":[],"sourceRoot":""}